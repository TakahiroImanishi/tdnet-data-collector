# TDnet Data Collector - 環境変数テンプレート
# このファイルをコピーして .env.local, .env.development, .env.production を作成してください
#
# 使用方法:
#   cp .env.example .env.local
#   cp .env.example .env.development
#   cp .env.example .env.production
#
# 重要: .env* ファイルは .gitignore に追加してください！

# ==========================================
# AWS設定
# ==========================================

# AWSリージョン
# 必須: はい
# 推奨値: ap-northeast-1（東京リージョン）
# 説明: TDnetは日本のサービスのため、東京リージョンを推奨
AWS_REGION=ap-northeast-1

# AWSプロファイル（ローカル開発時のみ）
# 必須: いいえ（ローカル開発時のみ）
# 推奨値: default または ~/.aws/credentials のプロファイル名
# 説明: AWS CLIで設定したプロファイル名を指定
# 本番環境ではIAMロールを使用するため不要
AWS_PROFILE=default

# ==========================================
# DynamoDB設定
# ==========================================

# メタデータテーブル名
# 必須: はい
# 命名規則: tdnet-disclosures-{環境名}
# 説明: 開示情報のメタデータを保存するテーブル
# 環境別の例:
#   - local: tdnet-disclosures-local
#   - development: tdnet-disclosures-dev
#   - staging: tdnet-disclosures-staging
#   - production: tdnet-disclosures-prod
DYNAMODB_TABLE_NAME=tdnet-disclosures-${ENVIRONMENT}

# 実行状態テーブル名
# 必須: はい
# 命名規則: tdnet-executions-{環境名}
# 説明: バッチ実行の状態を保存するテーブル
DYNAMODB_EXECUTION_TABLE_NAME=tdnet-executions-${ENVIRONMENT}

# ==========================================
# S3設定
# ==========================================

# PDFファイル保存バケット
# 必須: はい
# 命名規則: tdnet-pdfs-{環境名}-{AWSアカウントID}
# 説明: ダウンロードしたPDFファイルを保存するバケット
# 注意: S3バケット名はグローバルで一意である必要があるため、
#       アカウントIDを含めることを推奨
# 環境別の例:
#   - development: tdnet-pdfs-dev-123456789012
#   - production: tdnet-pdfs-prod-987654321098
S3_PDF_BUCKET_NAME=tdnet-pdfs-${ENVIRONMENT}-${AWS_ACCOUNT_ID}

# エクスポートファイル保存バケット
# 必須: はい
# 命名規則: tdnet-exports-{環境名}-{AWSアカウントID}
# 説明: エクスポートしたCSV/JSONファイルを保存するバケット
S3_EXPORT_BUCKET_NAME=tdnet-exports-${ENVIRONMENT}-${AWS_ACCOUNT_ID}

# ==========================================
# TDnetスクレイピング設定
# ==========================================

# TDnet URL
# 必須: はい
# デフォルト値: https://www.release.tdnet.info
# 説明: TDnet適時開示情報閲覧サービスのベースURL
# 注意: 変更しないでください
TDNET_BASE_URL=https://www.release.tdnet.info

# リクエスト間隔（ミリ秒）
# 必須: いいえ
# デフォルト値: 2000（2秒）
# 推奨値: 2000-5000
# 説明: TDnetへのリクエスト間隔。サーバーに負荷をかけないため、
#       最低2秒の間隔を推奨
# 環境別の推奨値:
#   - local/development: 2000（テスト用）
#   - production: 3000-5000（本番運用）
TDNET_REQUEST_DELAY=2000

# タイムアウト（ミリ秒）
# 必須: いいえ
# デフォルト値: 30000（30秒）
# 推奨値: 30000-60000
# 説明: HTTPリクエストのタイムアウト時間
TDNET_TIMEOUT=30000

# 最大再試行回数
# 必須: いいえ
# デフォルト値: 3
# 推奨値: 3-5
# 説明: ネットワークエラー時の再試行回数
TDNET_MAX_RETRIES=3

# User-Agent
# 必須: はい
# 推奨値: TDnetDataCollector/1.0 (Personal Use)
# 説明: HTTPリクエストのUser-Agentヘッダー
# 注意: 必ず設定してください。個人利用であることを明記
TDNET_USER_AGENT=TDnetDataCollector/1.0 (Personal Use)

# ==========================================
# Lambda設定
# ==========================================

# Lambda実行タイムアウト（秒）
# 必須: いいえ
# デフォルト値: 900（15分）
# 推奨値: 300-900
# 説明: Lambda関数の最大実行時間
# 注意: Lambdaの最大タイムアウトは15分（900秒）
# 環境別の推奨値:
#   - development: 300（5分、テスト用）
#   - production: 900（15分、本番運用）
LAMBDA_TIMEOUT=900

# Lambdaメモリサイズ（MB）
# 必須: いいえ
# デフォルト値: 512
# 推奨値: 512-1024
# 説明: Lambda関数のメモリサイズ。メモリを増やすとCPU性能も向上
# 環境別の推奨値:
#   - development: 512（コスト削減）
#   - production: 1024（パフォーマンス優先）
LAMBDA_MEMORY_SIZE=512

# ログレベル（DEBUG, INFO, WARN, ERROR）
# 必須: いいえ
# デフォルト値: INFO
# 推奨値: 環境によって異なる
# 説明: CloudWatch Logsに出力するログレベル
# 環境別の推奨値:
#   - local: DEBUG（詳細なログ）
#   - development: INFO（標準ログ）
#   - production: WARN（警告以上のみ、コスト削減）
LOG_LEVEL=INFO

# ==========================================
# API設定
# ==========================================

# API Gateway URL（デプロイ後に設定）
# 必須: いいえ（デプロイ後に自動設定）
# 説明: CDKデプロイ後にAPI GatewayのURLが生成されます
# 取得方法:
#   aws cloudformation describe-stacks \
#     --stack-name TDnetDataCollectorStack-prod \
#     --query 'Stacks[0].Outputs[?OutputKey==`ApiEndpoint`].OutputValue' \
#     --output text
API_ENDPOINT=https://xxxxxxxxxx.execute-api.ap-northeast-1.amazonaws.com/prod

# APIキー（Secrets Managerから取得を推奨）
# 必須: はい（API使用時）
# セキュリティ: 本番環境では必ずSecrets Managerを使用
# 説明: API Gatewayの認証に使用するAPIキー
# 注意: この値は .env ファイルに直接記載せず、Secrets Managerから取得してください
# ローカル開発時のみ .env.local に記載可能（gitignore必須）
API_KEY=your-api-key-here

# ==========================================
# 通知設定
# ==========================================

# SNSトピックARN（デプロイ後に設定）
# 必須: いいえ（通知機能使用時のみ）
# 説明: エラーアラートを送信するSNSトピックのARN
# 取得方法:
#   aws cloudformation describe-stacks \
#     --stack-name TDnetDataCollectorStack-prod \
#     --query 'Stacks[0].Outputs[?OutputKey==`AlertTopicArn`].OutputValue' \
#     --output text
SNS_TOPIC_ARN=arn:aws:sns:ap-northeast-1:${AWS_ACCOUNT_ID}:tdnet-alerts-${ENVIRONMENT}

# Slackウェブフック URL（オプション）
# 必須: いいえ
# 説明: Slackへの通知を有効にする場合に設定
# 取得方法: Slackアプリの設定画面から取得
# 注意: 本番環境ではSecrets Managerを使用してください
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/WEBHOOK/URL

# ==========================================
# 監視設定
# ==========================================

# CloudWatchログ保持期間（日）
# 必須: いいえ
# デフォルト値: 30
# 推奨値: 7-90
# 説明: CloudWatch Logsのログ保持期間
# 環境別の推奨値:
#   - development: 7（コスト削減）
#   - staging: 14
#   - production: 30-90（コンプライアンス要件に応じて）
# 注意: 長期保存するとコストが増加します
LOG_RETENTION_DAYS=30

# メトリクス収集間隔（秒）
# 必須: いいえ
# デフォルト値: 60
# 推奨値: 60-300
# 説明: カスタムメトリクスの収集間隔
METRICS_INTERVAL=60

# ==========================================
# セキュリティ設定
# ==========================================

# Secrets Manager シークレット名
# 必須: いいえ（本番環境では推奨）
# 命名規則: tdnet-data-collector-{環境名}
# 説明: APIキーなどの機密情報を保存するSecrets Managerのシークレット名
# 使用方法:
#   1. Secrets Managerにシークレットを作成
#   2. Lambda関数から取得して使用
# 環境別の例:
#   - development: tdnet-data-collector-dev
#   - production: tdnet-data-collector-prod
SECRETS_MANAGER_SECRET_NAME=tdnet-data-collector-${ENVIRONMENT}

# KMS キーID（オプション）
# 必須: いいえ
# 説明: データ暗号化に使用するKMSキーのID
# 注意: 個人利用ではデフォルトのAWS管理キーで十分です
#       カスタムキーを使用するとコストが増加します
KMS_KEY_ID=alias/tdnet-data-collector-${ENVIRONMENT}

# ==========================================
# 開発環境設定（ローカル開発時のみ）
# ==========================================

# ローカルDynamoDB エンドポイント
# 必須: いいえ（ローカルDynamoDB使用時のみ）
# 説明: DynamoDB Localを使用する場合のエンドポイント
# 使用方法:
#   1. DynamoDB Localをインストール
#   2. docker run -p 8000:8000 amazon/dynamodb-local
#   3. この環境変数のコメントを解除
# DYNAMODB_ENDPOINT=http://localhost:8000

# ローカルS3 エンドポイント（LocalStack使用時）
# 必須: いいえ（LocalStack使用時のみ）
# 説明: LocalStackを使用する場合のS3エンドポイント
# 使用方法:
#   1. LocalStackをインストール
#   2. docker run -p 4566:4566 localstack/localstack
#   3. この環境変数のコメントを解除
# S3_ENDPOINT=http://localhost:4566

# デバッグモード
# 必須: いいえ
# 説明: 詳細なデバッグログを出力する場合に true に設定
# 注意: 本番環境では必ず false にしてください
# DEBUG=true

# ==========================================
# 環境識別子
# ==========================================

# 環境名（local, development, staging, production）
# 必須: はい
# 推奨値: local, development, staging, production
# 説明: 現在の実行環境を識別するための環境名
# 使用場面:
#   - リソース名の生成（DynamoDBテーブル名、S3バケット名）
#   - ログレベルの切り替え
#   - 機能の有効/無効切り替え
# 環境別の設定:
#   - local: ローカル開発環境
#   - development: 開発環境（AWS）
#   - staging: ステージング環境（本番前テスト）
#   - production: 本番環境
ENVIRONMENT=development

# AWSアカウントID
# 必須: はい
# 説明: 使用するAWSアカウントのID（12桁の数字）
# 取得方法:
#   aws sts get-caller-identity --query Account --output text
# 注意: 環境ごとに異なるアカウントを使用することを推奨
# 環境別の例:
#   - development: 123456789012
#   - production: 987654321098
AWS_ACCOUNT_ID=123456789012

# ==========================================
# 注意事項
# ==========================================

# 1. セキュリティ
#    - このファイルは .gitignore に追加してください
#    - 本番環境では Secrets Manager を使用してください
#    - APIキーなどの機密情報は直接記載しないでください

# 2. 環境変数の置換
#    - ${ENVIRONMENT} と ${AWS_ACCOUNT_ID} は実際の値に置き換えてください
#    - 例: DYNAMODB_TABLE_NAME=tdnet-disclosures-${ENVIRONMENT}
#         → DYNAMODB_TABLE_NAME=tdnet-disclosures-dev

# 3. 必須環境変数
#    以下の環境変数は必ず設定してください:
#    - AWS_REGION
#    - DYNAMODB_TABLE_NAME
#    - S3_PDF_BUCKET_NAME
#    - ENVIRONMENT
#    - AWS_ACCOUNT_ID

# 4. 環境別の設定例
#
#    【ローカル開発環境】
#    ENVIRONMENT=local
#    LOG_LEVEL=DEBUG
#    AWS_PROFILE=default
#
#    【開発環境】
#    ENVIRONMENT=development
#    LOG_LEVEL=INFO
#    LAMBDA_MEMORY_SIZE=512
#    LOG_RETENTION_DAYS=7
#
#    【本番環境】
#    ENVIRONMENT=production
#    LOG_LEVEL=WARN
#    LAMBDA_MEMORY_SIZE=1024
#    LOG_RETENTION_DAYS=30
#    SECRETS_MANAGER_SECRET_NAME=tdnet-data-collector-prod

# 5. コスト最適化
#    個人利用でコストを削減するための推奨設定:
#    - DynamoDB: オンデマンドモード（PAY_PER_REQUEST）
#    - S3: ライフサイクルポリシーで90日後にStandard-IAに移行
#    - Lambda: メモリサイズ512MB、タイムアウト900秒
#    - CloudWatch Logs: ログ保持期間7-30日
#    - Point-in-Time Recovery: 無効化（個人利用では不要）

# 6. トラブルシューティング
#    環境変数が読み込まれない場合:
#    - ファイル名を確認（.env.local, .env.development など）
#    - ファイルの配置場所を確認（プロジェクトルート）
#    - CDKスタックで環境変数を明示的に設定しているか確認

# 7. 関連ドキュメント
#    - テンプレート使用ガイド: .kiro/specs/tdnet-data-collector/templates/README.md
#    - 環境セットアップ: .kiro/specs/tdnet-data-collector/docs/environment-setup.md
#    - 設計書: .kiro/specs/tdnet-data-collector/docs/design.md
