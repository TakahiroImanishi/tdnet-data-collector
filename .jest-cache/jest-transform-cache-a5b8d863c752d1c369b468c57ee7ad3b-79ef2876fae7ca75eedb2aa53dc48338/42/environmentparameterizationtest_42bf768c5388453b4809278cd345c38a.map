{"file":"C:\\Users\\ti198\\investment_analysis_opopo\\cdk\\__tests__\\environment-parameterization.test.ts","mappings":"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","names":[],"sources":["C:\\Users\\ti198\\investment_analysis_opopo\\cdk\\__tests__\\environment-parameterization.test.ts"],"sourcesContent":["/**\r\n * Environment Parameterization Test\r\n *\r\n * Task 15.15-A: CDKスタックの環境パラメータ化テスト\r\n * Requirements: 要件8.1（設定管理）\r\n *\r\n * このテストは、CDKスタックが環境（dev/prod）ごとに正しくパラメータ化されていることを検証します。\r\n */\r\n\r\nimport * as cdk from 'aws-cdk-lib';\r\nimport { Template } from 'aws-cdk-lib/assertions';\r\nimport { TdnetDataCollectorStack } from '../lib/tdnet-data-collector-stack';\r\n\r\ndescribe('Environment Parameterization', () => {\r\n  const testAccount = '123456789012';\r\n  const testRegion = 'ap-northeast-1';\r\n\r\n  describe('Development Environment', () => {\r\n    let template: Template;\r\n\r\n    beforeAll(() => {\r\n      const app = new cdk.App();\r\n      const stack = new TdnetDataCollectorStack(app, 'TestStack-dev', {\r\n        env: { \r\n          account: testAccount, \r\n          region: testRegion \r\n        },\r\n        environmentConfig: { environment: 'dev' },\r\n      });\r\n      template = Template.fromStack(stack);\r\n    });\r\n\r\n    describe('DynamoDB Tables', () => {\r\n      it('should have environment suffix in table names', () => {\r\n        template.hasResourceProperties('AWS::DynamoDB::Table', {\r\n          TableName: 'tdnet_disclosures_dev',\r\n        });\r\n\r\n        template.hasResourceProperties('AWS::DynamoDB::Table', {\r\n          TableName: 'tdnet_executions_dev',\r\n        });\r\n\r\n        template.hasResourceProperties('AWS::DynamoDB::Table', {\r\n          TableName: 'tdnet_export_status_dev',\r\n        });\r\n      });\r\n    });\r\n\r\n    describe('S3 Buckets', () => {\r\n      it('should have environment suffix in bucket names', () => {\r\n        template.hasResourceProperties('AWS::S3::Bucket', {\r\n          BucketName: { 'Fn::Join': ['', ['tdnet-data-collector-pdfs-dev-', { Ref: 'AWS::AccountId' }]] },\r\n        });\r\n\r\n        template.hasResourceProperties('AWS::S3::Bucket', {\r\n          BucketName: { 'Fn::Join': ['', ['tdnet-data-collector-exports-dev-', { Ref: 'AWS::AccountId' }]] },\r\n        });\r\n\r\n        template.hasResourceProperties('AWS::S3::Bucket', {\r\n          BucketName: { 'Fn::Join': ['', ['tdnet-dashboard-dev-', { Ref: 'AWS::AccountId' }]] },\r\n        });\r\n\r\n        // CloudTrail bucket does not have environment suffix (shared resource)\r\n        template.hasResourceProperties('AWS::S3::Bucket', {\r\n          BucketName: `tdnet-cloudtrail-logs-${testAccount}`,\r\n        });\r\n      });\r\n    });\r\n\r\n    describe('Lambda Functions', () => {\r\n      it('should have environment suffix in function names', () => {\r\n        template.hasResourceProperties('AWS::Lambda::Function', {\r\n          FunctionName: 'tdnet-collector-dev',\r\n        });\r\n\r\n        template.hasResourceProperties('AWS::Lambda::Function', {\r\n          FunctionName: 'tdnet-query-dev',\r\n        });\r\n\r\n        template.hasResourceProperties('AWS::Lambda::Function', {\r\n          FunctionName: 'tdnet-export-dev',\r\n        });\r\n\r\n        template.hasResourceProperties('AWS::Lambda::Function', {\r\n          FunctionName: 'tdnet-collector-dev', // Changed from tdnet-collect-dev\r\n        });\r\n\r\n        template.hasResourceProperties('AWS::Lambda::Function', {\r\n          FunctionName: 'tdnet-collect-status-dev',\r\n        });\r\n      });\r\n    });\r\n\r\n    describe('API Gateway', () => {\r\n      it('should have environment suffix in API name', () => {\r\n        template.hasResourceProperties('AWS::ApiGateway::RestApi', {\r\n          Name: 'tdnet-data-collector-api-dev',\r\n        });\r\n      });\r\n\r\n      it('should have environment suffix in API key name', () => {\r\n        template.hasResourceProperties('AWS::ApiGateway::ApiKey', {\r\n          Name: 'tdnet-api-key-dev',\r\n        });\r\n      });\r\n\r\n      it('should have environment suffix in usage plan name', () => {\r\n        template.hasResourceProperties('AWS::ApiGateway::UsagePlan', {\r\n          UsagePlanName: 'tdnet-usage-plan-dev',\r\n        });\r\n      });\r\n    });\r\n\r\n    describe('WAF', () => {\r\n      it('should have environment suffix in Web ACL name', () => {\r\n        template.hasResourceProperties('AWS::WAFv2::WebACL', {\r\n          Name: 'tdnet-web-acl-dev',\r\n        });\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('Production Environment', () => {\r\n    let template: Template;\r\n\r\n    beforeAll(() => {\r\n      const app = new cdk.App();\r\n      const stack = new TdnetDataCollectorStack(app, 'TestStack-prod', {\r\n        env: { account: testAccount, region: testRegion },\r\n        environmentConfig: { environment: 'prod' },\r\n      });\r\n      template = Template.fromStack(stack);\r\n    });\r\n\r\n    describe('DynamoDB Tables', () => {\r\n      it('should have environment suffix in table names', () => {\r\n        template.hasResourceProperties('AWS::DynamoDB::Table', {\r\n          TableName: 'tdnet_disclosures_prod',\r\n        });\r\n\r\n        template.hasResourceProperties('AWS::DynamoDB::Table', {\r\n          TableName: 'tdnet_executions_prod',\r\n        });\r\n\r\n        template.hasResourceProperties('AWS::DynamoDB::Table', {\r\n          TableName: 'tdnet_export_status_prod',\r\n        });\r\n      });\r\n    });\r\n\r\n    describe('S3 Buckets', () => {\r\n      it('should have environment suffix in bucket names', () => {\r\n        template.hasResourceProperties('AWS::S3::Bucket', {\r\n          BucketName: { 'Fn::Join': ['', ['tdnet-data-collector-pdfs-prod-', { Ref: 'AWS::AccountId' }]] },\r\n        });\r\n\r\n        template.hasResourceProperties('AWS::S3::Bucket', {\r\n          BucketName: { 'Fn::Join': ['', ['tdnet-data-collector-exports-prod-', { Ref: 'AWS::AccountId' }]] },\r\n        });\r\n\r\n        template.hasResourceProperties('AWS::S3::Bucket', {\r\n          BucketName: { 'Fn::Join': ['', ['tdnet-dashboard-prod-', { Ref: 'AWS::AccountId' }]] },\r\n        });\r\n\r\n        // CloudTrail bucket does not have environment suffix (shared resource)\r\n        template.hasResourceProperties('AWS::S3::Bucket', {\r\n          BucketName: `tdnet-cloudtrail-logs-${testAccount}`,\r\n        });\r\n      });\r\n    });\r\n\r\n    describe('Lambda Functions', () => {\r\n      it('should have environment suffix in function names', () => {\r\n        template.hasResourceProperties('AWS::Lambda::Function', {\r\n          FunctionName: 'tdnet-collector-prod',\r\n        });\r\n\r\n        template.hasResourceProperties('AWS::Lambda::Function', {\r\n          FunctionName: 'tdnet-query-prod',\r\n        });\r\n\r\n        template.hasResourceProperties('AWS::Lambda::Function', {\r\n          FunctionName: 'tdnet-export-prod',\r\n        });\r\n\r\n        template.hasResourceProperties('AWS::Lambda::Function', {\r\n          FunctionName: 'tdnet-collector-prod', // Changed from tdnet-collect-prod\r\n        });\r\n\r\n        template.hasResourceProperties('AWS::Lambda::Function', {\r\n          FunctionName: 'tdnet-collect-status-prod',\r\n        });\r\n      });\r\n    });\r\n\r\n    describe('API Gateway', () => {\r\n      it('should have environment suffix in API name', () => {\r\n        template.hasResourceProperties('AWS::ApiGateway::RestApi', {\r\n          Name: 'tdnet-data-collector-api-prod',\r\n        });\r\n      });\r\n\r\n      it('should have environment suffix in API key name', () => {\r\n        template.hasResourceProperties('AWS::ApiGateway::ApiKey', {\r\n          Name: 'tdnet-api-key-prod',\r\n        });\r\n      });\r\n\r\n      it('should have environment suffix in usage plan name', () => {\r\n        template.hasResourceProperties('AWS::ApiGateway::UsagePlan', {\r\n          UsagePlanName: 'tdnet-usage-plan-prod',\r\n        });\r\n      });\r\n    });\r\n\r\n    describe('WAF', () => {\r\n      it('should have environment suffix in Web ACL name', () => {\r\n        template.hasResourceProperties('AWS::WAFv2::WebACL', {\r\n          Name: 'tdnet-web-acl-prod',\r\n        });\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('Default Environment (no config provided)', () => {\r\n    let template: Template;\r\n\r\n    beforeAll(() => {\r\n      const app = new cdk.App();\r\n      const stack = new TdnetDataCollectorStack(app, 'TestStack-default', {\r\n        env: { account: testAccount, region: testRegion },\r\n        // environmentConfig not provided - should default to 'dev'\r\n      });\r\n      template = Template.fromStack(stack);\r\n    });\r\n\r\n    it('should default to dev environment', () => {\r\n      template.hasResourceProperties('AWS::DynamoDB::Table', {\r\n        TableName: 'tdnet_disclosures_dev',\r\n      });\r\n\r\n      template.hasResourceProperties('AWS::Lambda::Function', {\r\n        FunctionName: 'tdnet-collector-dev',\r\n      });\r\n\r\n      template.hasResourceProperties('AWS::ApiGateway::RestApi', {\r\n        Name: 'tdnet-data-collector-api-dev',\r\n      });\r\n    });\r\n  });\r\n\r\n  describe('Resource Isolation', () => {\r\n    it('should create different resource names for dev and prod', () => {\r\n      const app = new cdk.App();\r\n      \r\n      const devStack = new TdnetDataCollectorStack(app, 'DevStack', {\r\n        env: { account: testAccount, region: testRegion },\r\n        environmentConfig: { environment: 'dev' },\r\n      });\r\n      \r\n      const prodStack = new TdnetDataCollectorStack(app, 'ProdStack', {\r\n        env: { account: testAccount, region: testRegion },\r\n        environmentConfig: { environment: 'prod' },\r\n      });\r\n\r\n      const devTemplate = Template.fromStack(devStack);\r\n      const prodTemplate = Template.fromStack(prodStack);\r\n\r\n      // Verify dev resources\r\n      devTemplate.hasResourceProperties('AWS::DynamoDB::Table', {\r\n        TableName: 'tdnet_disclosures_dev',\r\n      });\r\n\r\n      // Verify prod resources\r\n      prodTemplate.hasResourceProperties('AWS::DynamoDB::Table', {\r\n        TableName: 'tdnet_disclosures_prod',\r\n      });\r\n\r\n      // Ensure they are different\r\n      expect(devStack.disclosuresTable.tableName).not.toBe(\r\n        prodStack.disclosuresTable.tableName\r\n      );\r\n    });\r\n  });\r\n\r\n  describe('Environment Variable Propagation', () => {\r\n    let template: Template;\r\n\r\n    beforeAll(() => {\r\n      const app = new cdk.App();\r\n      const stack = new TdnetDataCollectorStack(app, 'TestStack-env-vars', {\r\n        env: { account: testAccount, region: testRegion },\r\n        environmentConfig: { environment: 'dev' },\r\n      });\r\n      template = Template.fromStack(stack);\r\n    });\r\n\r\n    it('should pass environment-specific table names to Lambda functions', () => {\r\n      // Collector function should have table references\r\n      const resources = template.toJSON().Resources;\r\n      const collectorFunction = Object.values(resources).find(\r\n        (r: any) => r.Type === 'AWS::Lambda::Function' && r.Properties?.FunctionName === 'tdnet-collector-dev'\r\n      ) as any;\r\n      \r\n      expect(collectorFunction).toBeDefined();\r\n      expect(collectorFunction.Properties.Environment.Variables.DYNAMODB_TABLE).toBeDefined();\r\n      expect(collectorFunction.Properties.Environment.Variables.DYNAMODB_EXECUTIONS_TABLE).toBeDefined();\r\n\r\n      // Query function should have table reference\r\n      const queryFunction = Object.values(resources).find(\r\n        (r: any) => r.Type === 'AWS::Lambda::Function' && r.Properties?.FunctionName === 'tdnet-query-dev'\r\n      ) as any;\r\n      \r\n      expect(queryFunction).toBeDefined();\r\n      expect(queryFunction.Properties.Environment.Variables.DYNAMODB_TABLE_NAME).toBeDefined();\r\n\r\n      // Export function should have table references\r\n      const exportFunction = Object.values(resources).find(\r\n        (r: any) => r.Type === 'AWS::Lambda::Function' && r.Properties?.FunctionName === 'tdnet-export-dev'\r\n      ) as any;\r\n      \r\n      expect(exportFunction).toBeDefined();\r\n      expect(exportFunction.Properties.Environment.Variables.DYNAMODB_TABLE_NAME).toBeDefined();\r\n      expect(exportFunction.Properties.Environment.Variables.EXPORT_STATUS_TABLE_NAME).toBeDefined();\r\n    });\r\n\r\n    it('should pass environment-specific bucket names to Lambda functions', () => {\r\n      const resources = template.toJSON().Resources;\r\n      \r\n      // Collector function should have bucket reference\r\n      const collectorFunction = Object.values(resources).find(\r\n        (r: any) => r.Type === 'AWS::Lambda::Function' && r.Properties?.FunctionName === 'tdnet-collector-dev'\r\n      ) as any;\r\n      \r\n      expect(collectorFunction).toBeDefined();\r\n      expect(collectorFunction.Properties.Environment.Variables.S3_BUCKET).toBeDefined();\r\n\r\n      // Query function should have bucket reference\r\n      const queryFunction = Object.values(resources).find(\r\n        (r: any) => r.Type === 'AWS::Lambda::Function' && r.Properties?.FunctionName === 'tdnet-query-dev'\r\n      ) as any;\r\n      \r\n      expect(queryFunction).toBeDefined();\r\n      expect(queryFunction.Properties.Environment.Variables.S3_BUCKET_NAME).toBeDefined();\r\n\r\n      // Export function should have bucket reference\r\n      const exportFunction = Object.values(resources).find(\r\n        (r: any) => r.Type === 'AWS::Lambda::Function' && r.Properties?.FunctionName === 'tdnet-export-dev'\r\n      ) as any;\r\n      \r\n      expect(exportFunction).toBeDefined();\r\n      expect(exportFunction.Properties.Environment.Variables.EXPORT_BUCKET_NAME).toBeDefined();\r\n    });\r\n  });\r\n});\r\n"],"version":3}