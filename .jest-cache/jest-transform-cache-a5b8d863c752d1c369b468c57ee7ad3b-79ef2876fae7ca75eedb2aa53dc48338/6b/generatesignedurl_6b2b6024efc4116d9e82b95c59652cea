d6e68f365964e8c62719758df3be7292
"use strict";

/**
 * 署名付きURL生成
 *
 * S3オブジェクトの署名付きURLを生成します（有効期限7日）。
 *
 * Requirements: 要件5.1（エクスポート）
 */
/* istanbul ignore next */
function cov_16ksq5qv17() {
  var path = "C:\\Users\\ti198\\investment_analysis_opopo\\src\\lambda\\export\\generate-signed-url.ts";
  var hash = "fb24218e0e31ea9d0166b1119a2fbe2252346bf1";
  var global = new Function("return this")();
  var gcv = "__coverage__";
  var coverageData = {
    path: "C:\\Users\\ti198\\investment_analysis_opopo\\src\\lambda\\export\\generate-signed-url.ts",
    statementMap: {
      "0": {
        start: {
          line: 9,
          column: 0
        },
        end: {
          line: 9,
          column: 62
        }
      },
      "1": {
        start: {
          line: 10,
          column: 0
        },
        end: {
          line: 10,
          column: 46
        }
      },
      "2": {
        start: {
          line: 11,
          column: 20
        },
        end: {
          line: 11,
          column: 49
        }
      },
      "3": {
        start: {
          line: 12,
          column: 31
        },
        end: {
          line: 12,
          column: 71
        }
      },
      "4": {
        start: {
          line: 13,
          column: 17
        },
        end: {
          line: 13,
          column: 46
        }
      },
      "5": {
        start: {
          line: 14,
          column: 17
        },
        end: {
          line: 14,
          column: 40
        }
      },
      "6": {
        start: {
          line: 16,
          column: 17
        },
        end: {
          line: 16,
          column: 97
        }
      },
      "7": {
        start: {
          line: 18,
          column: 22
        },
        end: {
          line: 18,
          column: 71
        }
      },
      "8": {
        start: {
          line: 29,
          column: 4
        },
        end: {
          line: 64,
          column: 5
        }
      },
      "9": {
        start: {
          line: 30,
          column: 8
        },
        end: {
          line: 33,
          column: 11
        }
      },
      "10": {
        start: {
          line: 35,
          column: 24
        },
        end: {
          line: 38,
          column: 10
        }
      },
      "11": {
        start: {
          line: 40,
          column: 26
        },
        end: {
          line: 40,
          column: 106
        }
      },
      "12": {
        start: {
          line: 41,
          column: 8
        },
        end: {
          line: 44,
          column: 11
        }
      },
      "13": {
        start: {
          line: 45,
          column: 8
        },
        end: {
          line: 45,
          column: 25
        }
      },
      "14": {
        start: {
          line: 49,
          column: 25
        },
        end: {
          line: 49,
          column: 30
        }
      },
      "15": {
        start: {
          line: 50,
          column: 26
        },
        end: {
          line: 50,
          column: 40
        }
      },
      "16": {
        start: {
          line: 51,
          column: 29
        },
        end: {
          line: 51,
          column: 46
        }
      },
      "17": {
        start: {
          line: 52,
          column: 27
        },
        end: {
          line: 52,
          column: 42
        }
      },
      "18": {
        start: {
          line: 53,
          column: 8
        },
        end: {
          line: 58,
          column: 11
        }
      },
      "19": {
        start: {
          line: 60,
          column: 8
        },
        end: {
          line: 63,
          column: 11
        }
      }
    },
    fnMap: {
      "0": {
        name: "generateSignedUrl",
        decl: {
          start: {
            line: 27,
            column: 15
          },
          end: {
            line: 27,
            column: 32
          }
        },
        loc: {
          start: {
            line: 28,
            column: 2
          },
          end: {
            line: 65,
            column: 1
          }
        },
        line: 28
      }
    },
    branchMap: {
      "0": {
        loc: {
          start: {
            line: 16,
            column: 52
          },
          end: {
            line: 16,
            column: 94
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 16,
            column: 52
          },
          end: {
            line: 16,
            column: 74
          }
        }, {
          start: {
            line: 16,
            column: 78
          },
          end: {
            line: 16,
            column: 94
          }
        }],
        line: 16
      },
      "1": {
        loc: {
          start: {
            line: 18,
            column: 22
          },
          end: {
            line: 18,
            column: 71
          }
        },
        type: "binary-expr",
        locations: [{
          start: {
            line: 18,
            column: 22
          },
          end: {
            line: 18,
            column: 52
          }
        }, {
          start: {
            line: 18,
            column: 56
          },
          end: {
            line: 18,
            column: 71
          }
        }],
        line: 18
      },
      "2": {
        loc: {
          start: {
            line: 27,
            column: 41
          },
          end: {
            line: 27,
            column: 69
          }
        },
        type: "default-arg",
        locations: [{
          start: {
            line: 27,
            column: 53
          },
          end: {
            line: 27,
            column: 69
          }
        }],
        line: 27
      }
    },
    s: {
      "0": 0,
      "1": 0,
      "2": 0,
      "3": 0,
      "4": 0,
      "5": 0,
      "6": 0,
      "7": 0,
      "8": 0,
      "9": 0,
      "10": 0,
      "11": 0,
      "12": 0,
      "13": 0,
      "14": 0,
      "15": 0,
      "16": 0,
      "17": 0,
      "18": 0,
      "19": 0
    },
    f: {
      "0": 0
    },
    b: {
      "0": [0, 0],
      "1": [0, 0],
      "2": [0]
    },
    inputSourceMap: {
      file: "C:\\Users\\ti198\\investment_analysis_opopo\\src\\lambda\\export\\generate-signed-url.ts",
      mappings: ";AAAA;;;;;;GAMG;;AAqBH,8CA6CC;AAhED,kDAAgE;AAChE,wEAA6D;AAC7D,+CAA4C;AAC5C,yCAA8C;AAE9C,0BAA0B;AAC1B,MAAM,QAAQ,GAAG,IAAI,oBAAQ,CAAC,EAAE,MAAM,EAAE,OAAO,CAAC,GAAG,CAAC,UAAU,IAAI,gBAAgB,EAAE,CAAC,CAAC;AAEtF,OAAO;AACP,MAAM,aAAa,GAAG,OAAO,CAAC,GAAG,CAAC,kBAAkB,IAAI,eAAe,CAAC;AAExE;;;;;;;GAOG;AACI,KAAK,UAAU,iBAAiB,CACrC,MAAc,EACd,YAAoB,CAAC,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,CAAC,aAAa;;IAElD,IAAI,CAAC;QACH,eAAM,CAAC,IAAI,CAAC,uBAAuB,EAAE;YACnC,MAAM;YACN,UAAU,EAAE,SAAS;SACtB,CAAC,CAAC;QAEH,sBAAsB;QACtB,MAAM,OAAO,GAAG,IAAI,4BAAgB,CAAC;YACnC,MAAM,EAAE,aAAa;YACrB,GAAG,EAAE,MAAM;SACZ,CAAC,CAAC;QAEH,aAAa;QACb,MAAM,SAAS,GAAG,MAAM,IAAA,mCAAY,EAAC,QAAQ,EAAE,OAAO,EAAE,EAAE,SAAS,EAAE,CAAC,CAAC;QAEvE,eAAM,CAAC,IAAI,CAAC,mCAAmC,EAAE;YAC/C,MAAM;YACN,UAAU,EAAE,SAAS;SACtB,CAAC,CAAC;QAEH,OAAO,SAAS,CAAC;IACnB,CAAC;IAAC,OAAO,KAAK,EAAE,CAAC;QACf,wBAAwB;QACxB,MAAM,QAAQ,GAAG,KAAY,CAAC;QAC9B,MAAM,SAAS,GAAG,QAAQ,EAAE,IAAI,CAAC;QACjC,MAAM,YAAY,GAAG,QAAQ,EAAE,OAAO,CAAC;QACvC,MAAM,UAAU,GAAG,QAAQ,EAAE,KAAK,CAAC;QAEnC,eAAM,CAAC,KAAK,CAAC,+BAA+B,EAAE;YAC5C,UAAU,EAAE,SAAS;YACrB,aAAa,EAAE,YAAY;YAC3B,OAAO,EAAE,EAAE,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE;YAC1C,WAAW,EAAE,UAAU;SACxB,CAAC,CAAC;QAEH,cAAc;QACd,MAAM,IAAI,uBAAc,CAAC,+BAA+B,EAAE;YACxD,KAAK,EAAE,KAAK;YACZ,OAAO,EAAE,EAAE,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE;SAC3C,CAAC,CAAC;IACL,CAAC;AACH,CAAC",
      names: [],
      sources: ["C:\\Users\\ti198\\investment_analysis_opopo\\src\\lambda\\export\\generate-signed-url.ts"],
      sourcesContent: ["/**\r\n * \u7F72\u540D\u4ED8\u304DURL\u751F\u6210\r\n *\r\n * S3\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u306E\u7F72\u540D\u4ED8\u304DURL\u3092\u751F\u6210\u3057\u307E\u3059\uFF08\u6709\u52B9\u671F\u96507\u65E5\uFF09\u3002\r\n *\r\n * Requirements: \u8981\u4EF65.1\uFF08\u30A8\u30AF\u30B9\u30DD\u30FC\u30C8\uFF09\r\n */\r\n\r\nimport { S3Client, GetObjectCommand } from '@aws-sdk/client-s3';\r\nimport { getSignedUrl } from '@aws-sdk/s3-request-presigner';\r\nimport { logger } from '../../utils/logger';\r\nimport { RetryableError } from '../../errors';\r\n\r\n// S3\u30AF\u30E9\u30A4\u30A2\u30F3\u30C8\uFF08\u30B0\u30ED\u30FC\u30D0\u30EB\u30B9\u30B3\u30FC\u30D7\u3067\u521D\u671F\u5316\uFF09\r\nconst s3Client = new S3Client({ region: process.env.AWS_REGION || 'ap-northeast-1' });\r\n\r\n// \u74B0\u5883\u5909\u6570\r\nconst EXPORT_BUCKET = process.env.EXPORT_BUCKET_NAME || 'tdnet-exports';\r\n\r\n/**\r\n * \u7F72\u540D\u4ED8\u304DURL\u3092\u751F\u6210\r\n *\r\n * @param s3_key S3\u30AD\u30FC\r\n * @param expiresIn \u6709\u52B9\u671F\u9650\uFF08\u79D2\uFF09\r\n * @returns \u7F72\u540D\u4ED8\u304DURL\r\n * @throws {RetryableError} S3\u30A2\u30AF\u30BB\u30B9\u30A8\u30E9\u30FC\u6642\r\n */\r\nexport async function generateSignedUrl(\r\n  s3_key: string,\r\n  expiresIn: number = 7 * 24 * 60 * 60 // \u30C7\u30D5\u30A9\u30EB\u30C8: 7\u65E5\u9593\r\n): Promise<string> {\r\n  try {\r\n    logger.info('Generating signed URL', {\r\n      s3_key,\r\n      expires_in: expiresIn,\r\n    });\r\n\r\n    // GetObjectCommand\u3092\u4F5C\u6210\r\n    const command = new GetObjectCommand({\r\n      Bucket: EXPORT_BUCKET,\r\n      Key: s3_key,\r\n    });\r\n\r\n    // \u7F72\u540D\u4ED8\u304DURL\u3092\u751F\u6210\r\n    const signedUrl = await getSignedUrl(s3Client, command, { expiresIn });\r\n\r\n    logger.info('Signed URL generated successfully', {\r\n      s3_key,\r\n      signed_url: signedUrl,\r\n    });\r\n\r\n    return signedUrl;\r\n  } catch (error) {\r\n    // \u30A8\u30E9\u30FC\u30AA\u30D6\u30B8\u30A7\u30AF\u30C8\u306E\u30D7\u30ED\u30D1\u30C6\u30A3\u3092\u5B89\u5168\u306B\u53D6\u5F97\r\n    const errorObj = error as any;\r\n    const errorType = errorObj?.name;\r\n    const errorMessage = errorObj?.message;\r\n    const stackTrace = errorObj?.stack;\r\n\r\n    logger.error('Failed to generate signed URL', {\r\n      error_type: errorType,\r\n      error_message: errorMessage,\r\n      context: { s3_key, expires_in: expiresIn },\r\n      stack_trace: stackTrace,\r\n    });\r\n\r\n    // S3\u30A8\u30E9\u30FC\u306F\u518D\u8A66\u884C\u53EF\u80FD\r\n    throw new RetryableError('Failed to generate signed URL', {\r\n      cause: error,\r\n      context: { s3_key, expires_in: expiresIn },\r\n    });\r\n  }\r\n}\r\n"],
      version: 3
    },
    _coverageSchema: "1a1c01bbd47fc00a2c39e90264f33305004495a9",
    hash: "fb24218e0e31ea9d0166b1119a2fbe2252346bf1"
  };
  var coverage = global[gcv] || (global[gcv] = {});
  if (!coverage[path] || coverage[path].hash !== hash) {
    coverage[path] = coverageData;
  }
  var actualCoverage = coverage[path];
  {
    // @ts-ignore
    cov_16ksq5qv17 = function () {
      return actualCoverage;
    };
  }
  return actualCoverage;
}
cov_16ksq5qv17();
cov_16ksq5qv17().s[0]++;
Object.defineProperty(exports, "__esModule", {
  value: true
});
/* istanbul ignore next */
cov_16ksq5qv17().s[1]++;
exports.generateSignedUrl = generateSignedUrl;
const client_s3_1 =
/* istanbul ignore next */
(cov_16ksq5qv17().s[2]++, require("@aws-sdk/client-s3"));
const s3_request_presigner_1 =
/* istanbul ignore next */
(cov_16ksq5qv17().s[3]++, require("@aws-sdk/s3-request-presigner"));
const logger_1 =
/* istanbul ignore next */
(cov_16ksq5qv17().s[4]++, require("../../utils/logger"));
const errors_1 =
/* istanbul ignore next */
(cov_16ksq5qv17().s[5]++, require("../../errors"));
// S3クライアント（グローバルスコープで初期化）
const s3Client =
/* istanbul ignore next */
(cov_16ksq5qv17().s[6]++, new client_s3_1.S3Client({
  region: 
  /* istanbul ignore next */
  (cov_16ksq5qv17().b[0][0]++, process.env.AWS_REGION) ||
  /* istanbul ignore next */
  (cov_16ksq5qv17().b[0][1]++, 'ap-northeast-1')
}));
// 環境変数
const EXPORT_BUCKET =
/* istanbul ignore next */
(cov_16ksq5qv17().s[7]++, 
/* istanbul ignore next */
(cov_16ksq5qv17().b[1][0]++, process.env.EXPORT_BUCKET_NAME) ||
/* istanbul ignore next */
(cov_16ksq5qv17().b[1][1]++, 'tdnet-exports'));
/**
 * 署名付きURLを生成
 *
 * @param s3_key S3キー
 * @param expiresIn 有効期限（秒）
 * @returns 署名付きURL
 * @throws {RetryableError} S3アクセスエラー時
 */
async function generateSignedUrl(s3_key, expiresIn =
/* istanbul ignore next */
(cov_16ksq5qv17().b[2][0]++, 7 * 24 * 60 * 60) // デフォルト: 7日間
) {
  /* istanbul ignore next */
  cov_16ksq5qv17().f[0]++;
  cov_16ksq5qv17().s[8]++;
  try {
    /* istanbul ignore next */
    cov_16ksq5qv17().s[9]++;
    logger_1.logger.info('Generating signed URL', {
      s3_key,
      expires_in: expiresIn
    });
    // GetObjectCommandを作成
    const command =
    /* istanbul ignore next */
    (cov_16ksq5qv17().s[10]++, new client_s3_1.GetObjectCommand({
      Bucket: EXPORT_BUCKET,
      Key: s3_key
    }));
    // 署名付きURLを生成
    const signedUrl =
    /* istanbul ignore next */
    (cov_16ksq5qv17().s[11]++, await (0, s3_request_presigner_1.getSignedUrl)(s3Client, command, {
      expiresIn
    }));
    /* istanbul ignore next */
    cov_16ksq5qv17().s[12]++;
    logger_1.logger.info('Signed URL generated successfully', {
      s3_key,
      signed_url: signedUrl
    });
    /* istanbul ignore next */
    cov_16ksq5qv17().s[13]++;
    return signedUrl;
  } catch (error) {
    // エラーオブジェクトのプロパティを安全に取得
    const errorObj =
    /* istanbul ignore next */
    (cov_16ksq5qv17().s[14]++, error);
    const errorType =
    /* istanbul ignore next */
    (cov_16ksq5qv17().s[15]++, errorObj?.name);
    const errorMessage =
    /* istanbul ignore next */
    (cov_16ksq5qv17().s[16]++, errorObj?.message);
    const stackTrace =
    /* istanbul ignore next */
    (cov_16ksq5qv17().s[17]++, errorObj?.stack);
    /* istanbul ignore next */
    cov_16ksq5qv17().s[18]++;
    logger_1.logger.error('Failed to generate signed URL', {
      error_type: errorType,
      error_message: errorMessage,
      context: {
        s3_key,
        expires_in: expiresIn
      },
      stack_trace: stackTrace
    });
    // S3エラーは再試行可能
    /* istanbul ignore next */
    cov_16ksq5qv17().s[19]++;
    throw new errors_1.RetryableError('Failed to generate signed URL', {
      cause: error,
      context: {
        s3_key,
        expires_in: expiresIn
      }
    });
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJjb3ZfMTZrc3E1cXYxNyIsInBhdGgiLCJoYXNoIiwiZ2xvYmFsIiwiRnVuY3Rpb24iLCJnY3YiLCJjb3ZlcmFnZURhdGEiLCJzdGF0ZW1lbnRNYXAiLCJzdGFydCIsImxpbmUiLCJjb2x1bW4iLCJlbmQiLCJmbk1hcCIsIm5hbWUiLCJkZWNsIiwibG9jIiwiYnJhbmNoTWFwIiwidHlwZSIsImxvY2F0aW9ucyIsInMiLCJmIiwiYiIsImlucHV0U291cmNlTWFwIiwiZmlsZSIsIm1hcHBpbmdzIiwibmFtZXMiLCJzb3VyY2VzIiwic291cmNlc0NvbnRlbnQiLCJ2ZXJzaW9uIiwiX2NvdmVyYWdlU2NoZW1hIiwiY292ZXJhZ2UiLCJhY3R1YWxDb3ZlcmFnZSIsImV4cG9ydHMiLCJnZW5lcmF0ZVNpZ25lZFVybCIsImNsaWVudF9zM18xIiwicmVxdWlyZSIsInMzX3JlcXVlc3RfcHJlc2lnbmVyXzEiLCJsb2dnZXJfMSIsImVycm9yc18xIiwiczNDbGllbnQiLCJTM0NsaWVudCIsInJlZ2lvbiIsInByb2Nlc3MiLCJlbnYiLCJBV1NfUkVHSU9OIiwiRVhQT1JUX0JVQ0tFVCIsIkVYUE9SVF9CVUNLRVRfTkFNRSIsInMzX2tleSIsImV4cGlyZXNJbiIsImxvZ2dlciIsImluZm8iLCJleHBpcmVzX2luIiwiY29tbWFuZCIsIkdldE9iamVjdENvbW1hbmQiLCJCdWNrZXQiLCJLZXkiLCJzaWduZWRVcmwiLCJnZXRTaWduZWRVcmwiLCJzaWduZWRfdXJsIiwiZXJyb3IiLCJlcnJvck9iaiIsImVycm9yVHlwZSIsImVycm9yTWVzc2FnZSIsIm1lc3NhZ2UiLCJzdGFja1RyYWNlIiwic3RhY2siLCJlcnJvcl90eXBlIiwiZXJyb3JfbWVzc2FnZSIsImNvbnRleHQiLCJzdGFja190cmFjZSIsIlJldHJ5YWJsZUVycm9yIiwiY2F1c2UiXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXHRpMTk4XFxpbnZlc3RtZW50X2FuYWx5c2lzX29wb3BvXFxzcmNcXGxhbWJkYVxcZXhwb3J0XFxnZW5lcmF0ZS1zaWduZWQtdXJsLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiDnvbLlkI3ku5jjgY1VUkznlJ/miJBcclxuICpcclxuICogUzPjgqrjg5bjgrjjgqfjgq/jg4jjga7nvbLlkI3ku5jjgY1VUkzjgpLnlJ/miJDjgZfjgb7jgZnvvIjmnInlirnmnJ/pmZA35pel77yJ44CCXHJcbiAqXHJcbiAqIFJlcXVpcmVtZW50czog6KaB5Lu2NS4x77yI44Ko44Kv44K544Od44O844OI77yJXHJcbiAqL1xyXG5cclxuaW1wb3J0IHsgUzNDbGllbnQsIEdldE9iamVjdENvbW1hbmQgfSBmcm9tICdAYXdzLXNkay9jbGllbnQtczMnO1xyXG5pbXBvcnQgeyBnZXRTaWduZWRVcmwgfSBmcm9tICdAYXdzLXNkay9zMy1yZXF1ZXN0LXByZXNpZ25lcic7XHJcbmltcG9ydCB7IGxvZ2dlciB9IGZyb20gJy4uLy4uL3V0aWxzL2xvZ2dlcic7XHJcbmltcG9ydCB7IFJldHJ5YWJsZUVycm9yIH0gZnJvbSAnLi4vLi4vZXJyb3JzJztcclxuXHJcbi8vIFMz44Kv44Op44Kk44Ki44Oz44OI77yI44Kw44Ot44O844OQ44Or44K544Kz44O844OX44Gn5Yid5pyf5YyW77yJXHJcbmNvbnN0IHMzQ2xpZW50ID0gbmV3IFMzQ2xpZW50KHsgcmVnaW9uOiBwcm9jZXNzLmVudi5BV1NfUkVHSU9OIHx8ICdhcC1ub3J0aGVhc3QtMScgfSk7XHJcblxyXG4vLyDnkrDlooPlpInmlbBcclxuY29uc3QgRVhQT1JUX0JVQ0tFVCA9IHByb2Nlc3MuZW52LkVYUE9SVF9CVUNLRVRfTkFNRSB8fCAndGRuZXQtZXhwb3J0cyc7XHJcblxyXG4vKipcclxuICog572y5ZCN5LuY44GNVVJM44KS55Sf5oiQXHJcbiAqXHJcbiAqIEBwYXJhbSBzM19rZXkgUzPjgq3jg7xcclxuICogQHBhcmFtIGV4cGlyZXNJbiDmnInlirnmnJ/pmZDvvIjnp5LvvIlcclxuICogQHJldHVybnMg572y5ZCN5LuY44GNVVJMXHJcbiAqIEB0aHJvd3Mge1JldHJ5YWJsZUVycm9yfSBTM+OCouOCr+OCu+OCueOCqOODqeODvOaZglxyXG4gKi9cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdlbmVyYXRlU2lnbmVkVXJsKFxyXG4gIHMzX2tleTogc3RyaW5nLFxyXG4gIGV4cGlyZXNJbjogbnVtYmVyID0gNyAqIDI0ICogNjAgKiA2MCAvLyDjg4fjg5Xjgqnjg6vjg4g6IDfml6XplpNcclxuKTogUHJvbWlzZTxzdHJpbmc+IHtcclxuICB0cnkge1xyXG4gICAgbG9nZ2VyLmluZm8oJ0dlbmVyYXRpbmcgc2lnbmVkIFVSTCcsIHtcclxuICAgICAgczNfa2V5LFxyXG4gICAgICBleHBpcmVzX2luOiBleHBpcmVzSW4sXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBHZXRPYmplY3RDb21tYW5k44KS5L2c5oiQXHJcbiAgICBjb25zdCBjb21tYW5kID0gbmV3IEdldE9iamVjdENvbW1hbmQoe1xyXG4gICAgICBCdWNrZXQ6IEVYUE9SVF9CVUNLRVQsXHJcbiAgICAgIEtleTogczNfa2V5LFxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8g572y5ZCN5LuY44GNVVJM44KS55Sf5oiQXHJcbiAgICBjb25zdCBzaWduZWRVcmwgPSBhd2FpdCBnZXRTaWduZWRVcmwoczNDbGllbnQsIGNvbW1hbmQsIHsgZXhwaXJlc0luIH0pO1xyXG5cclxuICAgIGxvZ2dlci5pbmZvKCdTaWduZWQgVVJMIGdlbmVyYXRlZCBzdWNjZXNzZnVsbHknLCB7XHJcbiAgICAgIHMzX2tleSxcclxuICAgICAgc2lnbmVkX3VybDogc2lnbmVkVXJsLFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmV0dXJuIHNpZ25lZFVybDtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgLy8g44Ko44Op44O844Kq44OW44K444Kn44Kv44OI44Gu44OX44Ot44OR44OG44Kj44KS5a6J5YWo44Gr5Y+W5b6XXHJcbiAgICBjb25zdCBlcnJvck9iaiA9IGVycm9yIGFzIGFueTtcclxuICAgIGNvbnN0IGVycm9yVHlwZSA9IGVycm9yT2JqPy5uYW1lO1xyXG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3JPYmo/Lm1lc3NhZ2U7XHJcbiAgICBjb25zdCBzdGFja1RyYWNlID0gZXJyb3JPYmo/LnN0YWNrO1xyXG5cclxuICAgIGxvZ2dlci5lcnJvcignRmFpbGVkIHRvIGdlbmVyYXRlIHNpZ25lZCBVUkwnLCB7XHJcbiAgICAgIGVycm9yX3R5cGU6IGVycm9yVHlwZSxcclxuICAgICAgZXJyb3JfbWVzc2FnZTogZXJyb3JNZXNzYWdlLFxyXG4gICAgICBjb250ZXh0OiB7IHMzX2tleSwgZXhwaXJlc19pbjogZXhwaXJlc0luIH0sXHJcbiAgICAgIHN0YWNrX3RyYWNlOiBzdGFja1RyYWNlLFxyXG4gICAgfSk7XHJcblxyXG4gICAgLy8gUzPjgqjjg6njg7zjga/lho3oqabooYzlj6/og71cclxuICAgIHRocm93IG5ldyBSZXRyeWFibGVFcnJvcignRmFpbGVkIHRvIGdlbmVyYXRlIHNpZ25lZCBVUkwnLCB7XHJcbiAgICAgIGNhdXNlOiBlcnJvcixcclxuICAgICAgY29udGV4dDogeyBzM19rZXksIGV4cGlyZXNfaW46IGV4cGlyZXNJbiB9LFxyXG4gICAgfSk7XHJcbiAgfVxyXG59XHJcbiJdLCJtYXBwaW5ncyI6Ijs7QUFBQTs7Ozs7OztBQUFBO0FBQUEsU0FBQUEsZUFBQTtFQUFBLElBQUFDLElBQUE7RUFBQSxJQUFBQyxJQUFBO0VBQUEsSUFBQUMsTUFBQSxPQUFBQyxRQUFBO0VBQUEsSUFBQUMsR0FBQTtFQUFBLElBQUFDLFlBQUE7SUFBQUwsSUFBQTtJQUFBTSxZQUFBO01BQUE7UUFBQUMsS0FBQTtVQUFBQyxJQUFBO1VBQUFDLE1BQUE7UUFBQTtRQUFBQyxHQUFBO1VBQUFGLElBQUE7VUFBQUMsTUFBQTtRQUFBO01BQUE7TUFBQTtRQUFBRixLQUFBO1VBQUFDLElBQUE7VUFBQUMsTUFBQTtRQUFBO1FBQUFDLEdBQUE7VUFBQUYsSUFBQTtVQUFBQyxNQUFBO1FBQUE7TUFBQTtNQUFBO1FBQUFGLEtBQUE7VUFBQUMsSUFBQTtVQUFBQyxNQUFBO1FBQUE7UUFBQUMsR0FBQTtVQUFBRixJQUFBO1VBQUFDLE1BQUE7UUFBQTtNQUFBO01BQUE7UUFBQUYsS0FBQTtVQUFBQyxJQUFBO1VBQUFDLE1BQUE7UUFBQTtRQUFBQyxHQUFBO1VBQUFGLElBQUE7VUFBQUMsTUFBQTtRQUFBO01BQUE7TUFBQTtRQUFBRixLQUFBO1VBQUFDLElBQUE7VUFBQUMsTUFBQTtRQUFBO1FBQUFDLEdBQUE7VUFBQUYsSUFBQTtVQUFBQyxNQUFBO1FBQUE7TUFBQTtNQUFBO1FBQUFGLEtBQUE7VUFBQUMsSUFBQTtVQUFBQyxNQUFBO1FBQUE7UUFBQUMsR0FBQTtVQUFBRixJQUFBO1VBQUFDLE1BQUE7UUFBQTtNQUFBO01BQUE7UUFBQUYsS0FBQTtVQUFBQyxJQUFBO1VBQUFDLE1BQUE7UUFBQTtRQUFBQyxHQUFBO1VBQUFGLElBQUE7VUFBQUMsTUFBQTtRQUFBO01BQUE7TUFBQTtRQUFBRixLQUFBO1VBQUFDLElBQUE7VUFBQUMsTUFBQTtRQUFBO1FBQUFDLEdBQUE7VUFBQUYsSUFBQTtVQUFBQyxNQUFBO1FBQUE7TUFBQTtNQUFBO1FBQUFGLEtBQUE7VUFBQUMsSUFBQTtVQUFBQyxNQUFBO1FBQUE7UUFBQUMsR0FBQTtVQUFBRixJQUFBO1VBQUFDLE1BQUE7UUFBQTtNQUFBO01BQUE7UUFBQUYsS0FBQTtVQUFBQyxJQUFBO1VBQUFDLE1BQUE7UUFBQTtRQUFBQyxHQUFBO1VBQUFGLElBQUE7VUFBQUMsTUFBQTtRQUFBO01BQUE7TUFBQTtRQUFBRixLQUFBO1VBQUFDLElBQUE7VUFBQUMsTUFBQTtRQUFBO1FBQUFDLEdBQUE7VUFBQUYsSUFBQTtVQUFBQyxNQUFBO1FBQUE7TUFBQTtNQUFBO1FBQUFGLEtBQUE7VUFBQUMsSUFBQTtVQUFBQyxNQUFBO1FBQUE7UUFBQUMsR0FBQTtVQUFBRixJQUFBO1VBQUFDLE1BQUE7UUFBQTtNQUFBO01BQUE7UUFBQUYsS0FBQTtVQUFBQyxJQUFBO1VBQUFDLE1BQUE7UUFBQTtRQUFBQyxHQUFBO1VBQUFGLElBQUE7VUFBQUMsTUFBQTtRQUFBO01BQUE7TUFBQTtRQUFBRixLQUFBO1VBQUFDLElBQUE7VUFBQUMsTUFBQTtRQUFBO1FBQUFDLEdBQUE7VUFBQUYsSUFBQTtVQUFBQyxNQUFBO1FBQUE7TUFBQTtNQUFBO1FBQUFGLEtBQUE7VUFBQUMsSUFBQTtVQUFBQyxNQUFBO1FBQUE7UUFBQUMsR0FBQTtVQUFBRixJQUFBO1VBQUFDLE1BQUE7UUFBQTtNQUFBO01BQUE7UUFBQUYsS0FBQTtVQUFBQyxJQUFBO1VBQUFDLE1BQUE7UUFBQTtRQUFBQyxHQUFBO1VBQUFGLElBQUE7VUFBQUMsTUFBQTtRQUFBO01BQUE7TUFBQTtRQUFBRixLQUFBO1VBQUFDLElBQUE7VUFBQUMsTUFBQTtRQUFBO1FBQUFDLEdBQUE7VUFBQUYsSUFBQTtVQUFBQyxNQUFBO1FBQUE7TUFBQTtNQUFBO1FBQUFGLEtBQUE7VUFBQUMsSUFBQTtVQUFBQyxNQUFBO1FBQUE7UUFBQUMsR0FBQTtVQUFBRixJQUFBO1VBQUFDLE1BQUE7UUFBQTtNQUFBO01BQUE7UUFBQUYsS0FBQTtVQUFBQyxJQUFBO1VBQUFDLE1BQUE7UUFBQTtRQUFBQyxHQUFBO1VBQUFGLElBQUE7VUFBQUMsTUFBQTtRQUFBO01BQUE7TUFBQTtRQUFBRixLQUFBO1VBQUFDLElBQUE7VUFBQUMsTUFBQTtRQUFBO1FBQUFDLEdBQUE7VUFBQUYsSUFBQTtVQUFBQyxNQUFBO1FBQUE7TUFBQTtJQUFBO0lBQUFFLEtBQUE7TUFBQTtRQUFBQyxJQUFBO1FBQUFDLElBQUE7VUFBQU4sS0FBQTtZQUFBQyxJQUFBO1lBQUFDLE1BQUE7VUFBQTtVQUFBQyxHQUFBO1lBQUFGLElBQUE7WUFBQUMsTUFBQTtVQUFBO1FBQUE7UUFBQUssR0FBQTtVQUFBUCxLQUFBO1lBQUFDLElBQUE7WUFBQUMsTUFBQTtVQUFBO1VBQUFDLEdBQUE7WUFBQUYsSUFBQTtZQUFBQyxNQUFBO1VBQUE7UUFBQTtRQUFBRCxJQUFBO01BQUE7SUFBQTtJQUFBTyxTQUFBO01BQUE7UUFBQUQsR0FBQTtVQUFBUCxLQUFBO1lBQUFDLElBQUE7WUFBQUMsTUFBQTtVQUFBO1VBQUFDLEdBQUE7WUFBQUYsSUFBQTtZQUFBQyxNQUFBO1VBQUE7UUFBQTtRQUFBTyxJQUFBO1FBQUFDLFNBQUE7VUFBQVYsS0FBQTtZQUFBQyxJQUFBO1lBQUFDLE1BQUE7VUFBQTtVQUFBQyxHQUFBO1lBQUFGLElBQUE7WUFBQUMsTUFBQTtVQUFBO1FBQUE7VUFBQUYsS0FBQTtZQUFBQyxJQUFBO1lBQUFDLE1BQUE7VUFBQTtVQUFBQyxHQUFBO1lBQUFGLElBQUE7WUFBQUMsTUFBQTtVQUFBO1FBQUE7UUFBQUQsSUFBQTtNQUFBO01BQUE7UUFBQU0sR0FBQTtVQUFBUCxLQUFBO1lBQUFDLElBQUE7WUFBQUMsTUFBQTtVQUFBO1VBQUFDLEdBQUE7WUFBQUYsSUFBQTtZQUFBQyxNQUFBO1VBQUE7UUFBQTtRQUFBTyxJQUFBO1FBQUFDLFNBQUE7VUFBQVYsS0FBQTtZQUFBQyxJQUFBO1lBQUFDLE1BQUE7VUFBQTtVQUFBQyxHQUFBO1lBQUFGLElBQUE7WUFBQUMsTUFBQTtVQUFBO1FBQUE7VUFBQUYsS0FBQTtZQUFBQyxJQUFBO1lBQUFDLE1BQUE7VUFBQTtVQUFBQyxHQUFBO1lBQUFGLElBQUE7WUFBQUMsTUFBQTtVQUFBO1FBQUE7UUFBQUQsSUFBQTtNQUFBO01BQUE7UUFBQU0sR0FBQTtVQUFBUCxLQUFBO1lBQUFDLElBQUE7WUFBQUMsTUFBQTtVQUFBO1VBQUFDLEdBQUE7WUFBQUYsSUFBQTtZQUFBQyxNQUFBO1VBQUE7UUFBQTtRQUFBTyxJQUFBO1FBQUFDLFNBQUE7VUFBQVYsS0FBQTtZQUFBQyxJQUFBO1lBQUFDLE1BQUE7VUFBQTtVQUFBQyxHQUFBO1lBQUFGLElBQUE7WUFBQUMsTUFBQTtVQUFBO1FBQUE7UUFBQUQsSUFBQTtNQUFBO0lBQUE7SUFBQVUsQ0FBQTtNQUFBO01BQUE7TUFBQTtNQUFBO01BQUE7TUFBQTtNQUFBO01BQUE7TUFBQTtNQUFBO01BQUE7TUFBQTtNQUFBO01BQUE7TUFBQTtNQUFBO01BQUE7TUFBQTtNQUFBO01BQUE7SUFBQTtJQUFBQyxDQUFBO01BQUE7SUFBQTtJQUFBQyxDQUFBO01BQUE7TUFBQTtNQUFBO0lBQUE7SUFBQUMsY0FBQTtNQUFBQyxJQUFBO01BQUFDLFFBQUE7TUFBQUMsS0FBQTtNQUFBQyxPQUFBO01BQUFDLGNBQUE7TUFBQUMsT0FBQTtJQUFBO0lBQUFDLGVBQUE7SUFBQTNCLElBQUE7RUFBQTtFQUFBLElBQUE0QixRQUFBLEdBQUEzQixNQUFBLENBQUFFLEdBQUEsTUFBQUYsTUFBQSxDQUFBRSxHQUFBO0VBQUEsS0FBQXlCLFFBQUEsQ0FBQTdCLElBQUEsS0FBQTZCLFFBQUEsQ0FBQTdCLElBQUEsRUFBQUMsSUFBQSxLQUFBQSxJQUFBO0lBQUE0QixRQUFBLENBQUE3QixJQUFBLElBQUFLLFlBQUE7RUFBQTtFQUFBLElBQUF5QixjQUFBLEdBQUFELFFBQUEsQ0FBQTdCLElBQUE7RUFBQTtJQWNNO0lBQUFELGNBQUEsWUFBQUEsQ0FBQTtNQUFBLE9BQUErQixjQUFBO0lBQUE7RUFBQTtFQUFBLE9BQUFBLGNBQUE7QUFBQTtBQUFBL0IsY0FBQTtBQUFBQSxjQUFBLEdBQUFtQixDQUFBOzs7Ozs7QUFhTmEsT0FBQSxDQUFBQyxpQkFBQSxHQUFBQSxpQkFBQTtBQW5CQSxNQUFBQyxXQUFBO0FBQUE7QUFBQSxDQUFBbEMsY0FBQSxHQUFBbUIsQ0FBQSxPQUFBZ0IsT0FBQTtBQUNBLE1BQUFDLHNCQUFBO0FBQUE7QUFBQSxDQUFBcEMsY0FBQSxHQUFBbUIsQ0FBQSxPQUFBZ0IsT0FBQTtBQUNBLE1BQUFFLFFBQUE7QUFBQTtBQUFBLENBQUFyQyxjQUFBLEdBQUFtQixDQUFBLE9BQUFnQixPQUFBO0FBQ0EsTUFBQUcsUUFBQTtBQUFBO0FBQUEsQ0FBQXRDLGNBQUEsR0FBQW1CLENBQUEsT0FBQWdCLE9BQUE7QUFFQTtBQUNBLE1BQU1JLFFBQVE7QUFBQTtBQUFBLENBQUF2QyxjQUFBLEdBQUFtQixDQUFBLE9BQUcsSUFBSWUsV0FBQSxDQUFBTSxRQUFRLENBQUM7RUFBRUMsTUFBTTtFQUFFO0VBQUEsQ0FBQXpDLGNBQUEsR0FBQXFCLENBQUEsVUFBQXFCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDQyxVQUFVO0VBQUE7RUFBQSxDQUFBNUMsY0FBQSxHQUFBcUIsQ0FBQSxVQUFJLGdCQUFnQjtBQUFBLENBQUUsQ0FBQztBQUVyRjtBQUNBLE1BQU13QixhQUFhO0FBQUE7QUFBQSxDQUFBN0MsY0FBQSxHQUFBbUIsQ0FBQTtBQUFHO0FBQUEsQ0FBQW5CLGNBQUEsR0FBQXFCLENBQUEsVUFBQXFCLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDRyxrQkFBa0I7QUFBQTtBQUFBLENBQUE5QyxjQUFBLEdBQUFxQixDQUFBLFVBQUksZUFBZTtBQUV2RTs7Ozs7Ozs7QUFRTyxlQUFlWSxpQkFBaUJBLENBQ3JDYyxNQUFjLEVBQ2RDLFNBQUE7QUFBQTtBQUFBLENBQUFoRCxjQUFBLEdBQUFxQixDQUFBLFVBQW9CLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBQztBQUFBLEU7Ozs7RUFFckMsSUFBSTtJQUFBO0lBQUFyQixjQUFBLEdBQUFtQixDQUFBO0lBQ0ZrQixRQUFBLENBQUFZLE1BQU0sQ0FBQ0MsSUFBSSxDQUFDLHVCQUF1QixFQUFFO01BQ25DSCxNQUFNO01BQ05JLFVBQVUsRUFBRUg7S0FDYixDQUFDO0lBRUY7SUFDQSxNQUFNSSxPQUFPO0lBQUE7SUFBQSxDQUFBcEQsY0FBQSxHQUFBbUIsQ0FBQSxRQUFHLElBQUllLFdBQUEsQ0FBQW1CLGdCQUFnQixDQUFDO01BQ25DQyxNQUFNLEVBQUVULGFBQWE7TUFDckJVLEdBQUcsRUFBRVI7S0FDTixDQUFDO0lBRUY7SUFDQSxNQUFNUyxTQUFTO0lBQUE7SUFBQSxDQUFBeEQsY0FBQSxHQUFBbUIsQ0FBQSxRQUFHLE1BQU0sSUFBQWlCLHNCQUFBLENBQUFxQixZQUFZLEVBQUNsQixRQUFRLEVBQUVhLE9BQU8sRUFBRTtNQUFFSjtJQUFTLENBQUUsQ0FBQztJQUFDO0lBQUFoRCxjQUFBLEdBQUFtQixDQUFBO0lBRXZFa0IsUUFBQSxDQUFBWSxNQUFNLENBQUNDLElBQUksQ0FBQyxtQ0FBbUMsRUFBRTtNQUMvQ0gsTUFBTTtNQUNOVyxVQUFVLEVBQUVGO0tBQ2IsQ0FBQztJQUFDO0lBQUF4RCxjQUFBLEdBQUFtQixDQUFBO0lBRUgsT0FBT3FDLFNBQVM7RUFDbEIsQ0FBQyxDQUFDLE9BQU9HLEtBQUssRUFBRTtJQUNkO0lBQ0EsTUFBTUMsUUFBUTtJQUFBO0lBQUEsQ0FBQTVELGNBQUEsR0FBQW1CLENBQUEsUUFBR3dDLEtBQVk7SUFDN0IsTUFBTUUsU0FBUztJQUFBO0lBQUEsQ0FBQTdELGNBQUEsR0FBQW1CLENBQUEsUUFBR3lDLFFBQVEsRUFBRS9DLElBQUk7SUFDaEMsTUFBTWlELFlBQVk7SUFBQTtJQUFBLENBQUE5RCxjQUFBLEdBQUFtQixDQUFBLFFBQUd5QyxRQUFRLEVBQUVHLE9BQU87SUFDdEMsTUFBTUMsVUFBVTtJQUFBO0lBQUEsQ0FBQWhFLGNBQUEsR0FBQW1CLENBQUEsUUFBR3lDLFFBQVEsRUFBRUssS0FBSztJQUFDO0lBQUFqRSxjQUFBLEdBQUFtQixDQUFBO0lBRW5Da0IsUUFBQSxDQUFBWSxNQUFNLENBQUNVLEtBQUssQ0FBQywrQkFBK0IsRUFBRTtNQUM1Q08sVUFBVSxFQUFFTCxTQUFTO01BQ3JCTSxhQUFhLEVBQUVMLFlBQVk7TUFDM0JNLE9BQU8sRUFBRTtRQUFFckIsTUFBTTtRQUFFSSxVQUFVLEVBQUVIO01BQVMsQ0FBRTtNQUMxQ3FCLFdBQVcsRUFBRUw7S0FDZCxDQUFDO0lBRUY7SUFBQTtJQUFBaEUsY0FBQSxHQUFBbUIsQ0FBQTtJQUNBLE1BQU0sSUFBSW1CLFFBQUEsQ0FBQWdDLGNBQWMsQ0FBQywrQkFBK0IsRUFBRTtNQUN4REMsS0FBSyxFQUFFWixLQUFLO01BQ1pTLE9BQU8sRUFBRTtRQUFFckIsTUFBTTtRQUFFSSxVQUFVLEVBQUVIO01BQVM7S0FDekMsQ0FBQztFQUNKO0FBQ0YiLCJpZ25vcmVMaXN0IjpbXX0=