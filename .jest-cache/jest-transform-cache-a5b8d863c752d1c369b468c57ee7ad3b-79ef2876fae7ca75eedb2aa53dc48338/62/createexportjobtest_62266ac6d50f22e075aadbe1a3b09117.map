{"file":"C:\\Users\\ti198\\investment_analysis_opopo\\src\\lambda\\export\\__tests__\\create-export-job.test.ts","mappings":"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","names":[],"sources":["C:\\Users\\ti198\\investment_analysis_opopo\\src\\lambda\\export\\__tests__\\create-export-job.test.ts"],"sourcesContent":["/**\r\n * Create Export Job Unit Tests\r\n *\r\n * Requirements: 要件14.1（ユニットテスト）\r\n */\r\n\r\n// モック設定（importより前に定義）\r\nconst mockSend = jest.fn();\r\nconst mockRetryWithBackoff = jest.fn();\r\nconst mockLoggerInfo = jest.fn();\r\nconst mockLoggerError = jest.fn();\r\n\r\njest.mock('@aws-sdk/client-dynamodb', () => {\r\n  const actualModule = jest.requireActual('@aws-sdk/client-dynamodb');\r\n  return {\r\n    ...actualModule,\r\n    DynamoDBClient: jest.fn().mockImplementation(() => ({\r\n      send: mockSend,\r\n    })),\r\n  };\r\n});\r\n\r\njest.mock('../../../utils/logger', () => ({\r\n  logger: {\r\n    info: mockLoggerInfo,\r\n    error: mockLoggerError,\r\n  },\r\n}));\r\n\r\njest.mock('../../../utils/retry', () => ({\r\n  retryWithBackoff: mockRetryWithBackoff,\r\n}));\r\n\r\nimport { createExportJob } from '../create-export-job';\r\nimport { ExportRequestBody } from '../types';\r\nimport { PutItemCommand } from '@aws-sdk/client-dynamodb';\r\n\r\ndescribe('createExportJob', () => {\r\n  const mockRequestBody: ExportRequestBody = {\r\n    format: 'json',\r\n    filter: {\r\n      company_code: '1234',\r\n      start_date: '2024-01-01',\r\n      end_date: '2024-01-31',\r\n      disclosure_type: '決算短信',\r\n    },\r\n  };\r\n\r\n  const mockRequestId = 'test-request-id-12345678';\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    mockSend.mockClear();\r\n    mockRetryWithBackoff.mockClear();\r\n    mockLoggerInfo.mockClear();\r\n    mockLoggerError.mockClear();\r\n\r\n    // デフォルトでretryWithBackoffは渡された関数を実行\r\n    mockRetryWithBackoff.mockImplementation(async (fn) => await fn());\r\n\r\n    // デフォルトでDynamoDB操作は成功\r\n    mockSend.mockResolvedValue({\r\n      $metadata: { httpStatusCode: 200 },\r\n    });\r\n\r\n    // 環境変数設定\r\n    process.env.EXPORT_STATUS_TABLE_NAME = 'test-export-status-table';\r\n    process.env.AWS_REGION = 'ap-northeast-1';\r\n\r\n    // Date.now()をモック（一貫したタイムスタンプ）\r\n    jest.spyOn(Date, 'now').mockReturnValue(1705305600000); // 2024-01-15 10:00:00 UTC\r\n    jest.spyOn(Date.prototype, 'toISOString').mockReturnValue('2024-01-15T10:00:00.000Z');\r\n    jest.spyOn(Math, 'random').mockReturnValue(0.123456); // 一貫したランダム値\r\n  });\r\n\r\n  afterEach(() => {\r\n    jest.restoreAllMocks();\r\n  });\r\n\r\n  describe('エクスポートジョブ作成成功', () => {\r\n    it('エクスポートジョブを正常に作成できる', async () => {\r\n      // Act\r\n      const result = await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      expect(result).toMatchObject({\r\n        export_id: expect.stringMatching(/^export_\\d+_[a-z0-9]+_[a-z0-9]+$/),\r\n        status: 'pending',\r\n        requested_at: '2024-01-15T10:00:00.000Z',\r\n        progress: 0,\r\n        format: 'json',\r\n        filter: JSON.stringify(mockRequestBody.filter),\r\n      });\r\n\r\n      expect(result.ttl).toBeGreaterThan(Date.now() / 1000);\r\n    });\r\n\r\n    it('DynamoDBにPutItemCommandを送信する', async () => {\r\n      // Act\r\n      await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      expect(mockSend).toHaveBeenCalledTimes(1);\r\n\r\n      const command = mockSend.mock.calls[0][0] as PutItemCommand;\r\n      expect(command).toBeInstanceOf(PutItemCommand);\r\n      expect(command.input.TableName).toBe('test-export-status-table');\r\n    });\r\n\r\n    it('ログに作成開始と完了を記録する', async () => {\r\n      // Act\r\n      await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      expect(mockLoggerInfo).toHaveBeenCalledWith(\r\n        'Creating export job',\r\n        expect.objectContaining({\r\n          export_id: expect.stringMatching(/^export_\\d+_[a-z0-9]+_[a-z0-9]+$/),\r\n          format: 'json',\r\n          filter: mockRequestBody.filter,\r\n        })\r\n      );\r\n\r\n      expect(mockLoggerInfo).toHaveBeenCalledWith(\r\n        'Export job created successfully',\r\n        expect.objectContaining({\r\n          export_id: expect.stringMatching(/^export_\\d+_[a-z0-9]+_[a-z0-9]+$/),\r\n          status: 'pending',\r\n        })\r\n      );\r\n    });\r\n  });\r\n\r\n  describe('エクスポートID生成', () => {\r\n    it('エクスポートIDが正しいフォーマットで生成される', async () => {\r\n      // Act\r\n      const result = await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      // フォーマット: export_タイムスタンプ_ランダム文字列_リクエストID先頭8文字\r\n      expect(result.export_id).toMatch(/^export_\\d+_[a-z0-9]+_[a-z0-9]{8}$/);\r\n    });\r\n\r\n    it('エクスポートIDにタイムスタンプが含まれる', async () => {\r\n      // Act\r\n      const result = await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      expect(result.export_id).toContain('1705305600000');\r\n    });\r\n\r\n    it('エクスポートIDにリクエストIDの先頭8文字が含まれる', async () => {\r\n      // Act\r\n      const result = await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      expect(result.export_id).toContain('test-req');\r\n    });\r\n\r\n    it('異なるリクエストIDで異なるエクスポートIDが生成される', async () => {\r\n      // Arrange\r\n      const requestId1 = 'request-id-1-12345678';\r\n      const requestId2 = 'request-id-2-87654321';\r\n\r\n      // Act\r\n      const result1 = await createExportJob(mockRequestBody, requestId1);\r\n      \r\n      // 2回目の呼び出しで異なるランダム値を返す\r\n      jest.spyOn(Math, 'random').mockReturnValue(0.987654);\r\n      const result2 = await createExportJob(mockRequestBody, requestId2);\r\n\r\n      // Assert\r\n      expect(result1.export_id).not.toBe(result2.export_id);\r\n    });\r\n  });\r\n\r\n  describe('DynamoDB保存', () => {\r\n    it('ステータスがpendingで保存される', async () => {\r\n      // Act\r\n      await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      const command = mockSend.mock.calls[0][0] as PutItemCommand;\r\n      expect(command.input.Item?.status).toEqual({ S: 'pending' });\r\n    });\r\n\r\n    it('進捗率が0で保存される', async () => {\r\n      // Act\r\n      await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      const command = mockSend.mock.calls[0][0] as PutItemCommand;\r\n      expect(command.input.Item?.progress).toEqual({ N: '0' });\r\n    });\r\n\r\n    it('リクエスト日時がISO 8601形式で保存される', async () => {\r\n      // Act\r\n      await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      const command = mockSend.mock.calls[0][0] as PutItemCommand;\r\n      expect(command.input.Item?.requested_at).toEqual({ S: '2024-01-15T10:00:00.000Z' });\r\n    });\r\n\r\n    it('フォーマットが保存される', async () => {\r\n      // Act\r\n      await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      const command = mockSend.mock.calls[0][0] as PutItemCommand;\r\n      expect(command.input.Item?.format).toEqual({ S: 'json' });\r\n    });\r\n\r\n    it('フィルターがJSON文字列として保存される', async () => {\r\n      // Act\r\n      await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      const command = mockSend.mock.calls[0][0] as PutItemCommand;\r\n      expect(command.input.Item?.filter).toEqual({\r\n        S: JSON.stringify(mockRequestBody.filter),\r\n      });\r\n    });\r\n\r\n    it('CSV形式のリクエストも正しく保存される', async () => {\r\n      // Arrange\r\n      const csvRequestBody: ExportRequestBody = {\r\n        format: 'csv',\r\n        filter: {\r\n          start_date: '2024-01-01',\r\n          end_date: '2024-01-31',\r\n        },\r\n      };\r\n\r\n      // Act\r\n      await createExportJob(csvRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      const command = mockSend.mock.calls[0][0] as PutItemCommand;\r\n      expect(command.input.Item?.format).toEqual({ S: 'csv' });\r\n    });\r\n  });\r\n\r\n  describe('TTL設定', () => {\r\n    it('TTLが30日後に設定される', async () => {\r\n      // Arrange\r\n      const now = Date.now() / 1000; // Unix timestamp (秒)\r\n      const expectedTtl = now + 30 * 24 * 60 * 60; // 30日後\r\n\r\n      // Act\r\n      const result = await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      expect(result.ttl).toBeCloseTo(expectedTtl, 0);\r\n    });\r\n\r\n    it('TTLがDynamoDBに保存される', async () => {\r\n      // Act\r\n      await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      const command = mockSend.mock.calls[0][0] as PutItemCommand;\r\n      expect(command.input.Item?.ttl).toEqual({\r\n        N: expect.stringMatching(/^\\d+$/),\r\n      });\r\n\r\n      const ttlValue = parseInt(command.input.Item?.ttl?.N || '0', 10);\r\n      const now = Date.now() / 1000;\r\n      const expectedTtl = now + 30 * 24 * 60 * 60;\r\n      expect(ttlValue).toBeCloseTo(expectedTtl, 0);\r\n    });\r\n  });\r\n\r\n  describe('ConditionExpression（重複防止）', () => {\r\n    it('ConditionExpressionが設定される', async () => {\r\n      // Act\r\n      await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      const command = mockSend.mock.calls[0][0] as PutItemCommand;\r\n      expect(command.input.ConditionExpression).toBe('attribute_not_exists(export_id)');\r\n    });\r\n  });\r\n\r\n  describe('再試行設定', () => {\r\n    it('retryWithBackoffが呼び出される', async () => {\r\n      // Act\r\n      await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      expect(mockRetryWithBackoff).toHaveBeenCalledTimes(1);\r\n      expect(mockRetryWithBackoff).toHaveBeenCalledWith(\r\n        expect.any(Function),\r\n        expect.objectContaining({\r\n          maxRetries: 3,\r\n          initialDelay: 1000,\r\n          backoffMultiplier: 2,\r\n          jitter: true,\r\n          shouldRetry: expect.any(Function),\r\n        })\r\n      );\r\n    });\r\n\r\n    it('ProvisionedThroughputExceededExceptionで再試行する', async () => {\r\n      // Arrange\r\n      const error = new Error('Provisioned throughput exceeded');\r\n      error.name = 'ProvisionedThroughputExceededException';\r\n\r\n      // retryWithBackoffの設定を取得\r\n      mockRetryWithBackoff.mockImplementation(async (fn, options) => {\r\n        // shouldRetry関数をテスト\r\n        const shouldRetry = options.shouldRetry;\r\n        expect(shouldRetry(error)).toBe(true);\r\n        return await fn();\r\n      });\r\n\r\n      // Act\r\n      await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      expect(mockRetryWithBackoff).toHaveBeenCalled();\r\n    });\r\n\r\n    it('その他のエラーでは再試行しない', async () => {\r\n      // Arrange\r\n      const error = new Error('Validation error');\r\n      error.name = 'ValidationException';\r\n\r\n      // retryWithBackoffの設定を取得\r\n      mockRetryWithBackoff.mockImplementation(async (fn, options) => {\r\n        // shouldRetry関数をテスト\r\n        const shouldRetry = options.shouldRetry;\r\n        expect(shouldRetry(error)).toBe(false);\r\n        return await fn();\r\n      });\r\n\r\n      // Act\r\n      await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      expect(mockRetryWithBackoff).toHaveBeenCalled();\r\n    });\r\n  });\r\n\r\n  describe('エラーハンドリング', () => {\r\n    it('DynamoDBエラーが発生した場合、エラーを伝播する', async () => {\r\n      // Arrange\r\n      const dynamoError = new Error('DynamoDB error');\r\n      dynamoError.name = 'InternalServerError';\r\n      mockRetryWithBackoff.mockRejectedValue(dynamoError);\r\n\r\n      // Act & Assert\r\n      await expect(createExportJob(mockRequestBody, mockRequestId)).rejects.toThrow(\r\n        'DynamoDB error'\r\n      );\r\n    });\r\n\r\n    it('ProvisionedThroughputExceededExceptionが発生した場合、再試行後にエラーを伝播する', async () => {\r\n      // Arrange\r\n      const throughputError = new Error('Provisioned throughput exceeded');\r\n      throughputError.name = 'ProvisionedThroughputExceededException';\r\n      mockRetryWithBackoff.mockRejectedValue(throughputError);\r\n\r\n      // Act & Assert\r\n      await expect(createExportJob(mockRequestBody, mockRequestId)).rejects.toThrow(\r\n        'Provisioned throughput exceeded'\r\n      );\r\n    });\r\n\r\n    it('ConditionalCheckFailedExceptionが発生した場合、エラーを伝播する', async () => {\r\n      // Arrange\r\n      const conditionalError = new Error('Conditional check failed');\r\n      conditionalError.name = 'ConditionalCheckFailedException';\r\n      mockRetryWithBackoff.mockRejectedValue(conditionalError);\r\n\r\n      // Act & Assert\r\n      await expect(createExportJob(mockRequestBody, mockRequestId)).rejects.toThrow(\r\n        'Conditional check failed'\r\n      );\r\n    });\r\n  });\r\n\r\n  describe('環境変数', () => {\r\n    it('EXPORT_STATUS_TABLE_NAMEが使用される', async () => {\r\n      // Arrange\r\n      process.env.EXPORT_STATUS_TABLE_NAME = 'custom-export-table';\r\n\r\n      // Act\r\n      await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      const command = mockSend.mock.calls[0][0] as PutItemCommand;\r\n      expect(command.input.TableName).toBe('custom-export-table');\r\n    });\r\n\r\n    it('EXPORT_STATUS_TABLE_NAMEが未設定の場合、デフォルト値を使用する', async () => {\r\n      // Arrange\r\n      delete process.env.EXPORT_STATUS_TABLE_NAME;\r\n\r\n      // Act\r\n      await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert\r\n      const command = mockSend.mock.calls[0][0] as PutItemCommand;\r\n      expect(command.input.TableName).toBe('tdnet-export-status');\r\n    });\r\n\r\n    it('AWS_REGIONが使用される', async () => {\r\n      // Arrange\r\n      process.env.AWS_REGION = 'us-east-1';\r\n\r\n      // Act\r\n      await createExportJob(mockRequestBody, mockRequestId);\r\n\r\n      // Assert - DynamoDBClientが正しいリージョンで初期化されることを確認\r\n      // （実際のテストではモックされているため、環境変数が設定されていることを確認）\r\n      expect(process.env.AWS_REGION).toBe('us-east-1');\r\n    });\r\n  });\r\n\r\n  describe('フィルター条件のバリエーション', () => {\r\n    it('企業コードのみのフィルターで作成できる', async () => {\r\n      // Arrange\r\n      const requestBody: ExportRequestBody = {\r\n        format: 'json',\r\n        filter: {\r\n          company_code: '1234',\r\n        },\r\n      };\r\n\r\n      // Act\r\n      const result = await createExportJob(requestBody, mockRequestId);\r\n\r\n      // Assert\r\n      expect(result.filter).toBe(JSON.stringify({ company_code: '1234' }));\r\n    });\r\n\r\n    it('日付範囲のみのフィルターで作成できる', async () => {\r\n      // Arrange\r\n      const requestBody: ExportRequestBody = {\r\n        format: 'json',\r\n        filter: {\r\n          start_date: '2024-01-01',\r\n          end_date: '2024-01-31',\r\n        },\r\n      };\r\n\r\n      // Act\r\n      const result = await createExportJob(requestBody, mockRequestId);\r\n\r\n      // Assert\r\n      expect(result.filter).toBe(\r\n        JSON.stringify({\r\n          start_date: '2024-01-01',\r\n          end_date: '2024-01-31',\r\n        })\r\n      );\r\n    });\r\n\r\n    it('開示種類のみのフィルターで作成できる', async () => {\r\n      // Arrange\r\n      const requestBody: ExportRequestBody = {\r\n        format: 'json',\r\n        filter: {\r\n          disclosure_type: '決算短信',\r\n        },\r\n      };\r\n\r\n      // Act\r\n      const result = await createExportJob(requestBody, mockRequestId);\r\n\r\n      // Assert\r\n      expect(result.filter).toBe(JSON.stringify({ disclosure_type: '決算短信' }));\r\n    });\r\n\r\n    it('空のフィルターで作成できる', async () => {\r\n      // Arrange\r\n      const requestBody: ExportRequestBody = {\r\n        format: 'json',\r\n        filter: {},\r\n      };\r\n\r\n      // Act\r\n      const result = await createExportJob(requestBody, mockRequestId);\r\n\r\n      // Assert\r\n      expect(result.filter).toBe(JSON.stringify({}));\r\n    });\r\n  });\r\n});\r\n"],"version":3}