{"version":3,"names":["cdk","cov_19qmzbtoe3","s","__importStar","require","dynamodb","s3","lambda","apigateway","wafv2","secretsmanager","environment_config_1","cloudwatch_alarms_1","cloudwatch_dashboard_1","cloudfront_1","TdnetDataCollectorStack","Stack","disclosuresTable","executionsTable","exportStatusTable","pdfsBucket","exportsBucket","dashboardBucket","cloudtrailLogsBucket","api","apiKey","webAcl","deploymentEnvironment","constructor","scope","id","props","f","b","environmentConfig","environment","envConfig","getEnvironmentConfig","getResourceName","baseName","getBucketName","Aws","ACCOUNT_ID","Table","tableName","partitionKey","name","type","AttributeType","STRING","billingMode","BillingMode","PAY_PER_REQUEST","encryption","TableEncryption","AWS_MANAGED","pointInTimeRecovery","removalPolicy","RemovalPolicy","RETAIN","addGlobalSecondaryIndex","indexName","sortKey","projectionType","ProjectionType","ALL","timeToLiveAttribute","CfnOutput","value","description","exportName","Bucket","bucketName","BucketEncryption","S3_MANAGED","blockPublicAccess","BlockPublicAccess","BLOCK_ALL","versioned","autoDeleteObjects","lifecycleRules","enabled","transitions","storageClass","StorageClass","INFREQUENT_ACCESS","transitionAfter","Duration","days","GLACIER","expiration","account","dashboardCloudFront","DashboardCloudFront","apiKeyValue","Secret","fromSecretNameV2","collectorFunction","Function","functionName","runtime","Runtime","NODEJS_20_X","handler","code","Code","fromAsset","timeout","seconds","collector","memorySize","DYNAMODB_TABLE","DYNAMODB_EXECUTIONS_TABLE","S3_BUCKET","LOG_LEVEL","logLevel","ENVIRONMENT","NODE_OPTIONS","reservedConcurrentExecutions","grantReadWriteData","grantPut","grantRead","addToRolePolicy","aws_iam","PolicyStatement","effect","Effect","ALLOW","actions","resources","functionArn","queryFunction","query","DYNAMODB_TABLE_NAME","S3_BUCKET_NAME","API_KEY_SECRET_ARN","secretArn","grantReadData","exportFunction","export","EXPORT_STATUS_TABLE_NAME","EXPORT_BUCKET_NAME","RestApi","restApiName","deployOptions","stageName","throttlingRateLimit","throttlingBurstLimit","loggingLevel","MethodLoggingLevel","INFO","dataTraceEnabled","metricsEnabled","defaultCorsPreflightOptions","allowOrigins","Cors","ALL_ORIGINS","allowMethods","ALL_METHODS","allowHeaders","allowCredentials","cloudWatchRole","ApiKey","apiKeyName","secretValue","unsafeUnwrap","usagePlan","addUsagePlan","throttle","rateLimit","burstLimit","quota","limit","period","Period","MONTH","addApiKey","addApiStage","stage","deploymentStage","CfnWebACL","defaultAction","allow","visibilityConfig","sampledRequestsEnabled","cloudWatchMetricsEnabled","metricName","rules","priority","statement","rateBasedStatement","aggregateKeyType","action","block","customResponse","responseCode","customResponseBodyKey","managedRuleGroupStatement","vendorName","overrideAction","none","customResponseBodies","RateLimitExceeded","contentType","content","JSON","stringify","error_code","message","CfnWebACLAssociation","resourceArn","stageArn","webAclArn","attrArn","url","keyId","disclosuresResource","root","addResource","disclosuresIntegration","LambdaIntegration","proxy","integrationResponses","statusCode","responseParameters","addMethod","apiKeyRequired","requestParameters","methodResponses","exportsResource","exportsIntegration","collectFunction","collect","COLLECTOR_FUNCTION_NAME","grantInvoke","collectStatusFunction","collectStatus","collectResource","collectIntegration","collectStatusResource","collectStatusIntegration","exportStatusFunction","exportStatus","pdfDownloadFunction","pdfDownload","exportIdResource","exportStatusIntegration","disclosureIdResource","pdfResource","pdfDownloadIntegration","allLambdaFunctions","cloudwatchAlarms","CloudWatchAlarms","lambdaFunctions","errorRateThreshold","durationThreshold","collectionSuccessRateThreshold","alarms","length","toString","dashboard","CloudWatchDashboard","dynamodbTables","disclosures","executions","s3Buckets","pdfs","exports","apiGateway","dashboardName"],"sources":["C:\\Users\\ti198\\investment_analysis_opopo\\cdk\\lib\\tdnet-data-collector-stack.ts"],"sourcesContent":["import * as cdk from 'aws-cdk-lib';\r\nimport * as dynamodb from 'aws-cdk-lib/aws-dynamodb';\r\nimport * as s3 from 'aws-cdk-lib/aws-s3';\r\nimport * as lambda from 'aws-cdk-lib/aws-lambda';\r\nimport * as apigateway from 'aws-cdk-lib/aws-apigateway';\r\nimport * as wafv2 from 'aws-cdk-lib/aws-wafv2';\r\nimport * as secretsmanager from 'aws-cdk-lib/aws-secretsmanager';\r\nimport { Construct } from 'constructs';\r\nimport { Environment, getEnvironmentConfig } from './config/environment-config';\r\nimport { CloudWatchAlarms } from './constructs/cloudwatch-alarms';\r\nimport { CloudWatchDashboard } from './constructs/cloudwatch-dashboard';\r\nimport { DashboardCloudFront } from './constructs/cloudfront';\r\n\r\n/**\r\n * Stack properties with environment configuration\r\n */\r\nexport interface TdnetDataCollectorStackProps extends cdk.StackProps {\r\n  /**\r\n   * Environment configuration (optional, defaults to 'dev')\r\n   */\r\n  environmentConfig?: {\r\n    environment: Environment;\r\n  };\r\n}\r\n\r\nexport class TdnetDataCollectorStack extends cdk.Stack {\r\n  // Public properties for cross-stack references\r\n  public readonly disclosuresTable: dynamodb.Table;\r\n  public readonly executionsTable: dynamodb.Table;\r\n  public readonly exportStatusTable: dynamodb.Table;\r\n  public readonly pdfsBucket: s3.Bucket;\r\n  public readonly exportsBucket: s3.Bucket;\r\n  public readonly dashboardBucket: s3.Bucket;\r\n  public readonly cloudtrailLogsBucket: s3.Bucket;\r\n  public readonly api: apigateway.RestApi;\r\n  public readonly apiKey: apigateway.ApiKey;\r\n  public readonly webAcl: wafv2.CfnWebACL;\r\n\r\n  // Environment configuration (renamed to avoid conflict with base class)\r\n  private readonly deploymentEnvironment: Environment;\r\n\r\n  constructor(scope: Construct, id: string, props?: TdnetDataCollectorStackProps) {\r\n    super(scope, id, props);\r\n\r\n    // Extract environment configuration (default to 'dev')\r\n    this.deploymentEnvironment = props?.environmentConfig?.environment ?? 'dev';\r\n\r\n    // Get environment-specific Lambda configurations\r\n    const envConfig = getEnvironmentConfig(this.deploymentEnvironment);\r\n\r\n    // Helper function to generate environment-specific resource names\r\n    const getResourceName = (baseName: string): string => {\r\n      return `${baseName}_${this.deploymentEnvironment}`;\r\n    };\r\n\r\n    // Helper function to generate environment-specific bucket names\r\n    const getBucketName = (baseName: string): string => {\r\n      return `${baseName}-${this.deploymentEnvironment}-${cdk.Aws.ACCOUNT_ID}`;\r\n    };\r\n\r\n    // ========================================\r\n    // Phase 1: DynamoDB Tables\r\n    // ========================================\r\n\r\n    // 1. tdnet_disclosures - 開示情報メタデータテーブル\r\n    this.disclosuresTable = new dynamodb.Table(this, 'DisclosuresTable', {\r\n      tableName: getResourceName('tdnet_disclosures'),\r\n      partitionKey: {\r\n        name: 'disclosure_id',\r\n        type: dynamodb.AttributeType.STRING,\r\n      },\r\n      billingMode: dynamodb.BillingMode.PAY_PER_REQUEST, // オンデマンドモード\r\n      encryption: dynamodb.TableEncryption.AWS_MANAGED, // AWS管理キーで暗号化\r\n      pointInTimeRecovery: true, // ポイントインタイムリカバリ有効化\r\n      removalPolicy: cdk.RemovalPolicy.RETAIN, // 本番環境では削除保護\r\n    });\r\n\r\n    // GSI: CompanyCode_DiscloseDate - 企業コードと開示日時でクエリ\r\n    this.disclosuresTable.addGlobalSecondaryIndex({\r\n      indexName: 'GSI_CompanyCode_DiscloseDate',\r\n      partitionKey: {\r\n        name: 'company_code',\r\n        type: dynamodb.AttributeType.STRING,\r\n      },\r\n      sortKey: {\r\n        name: 'disclosed_at',\r\n        type: dynamodb.AttributeType.STRING,\r\n      },\r\n      projectionType: dynamodb.ProjectionType.ALL, // すべての属性を投影\r\n    });\r\n\r\n    // GSI: DatePartition - 月単位の効率的なクエリ（YYYY-MM形式）\r\n    this.disclosuresTable.addGlobalSecondaryIndex({\r\n      indexName: 'GSI_DatePartition',\r\n      partitionKey: {\r\n        name: 'date_partition',\r\n        type: dynamodb.AttributeType.STRING,\r\n      },\r\n      sortKey: {\r\n        name: 'disclosed_at',\r\n        type: dynamodb.AttributeType.STRING,\r\n      },\r\n      projectionType: dynamodb.ProjectionType.ALL,\r\n    });\r\n\r\n    // 2. tdnet_executions - 実行状態管理テーブル\r\n    this.executionsTable = new dynamodb.Table(this, 'ExecutionsTable', {\r\n      tableName: getResourceName('tdnet_executions'),\r\n      partitionKey: {\r\n        name: 'execution_id',\r\n        type: dynamodb.AttributeType.STRING,\r\n      },\r\n      billingMode: dynamodb.BillingMode.PAY_PER_REQUEST, // オンデマンドモード\r\n      encryption: dynamodb.TableEncryption.AWS_MANAGED, // AWS管理キーで暗号化\r\n      timeToLiveAttribute: 'ttl', // TTL有効化（30日後に自動削除）\r\n      pointInTimeRecovery: true, // ポイントインタイムリカバリ有効化\r\n      removalPolicy: cdk.RemovalPolicy.RETAIN, // 本番環境では削除保護\r\n    });\r\n\r\n    // GSI: Status_StartedAt - 実行状態と開始日時でクエリ\r\n    this.executionsTable.addGlobalSecondaryIndex({\r\n      indexName: 'GSI_Status_StartedAt',\r\n      partitionKey: {\r\n        name: 'status',\r\n        type: dynamodb.AttributeType.STRING,\r\n      },\r\n      sortKey: {\r\n        name: 'started_at',\r\n        type: dynamodb.AttributeType.STRING,\r\n      },\r\n      projectionType: dynamodb.ProjectionType.ALL,\r\n    });\r\n\r\n    // 3. tdnet_export_status - エクスポート状態管理テーブル\r\n    this.exportStatusTable = new dynamodb.Table(this, 'ExportStatusTable', {\r\n      tableName: getResourceName('tdnet_export_status'),\r\n      partitionKey: {\r\n        name: 'export_id',\r\n        type: dynamodb.AttributeType.STRING,\r\n      },\r\n      billingMode: dynamodb.BillingMode.PAY_PER_REQUEST, // オンデマンドモード\r\n      encryption: dynamodb.TableEncryption.AWS_MANAGED, // AWS管理キーで暗号化\r\n      timeToLiveAttribute: 'ttl', // TTL有効化（30日後に自動削除）\r\n      pointInTimeRecovery: true, // ポイントインタイムリカバリ有効化\r\n      removalPolicy: cdk.RemovalPolicy.RETAIN, // 本番環境では削除保護\r\n    });\r\n\r\n    // GSI: Status_RequestedAt - エクスポート状態とリクエスト日時でクエリ\r\n    this.exportStatusTable.addGlobalSecondaryIndex({\r\n      indexName: 'GSI_Status_RequestedAt',\r\n      partitionKey: {\r\n        name: 'status',\r\n        type: dynamodb.AttributeType.STRING,\r\n      },\r\n      sortKey: {\r\n        name: 'requested_at',\r\n        type: dynamodb.AttributeType.STRING,\r\n      },\r\n      projectionType: dynamodb.ProjectionType.ALL,\r\n    });\r\n\r\n    // CloudFormation Outputs\r\n    new cdk.CfnOutput(this, 'DisclosuresTableName', {\r\n      value: this.disclosuresTable.tableName,\r\n      description: 'DynamoDB table name for disclosures',\r\n      exportName: 'TdnetDisclosuresTableName',\r\n    });\r\n\r\n    new cdk.CfnOutput(this, 'ExecutionsTableName', {\r\n      value: this.executionsTable.tableName,\r\n      description: 'DynamoDB table name for executions',\r\n      exportName: 'TdnetExecutionsTableName',\r\n    });\r\n\r\n    new cdk.CfnOutput(this, 'ExportStatusTableName', {\r\n      value: this.exportStatusTable.tableName,\r\n      description: 'DynamoDB table name for export status',\r\n      exportName: 'TdnetExportStatusTableName',\r\n    });\r\n\r\n    // ========================================\r\n    // Phase 1: S3 Buckets\r\n    // ========================================\r\n\r\n    // 1. PDFバケット - TDnetからダウンロードしたPDFファイルの長期保存\r\n    this.pdfsBucket = new s3.Bucket(this, 'PdfsBucket', {\r\n      bucketName: getBucketName('tdnet-data-collector-pdfs'),\r\n      encryption: s3.BucketEncryption.S3_MANAGED, // S3マネージドキーで暗号化\r\n      blockPublicAccess: s3.BlockPublicAccess.BLOCK_ALL, // パブリックアクセスブロック\r\n      versioned: true, // バージョニング有効化\r\n      removalPolicy: cdk.RemovalPolicy.RETAIN, // 本番環境では削除保護\r\n      autoDeleteObjects: false, // 自動削除無効\r\n      lifecycleRules: [\r\n        {\r\n          id: 'TransitionToStandardIA',\r\n          enabled: true,\r\n          transitions: [\r\n            {\r\n              storageClass: s3.StorageClass.INFREQUENT_ACCESS,\r\n              transitionAfter: cdk.Duration.days(90), // 90日後にStandard-IAに移行\r\n            },\r\n            {\r\n              storageClass: s3.StorageClass.GLACIER,\r\n              transitionAfter: cdk.Duration.days(365), // 365日後にGlacierに移行\r\n            },\r\n          ],\r\n        },\r\n      ],\r\n    });\r\n\r\n    // 2. エクスポートバケット - ユーザーがエクスポートしたCSV/JSONファイルの一時保存\r\n    this.exportsBucket = new s3.Bucket(this, 'ExportsBucket', {\r\n      bucketName: getBucketName('tdnet-data-collector-exports'),\r\n      encryption: s3.BucketEncryption.S3_MANAGED,\r\n      blockPublicAccess: s3.BlockPublicAccess.BLOCK_ALL,\r\n      versioned: true,\r\n      removalPolicy: cdk.RemovalPolicy.RETAIN,\r\n      autoDeleteObjects: false,\r\n      lifecycleRules: [\r\n        {\r\n          id: 'DeleteAfter7Days',\r\n          enabled: true,\r\n          expiration: cdk.Duration.days(7), // 7日後に自動削除\r\n        },\r\n      ],\r\n    });\r\n\r\n    // 3. ダッシュボードバケット - Webダッシュボードの静的ファイルホスティング\r\n    this.dashboardBucket = new s3.Bucket(this, 'DashboardBucket', {\r\n      bucketName: getBucketName('tdnet-dashboard'),\r\n      encryption: s3.BucketEncryption.S3_MANAGED,\r\n      blockPublicAccess: s3.BlockPublicAccess.BLOCK_ALL, // CloudFront OAI経由でのみアクセス\r\n      versioned: true,\r\n      removalPolicy: cdk.RemovalPolicy.RETAIN,\r\n      autoDeleteObjects: false,\r\n      // ライフサイクルポリシーなし（静的ファイルは永続保存）\r\n    });\r\n\r\n    // 4. CloudTrailログバケット - 監査ログの長期保存\r\n    this.cloudtrailLogsBucket = new s3.Bucket(this, 'CloudTrailLogsBucket', {\r\n      bucketName: `tdnet-cloudtrail-logs-${this.account}`,\r\n      encryption: s3.BucketEncryption.S3_MANAGED,\r\n      blockPublicAccess: s3.BlockPublicAccess.BLOCK_ALL,\r\n      versioned: true,\r\n      removalPolicy: cdk.RemovalPolicy.RETAIN,\r\n      autoDeleteObjects: false,\r\n      lifecycleRules: [\r\n        {\r\n          id: 'ArchiveAndDelete',\r\n          enabled: true,\r\n          transitions: [\r\n            {\r\n              storageClass: s3.StorageClass.GLACIER,\r\n              transitionAfter: cdk.Duration.days(90), // 90日後にGlacierに移行\r\n            },\r\n          ],\r\n          expiration: cdk.Duration.days(2555), // 7年後に自動削除（コンプライアンス要件）\r\n        },\r\n      ],\r\n    });\r\n\r\n    // CloudFormation Outputs\r\n    new cdk.CfnOutput(this, 'PdfsBucketName', {\r\n      value: this.pdfsBucket.bucketName,\r\n      description: 'S3 bucket name for PDF files',\r\n      exportName: 'TdnetPdfsBucketName',\r\n    });\r\n\r\n    new cdk.CfnOutput(this, 'ExportsBucketName', {\r\n      value: this.exportsBucket.bucketName,\r\n      description: 'S3 bucket name for export files',\r\n      exportName: 'TdnetExportsBucketName',\r\n    });\r\n\r\n    new cdk.CfnOutput(this, 'DashboardBucketName', {\r\n      value: this.dashboardBucket.bucketName,\r\n      description: 'S3 bucket name for dashboard',\r\n      exportName: 'TdnetDashboardBucketName',\r\n    });\r\n\r\n    new cdk.CfnOutput(this, 'CloudTrailLogsBucketName', {\r\n      value: this.cloudtrailLogsBucket.bucketName,\r\n      description: 'S3 bucket name for CloudTrail logs',\r\n      exportName: 'TdnetCloudTrailLogsBucketName',\r\n    });\r\n\r\n    // ========================================\r\n    // Phase 1.5: CloudFront Distribution\r\n    // ========================================\r\n\r\n    // CloudFront Distribution for Dashboard\r\n    const dashboardCloudFront = new DashboardCloudFront(this, 'DashboardCloudFront', {\r\n      dashboardBucket: this.dashboardBucket,\r\n      environment: this.deploymentEnvironment,\r\n    });\r\n\r\n    // ========================================\r\n    // Phase 2: Secrets Manager（Lambda関数より前に初期化）\r\n    // ========================================\r\n\r\n    // IMPORTANT: apiKeyValueはLambda関数の環境変数で使用されるため、\r\n    // Lambda関数定義より前に初期化する必要があります\r\n    const apiKeyValue = secretsmanager.Secret.fromSecretNameV2(\r\n      this,\r\n      'ApiKeySecret',\r\n      '/tdnet/api-key'\r\n    );\r\n\r\n    // ========================================\r\n    // Phase 1: Lambda Functions\r\n    // ========================================\r\n\r\n    // Lambda Collector Function\r\n    const collectorFunction = new lambda.Function(this, 'CollectorFunction', {\r\n      functionName: `tdnet-collector-${this.deploymentEnvironment}`,\r\n      runtime: lambda.Runtime.NODEJS_20_X,\r\n      handler: 'index.handler',\r\n      code: lambda.Code.fromAsset('dist/src/lambda/collector'),\r\n      timeout: cdk.Duration.seconds(envConfig.collector.timeout),\r\n      memorySize: envConfig.collector.memorySize,\r\n      environment: {\r\n        DYNAMODB_TABLE: this.disclosuresTable.tableName,\r\n        DYNAMODB_EXECUTIONS_TABLE: this.executionsTable.tableName,\r\n        S3_BUCKET: this.pdfsBucket.bucketName,\r\n        LOG_LEVEL: envConfig.collector.logLevel,\r\n        ENVIRONMENT: this.deploymentEnvironment,\r\n        NODE_OPTIONS: '--enable-source-maps',\r\n      },\r\n      reservedConcurrentExecutions: 1, // 同時実行数を1に制限（レート制限のため）\r\n    });\r\n\r\n    // IAM権限の付与\r\n    // DynamoDB: 両テーブルへの読み書き権限\r\n    this.disclosuresTable.grantReadWriteData(collectorFunction);\r\n    this.executionsTable.grantReadWriteData(collectorFunction);\r\n\r\n    // S3: PDFバケットへの書き込み権限\r\n    this.pdfsBucket.grantPut(collectorFunction);\r\n    this.pdfsBucket.grantRead(collectorFunction);\r\n\r\n    // CloudWatch Metrics: カスタムメトリクス送信権限\r\n    collectorFunction.addToRolePolicy(\r\n      new cdk.aws_iam.PolicyStatement({\r\n        effect: cdk.aws_iam.Effect.ALLOW,\r\n        actions: ['cloudwatch:PutMetricData'],\r\n        resources: ['*'],\r\n      })\r\n    );\r\n\r\n    // CloudFormation Outputs\r\n    new cdk.CfnOutput(this, 'CollectorFunctionName', {\r\n      value: collectorFunction.functionName,\r\n      description: 'Lambda Collector function name',\r\n      exportName: 'TdnetCollectorFunctionName',\r\n    });\r\n\r\n    new cdk.CfnOutput(this, 'CollectorFunctionArn', {\r\n      value: collectorFunction.functionArn,\r\n      description: 'Lambda Collector function ARN',\r\n      exportName: 'TdnetCollectorFunctionArn',\r\n    });\r\n\r\n    // ========================================\r\n    // Phase 2: Lambda Query Function\r\n    // ========================================\r\n\r\n    // Lambda Query Function\r\n    const queryFunction = new lambda.Function(this, 'QueryFunction', {\r\n      functionName: `tdnet-query-${this.deploymentEnvironment}`,\r\n      runtime: lambda.Runtime.NODEJS_20_X,\r\n      handler: 'index.handler',\r\n      code: lambda.Code.fromAsset('dist/src/lambda/query'),\r\n      timeout: cdk.Duration.seconds(envConfig.query.timeout),\r\n      memorySize: envConfig.query.memorySize,\r\n      environment: {\r\n        DYNAMODB_TABLE_NAME: this.disclosuresTable.tableName,\r\n        S3_BUCKET_NAME: this.pdfsBucket.bucketName,\r\n        API_KEY_SECRET_ARN: apiKeyValue.secretArn, // ARNのみを環境変数に設定（セキュリティ修正）\r\n        LOG_LEVEL: envConfig.query.logLevel,\r\n        ENVIRONMENT: this.deploymentEnvironment,\r\n        NODE_OPTIONS: '--enable-source-maps',\r\n      },\r\n    });\r\n\r\n    // IAM権限の付与\r\n    // DynamoDB: disclosuresテーブルへの読み取り権限\r\n    this.disclosuresTable.grantReadData(queryFunction);\r\n\r\n    // S3: PDFバケットへの読み取り権限（署名付きURL生成用）\r\n    this.pdfsBucket.grantRead(queryFunction);\r\n\r\n    // Secrets Manager: APIキー読み取り権限\r\n    apiKeyValue.grantRead(queryFunction);\r\n\r\n    // CloudWatch Metrics: カスタムメトリクス送信権限\r\n    queryFunction.addToRolePolicy(\r\n      new cdk.aws_iam.PolicyStatement({\r\n        effect: cdk.aws_iam.Effect.ALLOW,\r\n        actions: ['cloudwatch:PutMetricData'],\r\n        resources: ['*'],\r\n      })\r\n    );\r\n\r\n    // CloudFormation Outputs\r\n    new cdk.CfnOutput(this, 'QueryFunctionName', {\r\n      value: queryFunction.functionName,\r\n      description: 'Lambda Query function name',\r\n      exportName: 'TdnetQueryFunctionName',\r\n    });\r\n\r\n    new cdk.CfnOutput(this, 'QueryFunctionArn', {\r\n      value: queryFunction.functionArn,\r\n      description: 'Lambda Query function ARN',\r\n      exportName: 'TdnetQueryFunctionArn',\r\n    });\r\n\r\n    // ========================================\r\n    // Phase 2: Lambda Export Function\r\n    // ========================================\r\n\r\n    // Lambda Export Function\r\n    const exportFunction = new lambda.Function(this, 'ExportFunction', {\r\n      functionName: `tdnet-export-${this.deploymentEnvironment}`,\r\n      runtime: lambda.Runtime.NODEJS_20_X,\r\n      handler: 'index.handler',\r\n      code: lambda.Code.fromAsset('dist/src/lambda/export'),\r\n      timeout: cdk.Duration.seconds(envConfig.export.timeout),\r\n      memorySize: envConfig.export.memorySize,\r\n      environment: {\r\n        DYNAMODB_TABLE_NAME: this.disclosuresTable.tableName,\r\n        EXPORT_STATUS_TABLE_NAME: this.exportStatusTable.tableName,\r\n        EXPORT_BUCKET_NAME: this.exportsBucket.bucketName,\r\n        API_KEY_SECRET_ARN: apiKeyValue.secretArn, // ARNのみを環境変数に設定（セキュリティ修正）\r\n        LOG_LEVEL: envConfig.export.logLevel,\r\n        ENVIRONMENT: this.deploymentEnvironment,\r\n        NODE_OPTIONS: '--enable-source-maps',\r\n        // AWS_REGION is automatically set by Lambda runtime\r\n      },\r\n    });\r\n\r\n    // IAM権限の付与\r\n    // DynamoDB: disclosuresテーブルへの読み取り権限\r\n    this.disclosuresTable.grantReadData(exportFunction);\r\n\r\n    // DynamoDB: exportStatusテーブルへの読み書き権限\r\n    this.exportStatusTable.grantReadWriteData(exportFunction);\r\n\r\n    // S3: exportsバケットへの書き込み権限\r\n    this.exportsBucket.grantPut(exportFunction);\r\n    this.exportsBucket.grantRead(exportFunction);\r\n\r\n    // Secrets Manager: APIキー読み取り権限\r\n    apiKeyValue.grantRead(exportFunction);\r\n\r\n    // CloudWatch Metrics: カスタムメトリクス送信権限\r\n    exportFunction.addToRolePolicy(\r\n      new cdk.aws_iam.PolicyStatement({\r\n        effect: cdk.aws_iam.Effect.ALLOW,\r\n        actions: ['cloudwatch:PutMetricData'],\r\n        resources: ['*'],\r\n      })\r\n    );\r\n\r\n    // CloudFormation Outputs\r\n    new cdk.CfnOutput(this, 'ExportFunctionName', {\r\n      value: exportFunction.functionName,\r\n      description: 'Lambda Export function name',\r\n      exportName: 'TdnetExportFunctionName',\r\n    });\r\n\r\n    new cdk.CfnOutput(this, 'ExportFunctionArn', {\r\n      value: exportFunction.functionArn,\r\n      description: 'Lambda Export function ARN',\r\n      exportName: 'TdnetExportFunctionArn',\r\n    });\r\n\r\n    // ========================================\r\n    // Phase 2: API Gateway + WAF\r\n    // ========================================\r\n\r\n    // 1. API Gateway REST API\r\n    this.api = new apigateway.RestApi(this, 'TdnetApi', {\r\n      restApiName: `tdnet-data-collector-api-${this.deploymentEnvironment}`,\r\n      description: 'TDnet Data Collector REST API',\r\n      deployOptions: {\r\n        stageName: 'prod',\r\n        throttlingRateLimit: 100, // リクエスト/秒\r\n        throttlingBurstLimit: 200, // バーストリクエスト数\r\n        loggingLevel: apigateway.MethodLoggingLevel.INFO,\r\n        dataTraceEnabled: true,\r\n        metricsEnabled: true,\r\n      },\r\n      defaultCorsPreflightOptions: {\r\n        allowOrigins: apigateway.Cors.ALL_ORIGINS, // 本番環境では特定のオリジンに制限\r\n        allowMethods: apigateway.Cors.ALL_METHODS,\r\n        allowHeaders: [\r\n          'Content-Type',\r\n          'X-Amz-Date',\r\n          'Authorization',\r\n          'X-Api-Key',\r\n          'X-Amz-Security-Token',\r\n        ],\r\n        allowCredentials: true,\r\n      },\r\n      cloudWatchRole: true, // CloudWatch Logsへのログ出力を有効化\r\n    });\r\n\r\n    // 2. API Key生成\r\n    // Note: apiKeyValueは既にファイル先頭で初期化済み\r\n    this.apiKey = new apigateway.ApiKey(this, 'TdnetApiKey', {\r\n      apiKeyName: `tdnet-api-key-${this.deploymentEnvironment}`,\r\n      description: 'API Key for TDnet Data Collector',\r\n      enabled: true,\r\n      value: apiKeyValue.secretValue.unsafeUnwrap(), // Secrets Managerから取得\r\n    });\r\n\r\n    // 3. Usage Plan設定\r\n    const usagePlan = this.api.addUsagePlan('TdnetUsagePlan', {\r\n      name: `tdnet-usage-plan-${this.deploymentEnvironment}`,\r\n      description: 'Usage plan for TDnet Data Collector API',\r\n      throttle: {\r\n        rateLimit: 100, // リクエスト/秒\r\n        burstLimit: 200, // バーストリクエスト数\r\n      },\r\n      quota: {\r\n        limit: 10000, // 月間リクエスト数上限\r\n        period: apigateway.Period.MONTH,\r\n      },\r\n    });\r\n\r\n    usagePlan.addApiKey(this.apiKey);\r\n    usagePlan.addApiStage({\r\n      stage: this.api.deploymentStage,\r\n    });\r\n\r\n    // 4. AWS WAF Web ACL設定\r\n    this.webAcl = new wafv2.CfnWebACL(this, 'TdnetWebAcl', {\r\n      name: `tdnet-web-acl-${this.deploymentEnvironment}`,\r\n      scope: 'REGIONAL', // API Gatewayは REGIONAL\r\n      defaultAction: { allow: {} },\r\n      description: 'Web ACL for TDnet Data Collector API',\r\n      visibilityConfig: {\r\n        sampledRequestsEnabled: true,\r\n        cloudWatchMetricsEnabled: true,\r\n        metricName: 'TdnetWebAcl',\r\n      },\r\n      rules: [\r\n        // ルール1: レート制限（2000リクエスト/5分）\r\n        {\r\n          name: 'RateLimitRule',\r\n          priority: 1,\r\n          statement: {\r\n            rateBasedStatement: {\r\n              limit: 2000, // 5分間のリクエスト数上限\r\n              aggregateKeyType: 'IP',\r\n            },\r\n          },\r\n          action: {\r\n            block: {\r\n              customResponse: {\r\n                responseCode: 429,\r\n                customResponseBodyKey: 'RateLimitExceeded',\r\n              },\r\n            },\r\n          },\r\n          visibilityConfig: {\r\n            sampledRequestsEnabled: true,\r\n            cloudWatchMetricsEnabled: true,\r\n            metricName: 'RateLimitRule',\r\n          },\r\n        },\r\n        // ルール2: AWSマネージドルール - Common Rule Set\r\n        {\r\n          name: 'AWSManagedRulesCommonRuleSet',\r\n          priority: 2,\r\n          statement: {\r\n            managedRuleGroupStatement: {\r\n              vendorName: 'AWS',\r\n              name: 'AWSManagedRulesCommonRuleSet',\r\n            },\r\n          },\r\n          overrideAction: { none: {} },\r\n          visibilityConfig: {\r\n            sampledRequestsEnabled: true,\r\n            cloudWatchMetricsEnabled: true,\r\n            metricName: 'AWSManagedRulesCommonRuleSet',\r\n          },\r\n        },\r\n        // ルール3: AWSマネージドルール - Known Bad Inputs\r\n        {\r\n          name: 'AWSManagedRulesKnownBadInputsRuleSet',\r\n          priority: 3,\r\n          statement: {\r\n            managedRuleGroupStatement: {\r\n              vendorName: 'AWS',\r\n              name: 'AWSManagedRulesKnownBadInputsRuleSet',\r\n            },\r\n          },\r\n          overrideAction: { none: {} },\r\n          visibilityConfig: {\r\n            sampledRequestsEnabled: true,\r\n            cloudWatchMetricsEnabled: true,\r\n            metricName: 'AWSManagedRulesKnownBadInputsRuleSet',\r\n          },\r\n        },\r\n      ],\r\n      customResponseBodies: {\r\n        RateLimitExceeded: {\r\n          contentType: 'APPLICATION_JSON',\r\n          content: JSON.stringify({\r\n            error_code: 'RATE_LIMIT_EXCEEDED',\r\n            message: 'Too many requests. Please try again later.',\r\n          }),\r\n        },\r\n      },\r\n    });\r\n\r\n    // 5. WAFとAPI Gatewayの関連付け\r\n    new wafv2.CfnWebACLAssociation(this, 'TdnetWebAclAssociation', {\r\n      resourceArn: this.api.deploymentStage.stageArn,\r\n      webAclArn: this.webAcl.attrArn,\r\n    });\r\n\r\n    // CloudFormation Outputs\r\n    new cdk.CfnOutput(this, 'ApiEndpoint', {\r\n      value: this.api.url,\r\n      description: 'API Gateway endpoint URL',\r\n      exportName: 'TdnetApiEndpoint',\r\n    });\r\n\r\n    new cdk.CfnOutput(this, 'ApiKeyId', {\r\n      value: this.apiKey.keyId,\r\n      description: 'API Key ID',\r\n      exportName: 'TdnetApiKeyId',\r\n    });\r\n\r\n    new cdk.CfnOutput(this, 'WebAclArn', {\r\n      value: this.webAcl.attrArn,\r\n      description: 'WAF Web ACL ARN',\r\n      exportName: 'TdnetWebAclArn',\r\n    });\r\n\r\n    // ========================================\r\n    // Phase 2: API Gateway Integrations\r\n    // ========================================\r\n\r\n    // 1. GET /disclosures エンドポイント\r\n    const disclosuresResource = this.api.root.addResource('disclosures');\r\n    const disclosuresIntegration = new apigateway.LambdaIntegration(queryFunction, {\r\n      proxy: true,\r\n      integrationResponses: [\r\n        {\r\n          statusCode: '200', // Success\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n            'method.response.header.Content-Type': \"'application/json'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '400', // Bad Request\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '401', // Unauthorized\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '500', // Internal Server Error\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    disclosuresResource.addMethod('GET', disclosuresIntegration, {\r\n      apiKeyRequired: true, // APIキー認証必須\r\n      requestParameters: {\r\n        'method.request.querystring.company_code': false,\r\n        'method.request.querystring.start_date': false,\r\n        'method.request.querystring.end_date': false,\r\n        'method.request.querystring.disclosure_type': false,\r\n        'method.request.querystring.format': false,\r\n        'method.request.querystring.limit': false,\r\n        'method.request.querystring.offset': false,\r\n      },\r\n      methodResponses: [\r\n        {\r\n          statusCode: '200',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n            'method.response.header.Content-Type': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '400',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '401',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '500',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    // 2. POST /exports エンドポイント\r\n    const exportsResource = this.api.root.addResource('exports');\r\n    const exportsIntegration = new apigateway.LambdaIntegration(exportFunction, {\r\n      proxy: true,\r\n      integrationResponses: [\r\n        {\r\n          statusCode: '202', // Accepted\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '400', // Bad Request\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '401', // Unauthorized\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '500', // Internal Server Error\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    exportsResource.addMethod('POST', exportsIntegration, {\r\n      apiKeyRequired: true, // APIキー認証必須\r\n      methodResponses: [\r\n        {\r\n          statusCode: '202',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '400',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '401',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '500',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    // ========================================\r\n    // Phase 2: Lambda Collect Functions\r\n    // ========================================\r\n\r\n    // Lambda Collect Function (POST /collect)\r\n    const collectFunction = new lambda.Function(this, 'CollectFunction', {\r\n      functionName: `tdnet-collector-${this.deploymentEnvironment}`,\r\n      runtime: lambda.Runtime.NODEJS_20_X,\r\n      handler: 'index.handler',\r\n      code: lambda.Code.fromAsset('dist/src/lambda/collect'),\r\n      timeout: cdk.Duration.seconds(envConfig.collect.timeout),\r\n      memorySize: envConfig.collect.memorySize,\r\n      environment: {\r\n        COLLECTOR_FUNCTION_NAME: collectorFunction.functionName,\r\n        API_KEY_SECRET_ARN: apiKeyValue.secretArn, // ARNのみを環境変数に設定（セキュリティ修正）\r\n        LOG_LEVEL: envConfig.collect.logLevel,\r\n        ENVIRONMENT: this.deploymentEnvironment,\r\n        NODE_OPTIONS: '--enable-source-maps',\r\n      },\r\n    });\r\n\r\n    // IAM権限の付与\r\n    // Lambda Collectorを呼び出す権限\r\n    collectorFunction.grantInvoke(collectFunction);\r\n\r\n    // Secrets Manager: APIキー読み取り権限\r\n    apiKeyValue.grantRead(collectFunction);\r\n\r\n    // CloudWatch Metrics: カスタムメトリクス送信権限\r\n    collectFunction.addToRolePolicy(\r\n      new cdk.aws_iam.PolicyStatement({\r\n        effect: cdk.aws_iam.Effect.ALLOW,\r\n        actions: ['cloudwatch:PutMetricData'],\r\n        resources: ['*'],\r\n      })\r\n    );\r\n\r\n    // Lambda Collect Status Function (GET /collect/{execution_id})\r\n    const collectStatusFunction = new lambda.Function(this, 'CollectStatusFunction', {\r\n      functionName: `tdnet-collect-status-${this.deploymentEnvironment}`,\r\n      runtime: lambda.Runtime.NODEJS_20_X,\r\n      handler: 'index.handler',\r\n      code: lambda.Code.fromAsset('dist/src/lambda/collect-status'),\r\n      timeout: cdk.Duration.seconds(envConfig.collectStatus.timeout),\r\n      memorySize: envConfig.collectStatus.memorySize,\r\n      environment: {\r\n        DYNAMODB_EXECUTIONS_TABLE: this.executionsTable.tableName,\r\n        S3_BUCKET: this.pdfsBucket.bucketName, // 追加: S3バケット名\r\n        LOG_LEVEL: envConfig.collectStatus.logLevel,\r\n        ENVIRONMENT: this.deploymentEnvironment,\r\n        NODE_OPTIONS: '--enable-source-maps',\r\n      },\r\n    });\r\n\r\n    // IAM権限の付与\r\n    // DynamoDB: executionsテーブルへの読み取り権限\r\n    this.executionsTable.grantReadData(collectStatusFunction);\r\n\r\n    // S3: PDFバケットへの読み取り権限（追加）\r\n    this.pdfsBucket.grantRead(collectStatusFunction);\r\n\r\n    // CloudWatch Metrics: カスタムメトリクス送信権限\r\n    collectStatusFunction.addToRolePolicy(\r\n      new cdk.aws_iam.PolicyStatement({\r\n        effect: cdk.aws_iam.Effect.ALLOW,\r\n        actions: ['cloudwatch:PutMetricData'],\r\n        resources: ['*'],\r\n      })\r\n    );\r\n\r\n    // ========================================\r\n    // Phase 2: /collect API Gateway Integrations\r\n    // ========================================\r\n\r\n    // 1. /collect エンドポイント\r\n    const collectResource = this.api.root.addResource('collect');\r\n\r\n    // POST /collect\r\n    const collectIntegration = new apigateway.LambdaIntegration(collectFunction, {\r\n      proxy: true,\r\n      integrationResponses: [\r\n        {\r\n          statusCode: '200', // Success\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '400', // Bad Request\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '401', // Unauthorized\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '500', // Internal Server Error\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    collectResource.addMethod('POST', collectIntegration, {\r\n      apiKeyRequired: true, // APIキー認証必須\r\n      methodResponses: [\r\n        {\r\n          statusCode: '200',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '400',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '401',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '500',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    // 2. /collect/{execution_id} エンドポイント\r\n    const collectStatusResource = collectResource.addResource('{execution_id}');\r\n\r\n    // GET /collect/{execution_id}\r\n    const collectStatusIntegration = new apigateway.LambdaIntegration(collectStatusFunction, {\r\n      proxy: true,\r\n      integrationResponses: [\r\n        {\r\n          statusCode: '200', // Success\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '401', // Unauthorized\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '404', // Not Found\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '500', // Internal Server Error\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    collectStatusResource.addMethod('GET', collectStatusIntegration, {\r\n      apiKeyRequired: true, // APIキー認証必須\r\n      methodResponses: [\r\n        {\r\n          statusCode: '200',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '401',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '404',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '500',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    // ========================================\r\n    // Phase 2: Export Status & PDF Download Lambda Functions\r\n    // ========================================\r\n\r\n    // Lambda Export Status Function (GET /exports/{export_id})\r\n    const exportStatusFunction = new lambda.Function(this, 'ExportStatusFunction', {\r\n      functionName: `tdnet-export-status-${this.deploymentEnvironment}`,\r\n      runtime: lambda.Runtime.NODEJS_20_X,\r\n      handler: 'index.handler',\r\n      code: lambda.Code.fromAsset('dist/src/lambda/api/export-status'),\r\n      timeout: cdk.Duration.seconds(envConfig.exportStatus.timeout),\r\n      memorySize: envConfig.exportStatus.memorySize,\r\n      environment: {\r\n        EXPORT_STATUS_TABLE_NAME: this.exportStatusTable.tableName,\r\n        API_KEY_SECRET_ARN: apiKeyValue.secretArn, // ARNのみを環境変数に設定（セキュリティ修正）\r\n        LOG_LEVEL: envConfig.exportStatus.logLevel,\r\n        ENVIRONMENT: this.deploymentEnvironment,\r\n        NODE_OPTIONS: '--enable-source-maps',\r\n      },\r\n    });\r\n\r\n    // IAM権限の付与\r\n    // DynamoDB: exportStatusテーブルへの読み取り権限\r\n    this.exportStatusTable.grantReadData(exportStatusFunction);\r\n\r\n    // Secrets Manager: APIキー読み取り権限\r\n    apiKeyValue.grantRead(exportStatusFunction);\r\n\r\n    // CloudWatch Metrics: カスタムメトリクス送信権限\r\n    exportStatusFunction.addToRolePolicy(\r\n      new cdk.aws_iam.PolicyStatement({\r\n        effect: cdk.aws_iam.Effect.ALLOW,\r\n        actions: ['cloudwatch:PutMetricData'],\r\n        resources: ['*'],\r\n      })\r\n    );\r\n\r\n    // Lambda PDF Download Function (GET /disclosures/{disclosure_id}/pdf)\r\n    const pdfDownloadFunction = new lambda.Function(this, 'PdfDownloadFunction', {\r\n      functionName: `tdnet-pdf-download-${this.deploymentEnvironment}`,\r\n      runtime: lambda.Runtime.NODEJS_20_X,\r\n      handler: 'index.handler',\r\n      code: lambda.Code.fromAsset('dist/src/lambda/api/pdf-download'),\r\n      timeout: cdk.Duration.seconds(envConfig.pdfDownload.timeout),\r\n      memorySize: envConfig.pdfDownload.memorySize,\r\n      environment: {\r\n        DYNAMODB_TABLE_NAME: this.disclosuresTable.tableName,\r\n        S3_BUCKET_NAME: this.pdfsBucket.bucketName,\r\n        API_KEY_SECRET_ARN: apiKeyValue.secretArn, // ARNのみを環境変数に設定（セキュリティ修正）\r\n        LOG_LEVEL: envConfig.pdfDownload.logLevel,\r\n        ENVIRONMENT: this.deploymentEnvironment,\r\n        NODE_OPTIONS: '--enable-source-maps',\r\n      },\r\n    });\r\n\r\n    // IAM権限の付与\r\n    // DynamoDB: disclosuresテーブルへの読み取り権限\r\n    this.disclosuresTable.grantReadData(pdfDownloadFunction);\r\n\r\n    // S3: PDFバケットへの読み取り権限（署名付きURL生成用）\r\n    this.pdfsBucket.grantRead(pdfDownloadFunction);\r\n\r\n    // Secrets Manager: APIキー読み取り権限\r\n    apiKeyValue.grantRead(pdfDownloadFunction);\r\n\r\n    // CloudWatch Metrics: カスタムメトリクス送信権限\r\n    pdfDownloadFunction.addToRolePolicy(\r\n      new cdk.aws_iam.PolicyStatement({\r\n        effect: cdk.aws_iam.Effect.ALLOW,\r\n        actions: ['cloudwatch:PutMetricData'],\r\n        resources: ['*'],\r\n      })\r\n    );\r\n\r\n    // ========================================\r\n    // Phase 2: Export Status & PDF Download API Gateway Integrations\r\n    // ========================================\r\n\r\n    // 1. GET /exports/{export_id} エンドポイント\r\n    const exportIdResource = exportsResource.addResource('{export_id}');\r\n\r\n    const exportStatusIntegration = new apigateway.LambdaIntegration(exportStatusFunction, {\r\n      proxy: true,\r\n      integrationResponses: [\r\n        {\r\n          statusCode: '200', // Success\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '400', // Bad Request\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '401', // Unauthorized\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '404', // Not Found\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '500', // Internal Server Error\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    exportIdResource.addMethod('GET', exportStatusIntegration, {\r\n      apiKeyRequired: true, // APIキー認証必須\r\n      methodResponses: [\r\n        {\r\n          statusCode: '200',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '400',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '401',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '404',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '500',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    // 2. GET /disclosures/{disclosure_id}/pdf エンドポイント\r\n    const disclosureIdResource = disclosuresResource.addResource('{disclosure_id}');\r\n    const pdfResource = disclosureIdResource.addResource('pdf');\r\n\r\n    const pdfDownloadIntegration = new apigateway.LambdaIntegration(pdfDownloadFunction, {\r\n      proxy: true,\r\n      integrationResponses: [\r\n        {\r\n          statusCode: '200', // Success\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '400', // Bad Request\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '401', // Unauthorized\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '404', // Not Found\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n        {\r\n          statusCode: '500', // Internal Server Error\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': \"'*'\",\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    pdfResource.addMethod('GET', pdfDownloadIntegration, {\r\n      apiKeyRequired: true, // APIキー認証必須\r\n      requestParameters: {\r\n        'method.request.querystring.expiration': false,\r\n      },\r\n      methodResponses: [\r\n        {\r\n          statusCode: '200',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '400',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '401',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '404',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n        {\r\n          statusCode: '500',\r\n          responseParameters: {\r\n            'method.response.header.Access-Control-Allow-Origin': true,\r\n          },\r\n        },\r\n      ],\r\n    });\r\n\r\n    // CloudFormation Outputs\r\n    new cdk.CfnOutput(this, 'ExportStatusFunctionName', {\r\n      value: exportStatusFunction.functionName,\r\n      description: 'Lambda Export Status function name',\r\n      exportName: 'TdnetExportStatusFunctionName',\r\n    });\r\n\r\n    new cdk.CfnOutput(this, 'PdfDownloadFunctionName', {\r\n      value: pdfDownloadFunction.functionName,\r\n      description: 'Lambda PDF Download function name',\r\n      exportName: 'TdnetPdfDownloadFunctionName',\r\n    });\r\n\r\n    new cdk.CfnOutput(this, 'CollectFunctionName', {\r\n      value: collectFunction.functionName,\r\n      description: 'Lambda Collect function name',\r\n      exportName: 'TdnetCollectFunctionName',\r\n    });\r\n\r\n    new cdk.CfnOutput(this, 'CollectStatusFunctionName', {\r\n      value: collectStatusFunction.functionName,\r\n      description: 'Lambda Collect Status function name',\r\n      exportName: 'TdnetCollectStatusFunctionName',\r\n    });\r\n\r\n    new cdk.CfnOutput(this, 'DisclosuresEndpoint', {\r\n      value: `${this.api.url}disclosures`,\r\n      description: 'Disclosures query API endpoint URL',\r\n      exportName: 'TdnetDisclosuresEndpoint',\r\n    });\r\n\r\n    new cdk.CfnOutput(this, 'ExportsEndpoint', {\r\n      value: `${this.api.url}exports`,\r\n      description: 'Export API endpoint URL',\r\n      exportName: 'TdnetExportsEndpoint',\r\n    });\r\n\r\n    new cdk.CfnOutput(this, 'CollectEndpoint', {\r\n      value: `${this.api.url}collect`,\r\n      description: 'Collect API endpoint URL',\r\n      exportName: 'TdnetCollectEndpoint',\r\n    });\r\n\r\n    // ========================================\r\n    // Phase 3: CloudWatch Alarms\r\n    // ========================================\r\n\r\n    // すべてのLambda関数を監視対象として収集\r\n    const allLambdaFunctions = [\r\n      collectorFunction,\r\n      queryFunction,\r\n      exportFunction,\r\n      collectFunction,\r\n      collectStatusFunction,\r\n      exportStatusFunction,\r\n      pdfDownloadFunction,\r\n    ];\r\n\r\n    // CloudWatch Alarmsを作成\r\n    const cloudwatchAlarms = new CloudWatchAlarms(this, 'CloudWatchAlarms', {\r\n      lambdaFunctions: allLambdaFunctions,\r\n      environment: this.deploymentEnvironment,\r\n      // alertEmail: 'your-email@example.com', // オプション: メール通知先\r\n      errorRateThreshold: 10, // 10%\r\n      durationThreshold: 840, // 14分 = 840秒\r\n      collectionSuccessRateThreshold: 95, // 95%\r\n    });\r\n\r\n    // CloudFormation Outputs\r\n    new cdk.CfnOutput(this, 'CloudWatchAlarmsCount', {\r\n      value: cloudwatchAlarms.alarms.length.toString(),\r\n      description: 'Number of CloudWatch Alarms created',\r\n    });\r\n\r\n    // ========================================\r\n    // Phase 3: CloudWatch Dashboard\r\n    // ========================================\r\n\r\n    // CloudWatch Dashboardを作成\r\n    const dashboard = new CloudWatchDashboard(this, 'CloudWatchDashboard', {\r\n      environment: this.deploymentEnvironment,\r\n      lambdaFunctions: {\r\n        collector: collectorFunction,\r\n        query: queryFunction,\r\n        export: exportFunction,\r\n        collect: collectFunction,\r\n        collectStatus: collectStatusFunction,\r\n        exportStatus: exportStatusFunction,\r\n        pdfDownload: pdfDownloadFunction,\r\n      },\r\n      dynamodbTables: {\r\n        disclosures: this.disclosuresTable,\r\n        executions: this.executionsTable,\r\n        exportStatus: this.exportStatusTable,\r\n      },\r\n      s3Buckets: {\r\n        pdfs: this.pdfsBucket,\r\n        exports: this.exportsBucket,\r\n      },\r\n      apiGateway: this.api,\r\n    });\r\n\r\n    // CloudFormation Outputs\r\n    new cdk.CfnOutput(this, 'DashboardName', {\r\n      value: dashboard.dashboard.dashboardName,\r\n      description: 'CloudWatch Dashboard name',\r\n      exportName: 'TdnetDashboardName',\r\n    });\r\n  }\r\n}\r\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;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","ignoreList":[]}