a147a03a72d85f18fbc4c0fc4285b8ff
"use strict";
/**
 * Property 10: エクスポートファイルの有効期限
 *
 * Validates: Requirements 7.2, 12.4
 * エクスポートファイルに7日後の自動削除ライフサイクルポリシーが適用されることを確認
 *
 * Requirements: 要件14.2（プロパティテスト）
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
// モック
jest.mock('../../../utils/logger');
jest.mock('../../../utils/retry', () => ({
    retryWithBackoff: jest.fn((fn) => fn()),
}));
const fc = __importStar(require("fast-check"));
const export_to_s3_1 = require("../export-to-s3");
const client_s3_1 = require("@aws-sdk/client-s3");
const aws_sdk_client_mock_1 = require("aws-sdk-client-mock");
describe('Property 10: エクスポートファイルの有効期限', () => {
    const s3Mock = (0, aws_sdk_client_mock_1.mockClient)(client_s3_1.S3Client);
    beforeEach(() => {
        s3Mock.reset();
        process.env.EXPORT_BUCKET_NAME = 'test-exports-bucket';
        process.env.AWS_REGION = 'ap-northeast-1';
        // S3Client.send のモック - PutObjectCommandを正しくキャプチャ
        s3Mock.on(client_s3_1.PutObjectCommand).resolves({});
    });
    /**
     * Property: すべてのエクスポートファイルに auto-delete タグが設定される
     *
     * このプロパティは、エクスポートファイルがS3にアップロードされる際に、
     * 必ず auto-delete=true タグが設定されることを検証します。
     * このタグは、S3ライフサイクルポリシーによって7日後に自動削除されるために使用されます。
     */
    it('Property: すべてのエクスポートファイルに auto-delete タグが設定される', async () => {
        await fc.assert(fc.asyncProperty(
        // Arbitrary: エクスポートID
        fc.string({ minLength: 10, maxLength: 50 }), 
        // Arbitrary: フォーマット（json または csv）
        fc.constantFrom('json', 'csv'), 
        // Arbitrary: 開示情報のリスト（0〜100件）
        fc.array(fc.record({
            disclosure_id: fc.string({ minLength: 10, maxLength: 20 }),
            company_code: fc.stringOf(fc.integer({ min: 0, max: 9 }), { minLength: 4, maxLength: 4 }),
            company_name: fc.string({ minLength: 1, maxLength: 100 }),
            disclosure_type: fc.constantFrom('決算短信', '有価証券報告書', '適時開示'),
            title: fc.string({ minLength: 1, maxLength: 200 }),
            disclosed_at: fc
                .date({ min: new Date('2020-01-01'), max: new Date('2025-12-31') })
                .map((d) => d.toISOString()),
            pdf_url: fc.webUrl(),
            s3_key: fc.string({ minLength: 10, maxLength: 100 }),
            collected_at: fc
                .date({ min: new Date('2020-01-01'), max: new Date('2025-12-31') })
                .map((d) => d.toISOString()),
            date_partition: fc
                .date({ min: new Date('2020-01-01'), max: new Date('2025-12-31') })
                .map((d) => {
                const year = d.getFullYear();
                const month = String(d.getMonth() + 1).padStart(2, '0');
                return `${year}-${month}`;
            }),
        }), { minLength: 0, maxLength: 100 }), async (export_id, format, disclosures) => {
            // Arrange
            s3Mock.reset();
            s3Mock.on(client_s3_1.PutObjectCommand).resolves({});
            // Act
            await (0, export_to_s3_1.exportToS3)(export_id, disclosures, format);
            // Assert
            expect(s3Mock.calls()).toHaveLength(1);
            const call = s3Mock.call(0);
            // PutObjectCommandのinputプロパティにアクセス
            expect(call.args[0].input).toBeDefined();
            expect(call.args[0].input.Tagging).toBe('auto-delete=true');
        }), {
            numRuns: 100, // 100回のランダムテストを実行
            verbose: true,
        });
    });
    /**
     * Property: S3キーが正しいフォーマットで生成される
     *
     * このプロパティは、エクスポートファイルのS3キーが常に正しいフォーマット
     * （exports/YYYY/MM/DD/export_id.format）で生成されることを検証します。
     */
    it('Property: S3キーが正しいフォーマットで生成される', async () => {
        await fc.assert(fc.asyncProperty(
        // Arbitrary: エクスポートID
        fc.string({ minLength: 10, maxLength: 50 }), 
        // Arbitrary: フォーマット（json または csv）
        fc.constantFrom('json', 'csv'), 
        // Arbitrary: 開示情報のリスト（0〜10件、パフォーマンスのため少なめ）
        fc.array(fc.record({
            disclosure_id: fc.string({ minLength: 10, maxLength: 20 }),
            company_code: fc.stringOf(fc.integer({ min: 0, max: 9 }), { minLength: 4, maxLength: 4 }),
            company_name: fc.string({ minLength: 1, maxLength: 100 }),
            disclosure_type: fc.constantFrom('決算短信', '有価証券報告書', '適時開示'),
            title: fc.string({ minLength: 1, maxLength: 200 }),
            disclosed_at: fc
                .date({ min: new Date('2020-01-01'), max: new Date('2025-12-31') })
                .map((d) => d.toISOString()),
            pdf_url: fc.webUrl(),
            s3_key: fc.string({ minLength: 10, maxLength: 100 }),
            collected_at: fc
                .date({ min: new Date('2020-01-01'), max: new Date('2025-12-31') })
                .map((d) => d.toISOString()),
            date_partition: fc
                .date({ min: new Date('2020-01-01'), max: new Date('2025-12-31') })
                .map((d) => {
                const year = d.getFullYear();
                const month = String(d.getMonth() + 1).padStart(2, '0');
                return `${year}-${month}`;
            }),
        }), { minLength: 0, maxLength: 10 }), async (export_id, format, disclosures) => {
            // Act
            const s3_key = await (0, export_to_s3_1.exportToS3)(export_id, disclosures, format);
            // Assert
            // Property: S3キーが正しいフォーマット（exports/YYYY/MM/DD/export_id.format）
            const s3KeyRegex = new RegExp(`^exports/\\d{4}/\\d{2}/\\d{2}/[^/]+\\.${format}$`);
            expect(s3_key).toMatch(s3KeyRegex);
        }), {
            numRuns: 100,
            verbose: true,
        });
    });
    /**
     * Property: ContentTypeが正しく設定される
     *
     * このプロパティは、エクスポートファイルのContentTypeが
     * フォーマットに応じて正しく設定されることを検証します。
     * - JSON: application/json
     * - CSV: text/csv
     */
    it('Property: ContentTypeが正しく設定される', async () => {
        await fc.assert(fc.asyncProperty(
        // Arbitrary: エクスポートID
        fc.string({ minLength: 10, maxLength: 50 }), 
        // Arbitrary: フォーマット（json または csv）
        fc.constantFrom('json', 'csv'), 
        // Arbitrary: 開示情報のリスト（0〜10件）
        fc.array(fc.record({
            disclosure_id: fc.string({ minLength: 10, maxLength: 20 }),
            company_code: fc.stringOf(fc.integer({ min: 0, max: 9 }), { minLength: 4, maxLength: 4 }),
            company_name: fc.string({ minLength: 1, maxLength: 100 }),
            disclosure_type: fc.constantFrom('決算短信', '有価証券報告書', '適時開示'),
            title: fc.string({ minLength: 1, maxLength: 200 }),
            disclosed_at: fc
                .date({ min: new Date('2020-01-01'), max: new Date('2025-12-31') })
                .map((d) => d.toISOString()),
            pdf_url: fc.webUrl(),
            s3_key: fc.string({ minLength: 10, maxLength: 100 }),
            collected_at: fc
                .date({ min: new Date('2020-01-01'), max: new Date('2025-12-31') })
                .map((d) => d.toISOString()),
            date_partition: fc
                .date({ min: new Date('2020-01-01'), max: new Date('2025-12-31') })
                .map((d) => {
                const year = d.getFullYear();
                const month = String(d.getMonth() + 1).padStart(2, '0');
                return `${year}-${month}`;
            }),
        }), { minLength: 0, maxLength: 10 }), async (export_id, format, disclosures) => {
            // Act
            await (0, export_to_s3_1.exportToS3)(export_id, disclosures, format);
            // Assert
            expect(s3Mock.calls()).toHaveLength(1);
            const call = s3Mock.call(0);
            // PutObjectCommandのinputプロパティにアクセス
            expect(call.args[0].input).toBeDefined();
            const contentType = call.args[0].input.ContentType;
            // Property: ContentTypeが正しく設定されている
            const expectedContentType = format === 'json' ? 'application/json' : 'text/csv';
            expect(contentType).toBe(expectedContentType);
        }), {
            numRuns: 100,
            verbose: true,
        });
    });
    /**
     * Property: CSV形式の場合、カンマを含む値が正しくエスケープされる
     *
     * このプロパティは、CSV形式でエクスポートする際に、
     * カンマを含む値が正しくダブルクォートで囲まれることを検証します。
     */
    it('Property: CSV形式の場合、カンマを含む値が正しくエスケープされる', async () => {
        await fc.assert(fc.asyncProperty(
        // Arbitrary: エクスポートID
        fc.string({ minLength: 10, maxLength: 50 }), 
        // Arbitrary: カンマを含むタイトル
        fc.string({ minLength: 1, maxLength: 50 }).map((s) => `${s}, カンマ含む`), async (export_id, titleWithComma) => {
            // Arrange
            const disclosures = [
                {
                    disclosure_id: '20240115_1234_001',
                    company_code: '1234',
                    company_name: 'テスト株式会社',
                    disclosure_type: '決算短信',
                    title: titleWithComma,
                    disclosed_at: '2024-01-15T10:30:00Z',
                    pdf_url: 'https://example.com/pdf/20240115_1234_001.pdf',
                    s3_key: 'pdfs/2024/01/15/20240115_1234_001.pdf',
                    collected_at: '2024-01-15T10:35:00Z',
                    date_partition: '2024-01',
                },
            ];
            // Arrange
            s3Mock.reset();
            s3Mock.on(client_s3_1.PutObjectCommand).resolves({});
            // Act
            await (0, export_to_s3_1.exportToS3)(export_id, disclosures, 'csv');
            // Assert
            expect(s3Mock.calls()).toHaveLength(1);
            const call = s3Mock.call(0);
            // PutObjectCommandのinputプロパティにアクセス
            expect(call.args[0].input).toBeDefined();
            const body = call.args[0].input.Body;
            const lines = body.split('\n');
            // Property: カンマを含む値がダブルクォートで囲まれている
            expect(lines[1]).toContain(`"${titleWithComma}"`);
        }), {
            numRuns: 50,
            verbose: true,
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFx0aTE5OFxcaW52ZXN0bWVudF9hbmFseXNpc19vcG9wb1xcc3JjXFxsYW1iZGFcXGV4cG9ydFxcX190ZXN0c19fXFxleHBvcnQtZmlsZS1leHBpcmF0aW9uLnByb3BlcnR5LnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7O0dBT0c7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBUUgsTUFBTTtBQUNOLElBQUksQ0FBQyxJQUFJLENBQUMsdUJBQXVCLENBQUMsQ0FBQztBQUNuQyxJQUFJLENBQUMsSUFBSSxDQUFDLHNCQUFzQixFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDdkMsZ0JBQWdCLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUM7Q0FDeEMsQ0FBQyxDQUFDLENBQUM7QUFWSiwrQ0FBaUM7QUFDakMsa0RBQTZDO0FBRTdDLGtEQUFnRTtBQUNoRSw2REFBaUQ7QUFRakQsUUFBUSxDQUFDLDhCQUE4QixFQUFFLEdBQUcsRUFBRTtJQUM1QyxNQUFNLE1BQU0sR0FBRyxJQUFBLGdDQUFVLEVBQUMsb0JBQVEsQ0FBQyxDQUFDO0lBRXBDLFVBQVUsQ0FBQyxHQUFHLEVBQUU7UUFDZCxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUM7UUFDZixPQUFPLENBQUMsR0FBRyxDQUFDLGtCQUFrQixHQUFHLHFCQUFxQixDQUFDO1FBQ3ZELE9BQU8sQ0FBQyxHQUFHLENBQUMsVUFBVSxHQUFHLGdCQUFnQixDQUFDO1FBRTFDLGlEQUFpRDtRQUNqRCxNQUFNLENBQUMsRUFBRSxDQUFDLDRCQUFnQixDQUFDLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0lBQzNDLENBQUMsQ0FBQyxDQUFDO0lBRUg7Ozs7OztPQU1HO0lBQ0gsRUFBRSxDQUFDLGdEQUFnRCxFQUFFLEtBQUssSUFBSSxFQUFFO1FBQzlELE1BQU0sRUFBRSxDQUFDLE1BQU0sQ0FDYixFQUFFLENBQUMsYUFBYTtR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SyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUFDLElBQUksY0FBYyxHQUFHLENBQUMsQ0FBQztRQUNwRCxDQUFDLENBQ0YsRUFDRDtZQUNFLE9BQU8sRUFBRSxFQUFFO1lBQ1gsT0FBTyxFQUFFLElBQUk7U0FDZCxDQUNGLENBQUM7SUFDSixDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcdGkxOThcXGludmVzdG1lbnRfYW5hbHlzaXNfb3BvcG9cXHNyY1xcbGFtYmRhXFxleHBvcnRcXF9fdGVzdHNfX1xcZXhwb3J0LWZpbGUtZXhwaXJhdGlvbi5wcm9wZXJ0eS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBQcm9wZXJ0eSAxMDog44Ko44Kv44K544Od44O844OI44OV44Kh44Kk44Or44Gu5pyJ5Yq55pyf6ZmQXHJcbiAqXHJcbiAqIFZhbGlkYXRlczogUmVxdWlyZW1lbnRzIDcuMiwgMTIuNFxyXG4gKiDjgqjjgq/jgrnjg53jg7zjg4jjg5XjgqHjgqTjg6vjgas35pel5b6M44Gu6Ieq5YuV5YmK6Zmk44Op44Kk44OV44K144Kk44Kv44Or44Od44Oq44K344O844GM6YGp55So44GV44KM44KL44GT44Go44KS56K66KqNXHJcbiAqXHJcbiAqIFJlcXVpcmVtZW50czog6KaB5Lu2MTQuMu+8iOODl+ODreODkeODhuOCo+ODhuOCueODiO+8iVxyXG4gKi9cclxuXHJcbmltcG9ydCAqIGFzIGZjIGZyb20gJ2Zhc3QtY2hlY2snO1xyXG5pbXBvcnQgeyBleHBvcnRUb1MzIH0gZnJvbSAnLi4vZXhwb3J0LXRvLXMzJztcclxuaW1wb3J0IHsgRGlzY2xvc3VyZSB9IGZyb20gJy4uLy4uLy4uL3R5cGVzJztcclxuaW1wb3J0IHsgUzNDbGllbnQsIFB1dE9iamVjdENvbW1hbmQgfSBmcm9tICdAYXdzLXNkay9jbGllbnQtczMnO1xyXG5pbXBvcnQgeyBtb2NrQ2xpZW50IH0gZnJvbSAnYXdzLXNkay1jbGllbnQtbW9jayc7XHJcblxyXG4vLyDjg6Ljg4Pjgq9cclxuamVzdC5tb2NrKCcuLi8uLi8uLi91dGlscy9sb2dnZXInKTtcclxuamVzdC5tb2NrKCcuLi8uLi8uLi91dGlscy9yZXRyeScsICgpID0+ICh7XHJcbiAgcmV0cnlXaXRoQmFja29mZjogamVzdC5mbigoZm4pID0+IGZuKCkpLFxyXG59KSk7XHJcblxyXG5kZXNjcmliZSgnUHJvcGVydHkgMTA6IOOCqOOCr+OCueODneODvOODiOODleOCoeOCpOODq+OBruacieWKueacn+mZkCcsICgpID0+IHtcclxuICBjb25zdCBzM01vY2sgPSBtb2NrQ2xpZW50KFMzQ2xpZW50KTtcclxuXHJcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICBzM01vY2sucmVzZXQoKTtcclxuICAgIHByb2Nlc3MuZW52LkVYUE9SVF9CVUNLRVRfTkFNRSA9ICd0ZXN0LWV4cG9ydHMtYnVja2V0JztcclxuICAgIHByb2Nlc3MuZW52LkFXU19SRUdJT04gPSAnYXAtbm9ydGhlYXN0LTEnO1xyXG5cclxuICAgIC8vIFMzQ2xpZW50LnNlbmQg44Gu44Oi44OD44KvIC0gUHV0T2JqZWN0Q29tbWFuZOOCkuato+OBl+OBj+OCreODo+ODl+ODgeODo1xyXG4gICAgczNNb2NrLm9uKFB1dE9iamVjdENvbW1hbmQpLnJlc29sdmVzKHt9KTtcclxuICB9KTtcclxuXHJcbiAgLyoqXHJcbiAgICogUHJvcGVydHk6IOOBmeOBueOBpuOBruOCqOOCr+OCueODneODvOODiOODleOCoeOCpOODq+OBqyBhdXRvLWRlbGV0ZSDjgr/jgrDjgYzoqK3lrprjgZXjgozjgotcclxuICAgKlxyXG4gICAqIOOBk+OBruODl+ODreODkeODhuOCo+OBr+OAgeOCqOOCr+OCueODneODvOODiOODleOCoeOCpOODq+OBjFMz44Gr44Ki44OD44OX44Ot44O844OJ44GV44KM44KL6Zqb44Gr44CBXHJcbiAgICog5b+F44GaIGF1dG8tZGVsZXRlPXRydWUg44K/44Kw44GM6Kit5a6a44GV44KM44KL44GT44Go44KS5qSc6Ki844GX44G+44GZ44CCXHJcbiAgICog44GT44Gu44K/44Kw44Gv44CBUzPjg6njgqTjg5XjgrXjgqTjgq/jg6vjg53jg6rjgrfjg7zjgavjgojjgaPjgaY35pel5b6M44Gr6Ieq5YuV5YmK6Zmk44GV44KM44KL44Gf44KB44Gr5L2/55So44GV44KM44G+44GZ44CCXHJcbiAgICovXHJcbiAgaXQoJ1Byb3BlcnR5OiDjgZnjgbnjgabjga7jgqjjgq/jgrnjg53jg7zjg4jjg5XjgqHjgqTjg6vjgasgYXV0by1kZWxldGUg44K/44Kw44GM6Kit5a6a44GV44KM44KLJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgYXdhaXQgZmMuYXNzZXJ0KFxyXG4gICAgICBmYy5hc3luY1Byb3BlcnR5KFxyXG4gICAgICAgIC8vIEFyYml0cmFyeTog44Ko44Kv44K544Od44O844OISURcclxuICAgICAgICBmYy5zdHJpbmcoeyBtaW5MZW5ndGg6IDEwLCBtYXhMZW5ndGg6IDUwIH0pLFxyXG4gICAgICAgIC8vIEFyYml0cmFyeTog44OV44Kp44O844Oe44OD44OI77yIanNvbiDjgb7jgZ/jga8gY3N277yJXHJcbiAgICAgICAgZmMuY29uc3RhbnRGcm9tKCdqc29uJyBhcyBjb25zdCwgJ2NzdicgYXMgY29uc3QpLFxyXG4gICAgICAgIC8vIEFyYml0cmFyeTog6ZaL56S65oOF5aCx44Gu44Oq44K544OI77yIMOOAnDEwMOS7tu+8iVxyXG4gICAgICAgIGZjLmFycmF5KFxyXG4gICAgICAgICAgZmMucmVjb3JkKHtcclxuICAgICAgICAgICAgZGlzY2xvc3VyZV9pZDogZmMuc3RyaW5nKHsgbWluTGVuZ3RoOiAxMCwgbWF4TGVuZ3RoOiAyMCB9KSxcclxuICAgICAgICAgICAgY29tcGFueV9jb2RlOiBmYy5zdHJpbmdPZihmYy5pbnRlZ2VyKHsgbWluOiAwLCBtYXg6IDkgfSksIHsgbWluTGVuZ3RoOiA0LCBtYXhMZW5ndGg6IDQgfSksXHJcbiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogZmMuc3RyaW5nKHsgbWluTGVuZ3RoOiAxLCBtYXhMZW5ndGg6IDEwMCB9KSxcclxuICAgICAgICAgICAgZGlzY2xvc3VyZV90eXBlOiBmYy5jb25zdGFudEZyb20oJ+axuueul+efreS/oScsICfmnInkvqHoqLzliLjloLHlkYrmm7gnLCAn6YGp5pmC6ZaL56S6JyksXHJcbiAgICAgICAgICAgIHRpdGxlOiBmYy5zdHJpbmcoeyBtaW5MZW5ndGg6IDEsIG1heExlbmd0aDogMjAwIH0pLFxyXG4gICAgICAgICAgICBkaXNjbG9zZWRfYXQ6IGZjXHJcbiAgICAgICAgICAgICAgLmRhdGUoeyBtaW46IG5ldyBEYXRlKCcyMDIwLTAxLTAxJyksIG1heDogbmV3IERhdGUoJzIwMjUtMTItMzEnKSB9KVxyXG4gICAgICAgICAgICAgIC5tYXAoKGQpID0+IGQudG9JU09TdHJpbmcoKSksXHJcbiAgICAgICAgICAgIHBkZl91cmw6IGZjLndlYlVybCgpLFxyXG4gICAgICAgICAgICBzM19rZXk6IGZjLnN0cmluZyh7IG1pbkxlbmd0aDogMTAsIG1heExlbmd0aDogMTAwIH0pLFxyXG4gICAgICAgICAgICBjb2xsZWN0ZWRfYXQ6IGZjXHJcbiAgICAgICAgICAgICAgLmRhdGUoeyBtaW46IG5ldyBEYXRlKCcyMDIwLTAxLTAxJyksIG1heDogbmV3IERhdGUoJzIwMjUtMTItMzEnKSB9KVxyXG4gICAgICAgICAgICAgIC5tYXAoKGQpID0+IGQudG9JU09TdHJpbmcoKSksXHJcbiAgICAgICAgICAgIGRhdGVfcGFydGl0aW9uOiBmY1xyXG4gICAgICAgICAgICAgIC5kYXRlKHsgbWluOiBuZXcgRGF0ZSgnMjAyMC0wMS0wMScpLCBtYXg6IG5ldyBEYXRlKCcyMDI1LTEyLTMxJykgfSlcclxuICAgICAgICAgICAgICAubWFwKChkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB5ZWFyID0gZC5nZXRGdWxsWWVhcigpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbW9udGggPSBTdHJpbmcoZC5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgJzAnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBgJHt5ZWFyfS0ke21vbnRofWA7XHJcbiAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICB9KSxcclxuICAgICAgICAgIHsgbWluTGVuZ3RoOiAwLCBtYXhMZW5ndGg6IDEwMCB9XHJcbiAgICAgICAgKSxcclxuICAgICAgICBhc3luYyAoZXhwb3J0X2lkLCBmb3JtYXQsIGRpc2Nsb3N1cmVzKSA9PiB7XHJcbiAgICAgICAgICAvLyBBcnJhbmdlXHJcbiAgICAgICAgICBzM01vY2sucmVzZXQoKTtcclxuICAgICAgICAgIHMzTW9jay5vbihQdXRPYmplY3RDb21tYW5kKS5yZXNvbHZlcyh7fSk7XHJcblxyXG4gICAgICAgICAgLy8gQWN0XHJcbiAgICAgICAgICBhd2FpdCBleHBvcnRUb1MzKGV4cG9ydF9pZCwgZGlzY2xvc3VyZXMgYXMgRGlzY2xvc3VyZVtdLCBmb3JtYXQpO1xyXG5cclxuICAgICAgICAgIC8vIEFzc2VydFxyXG4gICAgICAgICAgZXhwZWN0KHMzTW9jay5jYWxscygpKS50b0hhdmVMZW5ndGgoMSk7XHJcbiAgICAgICAgICBjb25zdCBjYWxsID0gczNNb2NrLmNhbGwoMCk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIFB1dE9iamVjdENvbW1hbmTjga5pbnB1dOODl+ODreODkeODhuOCo+OBq+OCouOCr+OCu+OCuVxyXG4gICAgICAgICAgZXhwZWN0KGNhbGwuYXJnc1swXS5pbnB1dCkudG9CZURlZmluZWQoKTtcclxuICAgICAgICAgIGV4cGVjdChjYWxsLmFyZ3NbMF0uaW5wdXQuVGFnZ2luZykudG9CZSgnYXV0by1kZWxldGU9dHJ1ZScpO1xyXG4gICAgICAgIH1cclxuICAgICAgKSxcclxuICAgICAge1xyXG4gICAgICAgIG51bVJ1bnM6IDEwMCwgLy8gMTAw5Zue44Gu44Op44Oz44OA44Og44OG44K544OI44KS5a6f6KGMXHJcbiAgICAgICAgdmVyYm9zZTogdHJ1ZSxcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9KTtcclxuXHJcbiAgLyoqXHJcbiAgICogUHJvcGVydHk6IFMz44Kt44O844GM5q2j44GX44GE44OV44Kp44O844Oe44OD44OI44Gn55Sf5oiQ44GV44KM44KLXHJcbiAgICpcclxuICAgKiDjgZPjga7jg5fjg63jg5Hjg4bjgqPjga/jgIHjgqjjgq/jgrnjg53jg7zjg4jjg5XjgqHjgqTjg6vjga5TM+OCreODvOOBjOW4uOOBq+ato+OBl+OBhOODleOCqeODvOODnuODg+ODiFxyXG4gICAqIO+8iGV4cG9ydHMvWVlZWS9NTS9ERC9leHBvcnRfaWQuZm9ybWF077yJ44Gn55Sf5oiQ44GV44KM44KL44GT44Go44KS5qSc6Ki844GX44G+44GZ44CCXHJcbiAgICovXHJcbiAgaXQoJ1Byb3BlcnR5OiBTM+OCreODvOOBjOato+OBl+OBhOODleOCqeODvOODnuODg+ODiOOBp+eUn+aIkOOBleOCjOOCiycsIGFzeW5jICgpID0+IHtcclxuICAgIGF3YWl0IGZjLmFzc2VydChcclxuICAgICAgZmMuYXN5bmNQcm9wZXJ0eShcclxuICAgICAgICAvLyBBcmJpdHJhcnk6IOOCqOOCr+OCueODneODvOODiElEXHJcbiAgICAgICAgZmMuc3RyaW5nKHsgbWluTGVuZ3RoOiAxMCwgbWF4TGVuZ3RoOiA1MCB9KSxcclxuICAgICAgICAvLyBBcmJpdHJhcnk6IOODleOCqeODvOODnuODg+ODiO+8iGpzb24g44G+44Gf44GvIGNzdu+8iVxyXG4gICAgICAgIGZjLmNvbnN0YW50RnJvbSgnanNvbicgYXMgY29uc3QsICdjc3YnIGFzIGNvbnN0KSxcclxuICAgICAgICAvLyBBcmJpdHJhcnk6IOmWi+ekuuaDheWgseOBruODquOCueODiO+8iDDjgJwxMOS7tuOAgeODkeODleOCqeODvOODnuODs+OCueOBruOBn+OCgeWwkeOBquOCge+8iVxyXG4gICAgICAgIGZjLmFycmF5KFxyXG4gICAgICAgICAgZmMucmVjb3JkKHtcclxuICAgICAgICAgICAgZGlzY2xvc3VyZV9pZDogZmMuc3RyaW5nKHsgbWluTGVuZ3RoOiAxMCwgbWF4TGVuZ3RoOiAyMCB9KSxcclxuICAgICAgICAgICAgY29tcGFueV9jb2RlOiBmYy5zdHJpbmdPZihmYy5pbnRlZ2VyKHsgbWluOiAwLCBtYXg6IDkgfSksIHsgbWluTGVuZ3RoOiA0LCBtYXhMZW5ndGg6IDQgfSksXHJcbiAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogZmMuc3RyaW5nKHsgbWluTGVuZ3RoOiAxLCBtYXhMZW5ndGg6IDEwMCB9KSxcclxuICAgICAgICAgICAgZGlzY2xvc3VyZV90eXBlOiBmYy5jb25zdGFudEZyb20oJ+axuueul+efreS/oScsICfmnInkvqHoqLzliLjloLHlkYrmm7gnLCAn6YGp5pmC6ZaL56S6JyksXHJcbiAgICAgICAgICAgIHRpdGxlOiBmYy5zdHJpbmcoeyBtaW5MZW5ndGg6IDEsIG1heExlbmd0aDogMjAwIH0pLFxyXG4gICAgICAgICAgICBkaXNjbG9zZWRfYXQ6IGZjXHJcbiAgICAgICAgICAgICAgLmRhdGUoeyBtaW46IG5ldyBEYXRlKCcyMDIwLTAxLTAxJyksIG1heDogbmV3IERhdGUoJzIwMjUtMTItMzEnKSB9KVxyXG4gICAgICAgICAgICAgIC5tYXAoKGQpID0+IGQudG9JU09TdHJpbmcoKSksXHJcbiAgICAgICAgICAgIHBkZl91cmw6IGZjLndlYlVybCgpLFxyXG4gICAgICAgICAgICBzM19rZXk6IGZjLnN0cmluZyh7IG1pbkxlbmd0aDogMTAsIG1heExlbmd0aDogMTAwIH0pLFxyXG4gICAgICAgICAgICBjb2xsZWN0ZWRfYXQ6IGZjXHJcbiAgICAgICAgICAgICAgLmRhdGUoeyBtaW46IG5ldyBEYXRlKCcyMDIwLTAxLTAxJyksIG1heDogbmV3IERhdGUoJzIwMjUtMTItMzEnKSB9KVxyXG4gICAgICAgICAgICAgIC5tYXAoKGQpID0+IGQudG9JU09TdHJpbmcoKSksXHJcbiAgICAgICAgICAgIGRhdGVfcGFydGl0aW9uOiBmY1xyXG4gICAgICAgICAgICAgIC5kYXRlKHsgbWluOiBuZXcgRGF0ZSgnMjAyMC0wMS0wMScpLCBtYXg6IG5ldyBEYXRlKCcyMDI1LTEyLTMxJykgfSlcclxuICAgICAgICAgICAgICAubWFwKChkKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCB5ZWFyID0gZC5nZXRGdWxsWWVhcigpO1xyXG4gICAgICAgICAgICAgICAgY29uc3QgbW9udGggPSBTdHJpbmcoZC5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgJzAnKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBgJHt5ZWFyfS0ke21vbnRofWA7XHJcbiAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICB9KSxcclxuICAgICAgICAgIHsgbWluTGVuZ3RoOiAwLCBtYXhMZW5ndGg6IDEwIH1cclxuICAgICAgICApLFxyXG4gICAgICAgIGFzeW5jIChleHBvcnRfaWQsIGZvcm1hdCwgZGlzY2xvc3VyZXMpID0+IHtcclxuICAgICAgICAgIC8vIEFjdFxyXG4gICAgICAgICAgY29uc3QgczNfa2V5ID0gYXdhaXQgZXhwb3J0VG9TMyhleHBvcnRfaWQsIGRpc2Nsb3N1cmVzIGFzIERpc2Nsb3N1cmVbXSwgZm9ybWF0KTtcclxuXHJcbiAgICAgICAgICAvLyBBc3NlcnRcclxuICAgICAgICAgIC8vIFByb3BlcnR5OiBTM+OCreODvOOBjOato+OBl+OBhOODleOCqeODvOODnuODg+ODiO+8iGV4cG9ydHMvWVlZWS9NTS9ERC9leHBvcnRfaWQuZm9ybWF077yJXHJcbiAgICAgICAgICBjb25zdCBzM0tleVJlZ2V4ID0gbmV3IFJlZ0V4cChcclxuICAgICAgICAgICAgYF5leHBvcnRzL1xcXFxkezR9L1xcXFxkezJ9L1xcXFxkezJ9L1teL10rXFxcXC4ke2Zvcm1hdH0kYFxyXG4gICAgICAgICAgKTtcclxuICAgICAgICAgIGV4cGVjdChzM19rZXkpLnRvTWF0Y2goczNLZXlSZWdleCk7XHJcbiAgICAgICAgfVxyXG4gICAgICApLFxyXG4gICAgICB7XHJcbiAgICAgICAgbnVtUnVuczogMTAwLFxyXG4gICAgICAgIHZlcmJvc2U6IHRydWUsXHJcbiAgICAgIH1cclxuICAgICk7XHJcbiAgfSk7XHJcblxyXG4gIC8qKlxyXG4gICAqIFByb3BlcnR5OiBDb250ZW50VHlwZeOBjOato+OBl+OBj+ioreWumuOBleOCjOOCi1xyXG4gICAqXHJcbiAgICog44GT44Gu44OX44Ot44OR44OG44Kj44Gv44CB44Ko44Kv44K544Od44O844OI44OV44Kh44Kk44Or44GuQ29udGVudFR5cGXjgYxcclxuICAgKiDjg5Xjgqnjg7zjg57jg4Pjg4jjgavlv5zjgZjjgabmraPjgZfjgY/oqK3lrprjgZXjgozjgovjgZPjgajjgpLmpJzoqLzjgZfjgb7jgZnjgIJcclxuICAgKiAtIEpTT046IGFwcGxpY2F0aW9uL2pzb25cclxuICAgKiAtIENTVjogdGV4dC9jc3ZcclxuICAgKi9cclxuICBpdCgnUHJvcGVydHk6IENvbnRlbnRUeXBl44GM5q2j44GX44GP6Kit5a6a44GV44KM44KLJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgYXdhaXQgZmMuYXNzZXJ0KFxyXG4gICAgICBmYy5hc3luY1Byb3BlcnR5KFxyXG4gICAgICAgIC8vIEFyYml0cmFyeTog44Ko44Kv44K544Od44O844OISURcclxuICAgICAgICBmYy5zdHJpbmcoeyBtaW5MZW5ndGg6IDEwLCBtYXhMZW5ndGg6IDUwIH0pLFxyXG4gICAgICAgIC8vIEFyYml0cmFyeTog44OV44Kp44O844Oe44OD44OI77yIanNvbiDjgb7jgZ/jga8gY3N277yJXHJcbiAgICAgICAgZmMuY29uc3RhbnRGcm9tKCdqc29uJyBhcyBjb25zdCwgJ2NzdicgYXMgY29uc3QpLFxyXG4gICAgICAgIC8vIEFyYml0cmFyeTog6ZaL56S65oOF5aCx44Gu44Oq44K544OI77yIMOOAnDEw5Lu277yJXHJcbiAgICAgICAgZmMuYXJyYXkoXHJcbiAgICAgICAgICBmYy5yZWNvcmQoe1xyXG4gICAgICAgICAgICBkaXNjbG9zdXJlX2lkOiBmYy5zdHJpbmcoeyBtaW5MZW5ndGg6IDEwLCBtYXhMZW5ndGg6IDIwIH0pLFxyXG4gICAgICAgICAgICBjb21wYW55X2NvZGU6IGZjLnN0cmluZ09mKGZjLmludGVnZXIoeyBtaW46IDAsIG1heDogOSB9KSwgeyBtaW5MZW5ndGg6IDQsIG1heExlbmd0aDogNCB9KSxcclxuICAgICAgICAgICAgY29tcGFueV9uYW1lOiBmYy5zdHJpbmcoeyBtaW5MZW5ndGg6IDEsIG1heExlbmd0aDogMTAwIH0pLFxyXG4gICAgICAgICAgICBkaXNjbG9zdXJlX3R5cGU6IGZjLmNvbnN0YW50RnJvbSgn5rG6566X55+t5L+hJywgJ+acieS+oeiovOWIuOWgseWRiuabuCcsICfpganmmYLplovnpLonKSxcclxuICAgICAgICAgICAgdGl0bGU6IGZjLnN0cmluZyh7IG1pbkxlbmd0aDogMSwgbWF4TGVuZ3RoOiAyMDAgfSksXHJcbiAgICAgICAgICAgIGRpc2Nsb3NlZF9hdDogZmNcclxuICAgICAgICAgICAgICAuZGF0ZSh7IG1pbjogbmV3IERhdGUoJzIwMjAtMDEtMDEnKSwgbWF4OiBuZXcgRGF0ZSgnMjAyNS0xMi0zMScpIH0pXHJcbiAgICAgICAgICAgICAgLm1hcCgoZCkgPT4gZC50b0lTT1N0cmluZygpKSxcclxuICAgICAgICAgICAgcGRmX3VybDogZmMud2ViVXJsKCksXHJcbiAgICAgICAgICAgIHMzX2tleTogZmMuc3RyaW5nKHsgbWluTGVuZ3RoOiAxMCwgbWF4TGVuZ3RoOiAxMDAgfSksXHJcbiAgICAgICAgICAgIGNvbGxlY3RlZF9hdDogZmNcclxuICAgICAgICAgICAgICAuZGF0ZSh7IG1pbjogbmV3IERhdGUoJzIwMjAtMDEtMDEnKSwgbWF4OiBuZXcgRGF0ZSgnMjAyNS0xMi0zMScpIH0pXHJcbiAgICAgICAgICAgICAgLm1hcCgoZCkgPT4gZC50b0lTT1N0cmluZygpKSxcclxuICAgICAgICAgICAgZGF0ZV9wYXJ0aXRpb246IGZjXHJcbiAgICAgICAgICAgICAgLmRhdGUoeyBtaW46IG5ldyBEYXRlKCcyMDIwLTAxLTAxJyksIG1heDogbmV3IERhdGUoJzIwMjUtMTItMzEnKSB9KVxyXG4gICAgICAgICAgICAgIC5tYXAoKGQpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHllYXIgPSBkLmdldEZ1bGxZZWFyKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBtb250aCA9IFN0cmluZyhkLmdldE1vbnRoKCkgKyAxKS5wYWRTdGFydCgyLCAnMCcpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGAke3llYXJ9LSR7bW9udGh9YDtcclxuICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgeyBtaW5MZW5ndGg6IDAsIG1heExlbmd0aDogMTAgfVxyXG4gICAgICAgICksXHJcbiAgICAgICAgYXN5bmMgKGV4cG9ydF9pZCwgZm9ybWF0LCBkaXNjbG9zdXJlcykgPT4ge1xyXG4gICAgICAgICAgLy8gQWN0XHJcbiAgICAgICAgICBhd2FpdCBleHBvcnRUb1MzKGV4cG9ydF9pZCwgZGlzY2xvc3VyZXMgYXMgRGlzY2xvc3VyZVtdLCBmb3JtYXQpO1xyXG5cclxuICAgICAgICAgIC8vIEFzc2VydFxyXG4gICAgICAgICAgZXhwZWN0KHMzTW9jay5jYWxscygpKS50b0hhdmVMZW5ndGgoMSk7XHJcbiAgICAgICAgICBjb25zdCBjYWxsID0gczNNb2NrLmNhbGwoMCk7XHJcbiAgICAgICAgICBcclxuICAgICAgICAgIC8vIFB1dE9iamVjdENvbW1hbmTjga5pbnB1dOODl+ODreODkeODhuOCo+OBq+OCouOCr+OCu+OCuVxyXG4gICAgICAgICAgZXhwZWN0KGNhbGwuYXJnc1swXS5pbnB1dCkudG9CZURlZmluZWQoKTtcclxuICAgICAgICAgIGNvbnN0IGNvbnRlbnRUeXBlID0gY2FsbC5hcmdzWzBdLmlucHV0LkNvbnRlbnRUeXBlO1xyXG5cclxuICAgICAgICAgIC8vIFByb3BlcnR5OiBDb250ZW50VHlwZeOBjOato+OBl+OBj+ioreWumuOBleOCjOOBpuOBhOOCi1xyXG4gICAgICAgICAgY29uc3QgZXhwZWN0ZWRDb250ZW50VHlwZSA9IGZvcm1hdCA9PT0gJ2pzb24nID8gJ2FwcGxpY2F0aW9uL2pzb24nIDogJ3RleHQvY3N2JztcclxuICAgICAgICAgIGV4cGVjdChjb250ZW50VHlwZSkudG9CZShleHBlY3RlZENvbnRlbnRUeXBlKTtcclxuICAgICAgICB9XHJcbiAgICAgICksXHJcbiAgICAgIHtcclxuICAgICAgICBudW1SdW5zOiAxMDAsXHJcbiAgICAgICAgdmVyYm9zZTogdHJ1ZSxcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9KTtcclxuXHJcbiAgLyoqXHJcbiAgICogUHJvcGVydHk6IENTVuW9ouW8j+OBruWgtOWQiOOAgeOCq+ODs+ODnuOCkuWQq+OCgOWApOOBjOato+OBl+OBj+OCqOOCueOCseODvOODl+OBleOCjOOCi1xyXG4gICAqXHJcbiAgICog44GT44Gu44OX44Ot44OR44OG44Kj44Gv44CBQ1NW5b2i5byP44Gn44Ko44Kv44K544Od44O844OI44GZ44KL6Zqb44Gr44CBXHJcbiAgICog44Kr44Oz44Oe44KS5ZCr44KA5YCk44GM5q2j44GX44GP44OA44OW44Or44Kv44Kp44O844OI44Gn5Zuy44G+44KM44KL44GT44Go44KS5qSc6Ki844GX44G+44GZ44CCXHJcbiAgICovXHJcbiAgaXQoJ1Byb3BlcnR5OiBDU1blvaLlvI/jga7loLTlkIjjgIHjgqvjg7Pjg57jgpLlkKvjgoDlgKTjgYzmraPjgZfjgY/jgqjjgrnjgrHjg7zjg5fjgZXjgozjgosnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBhd2FpdCBmYy5hc3NlcnQoXHJcbiAgICAgIGZjLmFzeW5jUHJvcGVydHkoXHJcbiAgICAgICAgLy8gQXJiaXRyYXJ5OiDjgqjjgq/jgrnjg53jg7zjg4hJRFxyXG4gICAgICAgIGZjLnN0cmluZyh7IG1pbkxlbmd0aDogMTAsIG1heExlbmd0aDogNTAgfSksXHJcbiAgICAgICAgLy8gQXJiaXRyYXJ5OiDjgqvjg7Pjg57jgpLlkKvjgoDjgr/jgqTjg4jjg6tcclxuICAgICAgICBmYy5zdHJpbmcoeyBtaW5MZW5ndGg6IDEsIG1heExlbmd0aDogNTAgfSkubWFwKChzKSA9PiBgJHtzfSwg44Kr44Oz44Oe5ZCr44KAYCksXHJcbiAgICAgICAgYXN5bmMgKGV4cG9ydF9pZCwgdGl0bGVXaXRoQ29tbWEpID0+IHtcclxuICAgICAgICAgIC8vIEFycmFuZ2VcclxuICAgICAgICAgIGNvbnN0IGRpc2Nsb3N1cmVzOiBEaXNjbG9zdXJlW10gPSBbXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICBkaXNjbG9zdXJlX2lkOiAnMjAyNDAxMTVfMTIzNF8wMDEnLFxyXG4gICAgICAgICAgICAgIGNvbXBhbnlfY29kZTogJzEyMzQnLFxyXG4gICAgICAgICAgICAgIGNvbXBhbnlfbmFtZTogJ+ODhuOCueODiOagquW8j+S8muekvicsXHJcbiAgICAgICAgICAgICAgZGlzY2xvc3VyZV90eXBlOiAn5rG6566X55+t5L+hJyxcclxuICAgICAgICAgICAgICB0aXRsZTogdGl0bGVXaXRoQ29tbWEsXHJcbiAgICAgICAgICAgICAgZGlzY2xvc2VkX2F0OiAnMjAyNC0wMS0xNVQxMDozMDowMFonLFxyXG4gICAgICAgICAgICAgIHBkZl91cmw6ICdodHRwczovL2V4YW1wbGUuY29tL3BkZi8yMDI0MDExNV8xMjM0XzAwMS5wZGYnLFxyXG4gICAgICAgICAgICAgIHMzX2tleTogJ3BkZnMvMjAyNC8wMS8xNS8yMDI0MDExNV8xMjM0XzAwMS5wZGYnLFxyXG4gICAgICAgICAgICAgIGNvbGxlY3RlZF9hdDogJzIwMjQtMDEtMTVUMTA6MzU6MDBaJyxcclxuICAgICAgICAgICAgICBkYXRlX3BhcnRpdGlvbjogJzIwMjQtMDEnLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgXTtcclxuXHJcbiAgICAgICAgICAvLyBBcnJhbmdlXHJcbiAgICAgICAgICBzM01vY2sucmVzZXQoKTtcclxuICAgICAgICAgIHMzTW9jay5vbihQdXRPYmplY3RDb21tYW5kKS5yZXNvbHZlcyh7fSk7XHJcblxyXG4gICAgICAgICAgLy8gQWN0XHJcbiAgICAgICAgICBhd2FpdCBleHBvcnRUb1MzKGV4cG9ydF9pZCwgZGlzY2xvc3VyZXMsICdjc3YnKTtcclxuXHJcbiAgICAgICAgICAvLyBBc3NlcnRcclxuICAgICAgICAgIGV4cGVjdChzM01vY2suY2FsbHMoKSkudG9IYXZlTGVuZ3RoKDEpO1xyXG4gICAgICAgICAgY29uc3QgY2FsbCA9IHMzTW9jay5jYWxsKDApO1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBQdXRPYmplY3RDb21tYW5k44GuaW5wdXTjg5fjg63jg5Hjg4bjgqPjgavjgqLjgq/jgrvjgrlcclxuICAgICAgICAgIGV4cGVjdChjYWxsLmFyZ3NbMF0uaW5wdXQpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgICAgICBjb25zdCBib2R5ID0gY2FsbC5hcmdzWzBdLmlucHV0LkJvZHk7XHJcbiAgICAgICAgICBjb25zdCBsaW5lcyA9IGJvZHkuc3BsaXQoJ1xcbicpO1xyXG5cclxuICAgICAgICAgIC8vIFByb3BlcnR5OiDjgqvjg7Pjg57jgpLlkKvjgoDlgKTjgYzjg4Djg5bjg6vjgq/jgqnjg7zjg4jjgaflm7Ljgb7jgozjgabjgYTjgotcclxuICAgICAgICAgIGV4cGVjdChsaW5lc1sxXSkudG9Db250YWluKGBcIiR7dGl0bGVXaXRoQ29tbWF9XCJgKTtcclxuICAgICAgICB9XHJcbiAgICAgICksXHJcbiAgICAgIHtcclxuICAgICAgICBudW1SdW5zOiA1MCxcclxuICAgICAgICB2ZXJib3NlOiB0cnVlLFxyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH0pO1xyXG59KTtcclxuIl0sInZlcnNpb24iOjN9