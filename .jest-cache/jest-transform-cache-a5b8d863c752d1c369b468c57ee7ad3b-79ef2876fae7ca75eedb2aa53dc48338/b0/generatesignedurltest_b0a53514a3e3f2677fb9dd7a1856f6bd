ef20c762a477c109a825754ee312350e
"use strict";
/**
 * generate-signed-url.ts のユニットテスト
 *
 * ブランチカバレッジ目標: 80%以上
 * 現状: 40% (2/5ブランチ)
 * 目標: 80%+ (4/5ブランチ以上)
 */
Object.defineProperty(exports, "__esModule", { value: true });
// モック
jest.mock('@aws-sdk/client-s3');
jest.mock('@aws-sdk/s3-request-presigner');
jest.mock('../../../utils/logger');
const generate_signed_url_1 = require("../generate-signed-url");
const client_s3_1 = require("@aws-sdk/client-s3");
const s3_request_presigner_1 = require("@aws-sdk/s3-request-presigner");
const logger_1 = require("../../../utils/logger");
const errors_1 = require("../../../errors");
describe('generateSignedUrl', () => {
    const mockGetSignedUrl = s3_request_presigner_1.getSignedUrl;
    const mockLogger = logger_1.logger;
    beforeEach(() => {
        jest.clearAllMocks();
        // デフォルトのモック設定
        mockGetSignedUrl.mockResolvedValue('https://s3.amazonaws.com/signed-url');
        mockLogger.info = jest.fn();
        mockLogger.error = jest.fn();
    });
    describe('正常系', () => {
        it('署名付きURLを生成できること', async () => {
            const s3Key = 'exports/test-export.json';
            const expectedUrl = 'https://s3.amazonaws.com/signed-url';
            mockGetSignedUrl.mockResolvedValue(expectedUrl);
            const result = await (0, generate_signed_url_1.generateSignedUrl)(s3Key);
            expect(result).toBe(expectedUrl);
            expect(mockLogger.info).toHaveBeenCalledWith('Generating signed URL', {
                s3_key: s3Key,
                expires_in: 7 * 24 * 60 * 60,
            });
            expect(mockLogger.info).toHaveBeenCalledWith('Signed URL generated successfully', {
                s3_key: s3Key,
                signed_url: expectedUrl,
            });
        });
        it('カスタム有効期限で署名付きURLを生成できること', async () => {
            const s3Key = 'exports/test-export.json';
            const customExpiry = 3600; // 1時間
            const expectedUrl = 'https://s3.amazonaws.com/signed-url-custom';
            mockGetSignedUrl.mockResolvedValue(expectedUrl);
            const result = await (0, generate_signed_url_1.generateSignedUrl)(s3Key, customExpiry);
            expect(result).toBe(expectedUrl);
            expect(mockLogger.info).toHaveBeenCalledWith('Generating signed URL', {
                s3_key: s3Key,
                expires_in: customExpiry,
            });
        });
        it('デフォルト有効期限（7日間）が適用されること', async () => {
            const s3Key = 'exports/test-export.json';
            await (0, generate_signed_url_1.generateSignedUrl)(s3Key);
            expect(mockGetSignedUrl).toHaveBeenCalledWith(expect.any(client_s3_1.S3Client), expect.any(client_s3_1.GetObjectCommand), { expiresIn: 7 * 24 * 60 * 60 });
        });
    });
    describe('環境変数', () => {
        it('EXPORT_BUCKET_NAME環境変数がデフォルト値を持つこと', async () => {
            // デフォルト値 'tdnet-exports' が使用されることを確認
            const s3Key = 'test-key';
            await (0, generate_signed_url_1.generateSignedUrl)(s3Key);
            // GetObjectCommandが呼ばれたことを確認（バケット名はモジュール初期化時に決定）
            expect(mockGetSignedUrl).toHaveBeenCalled();
        });
        it('AWS_REGIONのデフォルト値が ap-northeast-1 であること', async () => {
            // S3Clientがデフォルトリージョンで初期化されることを確認
            const s3Key = 'test-key';
            await (0, generate_signed_url_1.generateSignedUrl)(s3Key);
            // 関数が正常に実行されることを確認
            expect(mockGetSignedUrl).toHaveBeenCalled();
        });
    });
    describe('エラーハンドリング', () => {
        it('getSignedUrlがエラーをスローした場合、RetryableErrorでラップされること', async () => {
            const s3Key = 'exports/test-export.json';
            const error = new Error('S3 access denied');
            mockGetSignedUrl.mockRejectedValue(error);
            await expect((0, generate_signed_url_1.generateSignedUrl)(s3Key)).rejects.toThrow(errors_1.RetryableError);
            await expect((0, generate_signed_url_1.generateSignedUrl)(s3Key)).rejects.toThrow('Failed to generate signed URL');
            // エラーログが記録されることを確認
            expect(mockLogger.error).toHaveBeenCalledWith('Failed to generate signed URL', {
                error_type: error.name,
                error_message: error.message,
                context: { s3_key: s3Key, expires_in: 7 * 24 * 60 * 60 },
                stack_trace: error.stack,
            });
        });
        it('S3Clientエラー時にRetryableErrorが伝播すること', async () => {
            const s3Key = 'exports/test-export.json';
            const error = new Error('Network error');
            mockGetSignedUrl.mockRejectedValue(error);
            await expect((0, generate_signed_url_1.generateSignedUrl)(s3Key)).rejects.toThrow(errors_1.RetryableError);
            // エラーログが記録されることを確認
            expect(mockLogger.error).toHaveBeenCalled();
        });
        it('無効なS3キーでもエラーハンドリングされること', async () => {
            const invalidKey = '';
            const error = new Error('Invalid S3 key');
            mockGetSignedUrl.mockRejectedValue(error);
            await expect((0, generate_signed_url_1.generateSignedUrl)(invalidKey)).rejects.toThrow(errors_1.RetryableError);
            // エラーログが記録されることを確認
            expect(mockLogger.error).toHaveBeenCalledWith('Failed to generate signed URL', {
                error_type: error.name,
                error_message: error.message,
                context: { s3_key: invalidKey, expires_in: 7 * 24 * 60 * 60 },
                stack_trace: error.stack,
            });
        });
        it('カスタム有効期限でエラーが発生した場合、contextに正しい値が記録されること', async () => {
            const s3Key = 'exports/test-export.json';
            const customExpiry = 3600;
            const error = new Error('S3 error');
            mockGetSignedUrl.mockRejectedValue(error);
            await expect((0, generate_signed_url_1.generateSignedUrl)(s3Key, customExpiry)).rejects.toThrow(errors_1.RetryableError);
            // エラーログのcontextに正しい有効期限が記録されることを確認
            expect(mockLogger.error).toHaveBeenCalledWith('Failed to generate signed URL', {
                error_type: error.name,
                error_message: error.message,
                context: { s3_key: s3Key, expires_in: customExpiry },
                stack_trace: error.stack,
            });
        });
    });
    describe('境界値テスト', () => {
        it('有効期限が0秒の場合でも処理できること', async () => {
            const s3Key = 'exports/test-export.json';
            const zeroExpiry = 0;
            await (0, generate_signed_url_1.generateSignedUrl)(s3Key, zeroExpiry);
            expect(mockGetSignedUrl).toHaveBeenCalledWith(expect.any(client_s3_1.S3Client), expect.any(client_s3_1.GetObjectCommand), { expiresIn: zeroExpiry });
        });
        it('有効期限が最大値（7日間）の場合でも処理できること', async () => {
            const s3Key = 'exports/test-export.json';
            const maxExpiry = 7 * 24 * 60 * 60;
            await (0, generate_signed_url_1.generateSignedUrl)(s3Key, maxExpiry);
            expect(mockGetSignedUrl).toHaveBeenCalledWith(expect.any(client_s3_1.S3Client), expect.any(client_s3_1.GetObjectCommand), { expiresIn: maxExpiry });
        });
        it('長いS3キーでも処理できること', async () => {
            const longKey = 'exports/' + 'a'.repeat(1000) + '.json';
            await (0, generate_signed_url_1.generateSignedUrl)(longKey);
            expect(mockGetSignedUrl).toHaveBeenCalled();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFx0aTE5OFxcaW52ZXN0bWVudF9hbmFseXNpc19vcG9wb1xcc3JjXFxsYW1iZGFcXGV4cG9ydFxcX190ZXN0c19fXFxnZW5lcmF0ZS1zaWduZWQtdXJsLnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7Ozs7R0FNRzs7QUFRSCxNQUFNO0FBQ04sSUFBSSxDQUFDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDO0FBQ2hDLElBQUksQ0FBQyxJQUFJLENBQUMsK0JBQStCLENBQUMsQ0FBQztBQUMzQyxJQUFJLENBQUMsSUFBSSxDQUFDLHVCQUF1QixDQUFDLENBQUM7QUFUbkMsZ0VBQTJEO0FBQzNELGtEQUFnRTtBQUNoRSx3RUFBNkQ7QUFDN0Qsa0RBQStDO0FBQy9DLDRDQUFpRDtBQU9qRCxRQUFRLENBQUMsbUJBQW1CLEVBQUUsR0FBRyxFQUFFO0lBQ2pDLE1BQU0sZ0JBQWdCLEdBQUcsbUNBQXdELENBQUM7SUFDbEYsTUFBTSxVQUFVLEdBQUcsZUFBb0MsQ0FBQztJQUV4RCxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsSUFBSSxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBRXJCLGNBQWM7UUFDZCxnQkFBZ0IsQ0FBQyxpQkFBaUIsQ0FBQyxxQ0FBcUMsQ0FBQyxDQUFDO1FBQzFFLFVBQVUsQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO1FBQzVCLFVBQVUsQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO0lBQy9CLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLEtBQUssRUFBRSxHQUFHLEVBQUU7UUFDbkIsRUFBRSxDQUFDLGlCQUFpQixFQUFFLEtBQUssSUFBSSxFQUFFO1lBQy9CLE1BQU0sS0FBSyxHQUFHLDBCQUEwQixDQUFDO1lBQ3pDLE1BQU0sV0FBVyxHQUFHLHFDQUFxQyxDQUFDO1lBRTFELGdCQUFnQixDQUFDLGlCQUFpQixDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBRWhELE1BQU0sTUFBTSxHQUFHLE1BQU0sSUFBQSx1Q0FBaUIsRUFBQyxLQUFLLENBQUMsQ0FBQztZQUU5QyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQ2pDLE1BQU0sQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsb0JBQW9CLENBQUMsdUJBQXVCLEVBQUU7Z0JBQ3BFLE1BQU0sRUFBRSxLQUFLO2dCQUNiLFVBQVUsRUFBRSxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFO2FBQzdCLENBQUMsQ0FBQztZQUNILE1BQU0sQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsb0JBQW9CLENBQUMsbUNBQW1DLEVBQUU7Z0JBQ2hGLE1BQU0sRUFBRSxLQUFLO2dCQUNiLFVBQVUsRUFBRSxXQUFXO2FBQ3hCLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDBCQUEwQixFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3hDLE1BQU0sS0FBSyxHQUFHLDBCQUEwQixDQUFDO1lBQ3pDLE1BQU0sWUFBWSxHQUFHLElBQUksQ0FBQyxDQUFDLE1BQU07WUFDakMsTUFBTSxXQUFXLEdBQUcsNENBQTRDLENBQUM7WUFFakUsZ0JBQWdCLENBQUMsaUJBQWlCLENBQUMsV0FBVyxDQUFDLENBQUM7WUFFaEQsTUFBTSxNQUFNLEdBQUcsTUFBTSxJQUFBLHVDQUFpQixFQUFDLEtBQUssRUFBRSxZQUFZLENBQUMsQ0FBQztZQUU1RCxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQ2pDLE1BQU0sQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUMsb0JBQW9CLENBQUMsdUJBQXVCLEVBQUU7Z0JBQ3BFLE1BQU0sRUFBRSxLQUFLO2dCQUNiLFVBQVUsRUFBRSxZQUFZO2FBQ3pCLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHdCQUF3QixFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3RDLE1BQU0sS0FBSyxHQUFHLDBCQUEwQixDQUFDO1lBRXpDLE1BQU0sSUFBQSx1Q0FBaUIsRUFBQyxLQUFLLENBQUMsQ0FBQztZQUUvQixNQUFNLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxvQkFBb0IsQ0FDM0MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxvQkFBUSxDQUFDLEVBQ3BCLE1BQU0sQ0FBQyxHQUFHLENBQUMsNEJBQWdCLENBQUMsRUFDNUIsRUFBRSxTQUFTLEVBQUUsQ0FBQyxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQ2hDLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLE1BQU0sRUFBRSxHQUFHLEVBQUU7UUFDcEIsRUFBRSxDQUFDLG9DQUFvQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2xELHFDQUFxQztZQUNyQyxNQUFNLEtBQUssR0FBRyxVQUFVLENBQUM7WUFFekIsTUFBTSxJQUFBLHVDQUFpQixFQUFDLEtBQUssQ0FBQyxDQUFDO1lBRS9CLGlEQUFpRDtZQUNqRCxNQUFNLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQzlDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlDQUF5QyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3ZELGtDQUFrQztZQUNsQyxNQUFNLEtBQUssR0FBRyxVQUFVLENBQUM7WUFFekIsTUFBTSxJQUFBLHVDQUFpQixFQUFDLEtBQUssQ0FBQyxDQUFDO1lBRS9CLG1CQUFtQjtZQUNuQixNQUFNLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQzlDLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsV0FBVyxFQUFFLEdBQUcsRUFBRTtRQUN6QixFQUFFLENBQUMsa0RBQWtELEVBQUUsS0FBSyxJQUFJLEVBQUU7WUFDaEUsTUFBTSxLQUFLLEdBQUcsMEJBQTBCLENBQUM7WUFDekMsTUFBTSxLQUFLLEdBQUcsSUFBSSxLQUFLLENBQUMsa0JBQWtCLENBQUMsQ0FBQztZQUU1QyxnQkFBZ0IsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUUxQyxNQUFNLE1BQU0sQ0FBQyxJQUFBLHVDQUFpQixFQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLE9BQU8sQ0FBQyx1QkFBYyxDQUFDLENBQUM7WUFDdkUsTUFBTSxNQUFNLENBQUMsSUFBQSx1Q0FBaUIsRUFBQyxLQUFLLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsK0JBQStCLENBQUMsQ0FBQztZQUV4RixtQkFBbUI7WUFDbkIsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQywrQkFBK0IsRUFBRTtnQkFDN0UsVUFBVSxFQUFFLEtBQUssQ0FBQyxJQUFJO2dCQUN0QixhQUFhLEVBQUUsS0FBSyxDQUFDLE9BQU87Z0JBQzVCLE9BQU8sRUFBRSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsVUFBVSxFQUFFLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRTtnQkFDeEQsV0FBVyxFQUFFLEtBQUssQ0FBQyxLQUFLO2FBQ3pCLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG9DQUFvQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ2xELE1BQU0sS0FBSyxHQUFHLDBCQUEwQixDQUFDO1lBQ3pDLE1BQU0sS0FBSyxHQUFHLElBQUksS0FBSyxDQUFDLGVBQWUsQ0FBQyxDQUFDO1lBRXpDLGdCQUFnQixDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRTFDLE1BQU0sTUFBTSxDQUFDLElBQUEsdUNBQWlCLEVBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLHVCQUFjLENBQUMsQ0FBQztZQUV2RSxtQkFBbUI7WUFDbkIsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxnQkFBZ0IsRUFBRSxDQUFDO1FBQzlDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLHlCQUF5QixFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3ZDLE1BQU0sVUFBVSxHQUFHLEVBQUUsQ0FBQztZQUN0QixNQUFNLEtBQUssR0FBRyxJQUFJLEtBQUssQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDO1lBRTFDLGdCQUFnQixDQUFDLGlCQUFpQixDQUFDLEtBQUssQ0FBQyxDQUFDO1lBRTFDLE1BQU0sTUFBTSxDQUFDLElBQUEsdUNBQWlCLEVBQUMsVUFBVSxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLHVCQUFjLENBQUMsQ0FBQztZQUU1RSxtQkFBbUI7WUFDbkIsTUFBTSxDQUFDLFVBQVUsQ0FBQyxLQUFLLENBQUMsQ0FBQyxvQkFBb0IsQ0FBQywrQkFBK0IsRUFBRTtnQkFDN0UsVUFBVSxFQUFFLEtBQUssQ0FBQyxJQUFJO2dCQUN0QixhQUFhLEVBQUUsS0FBSyxDQUFDLE9BQU87Z0JBQzVCLE9BQU8sRUFBRSxFQUFFLE1BQU0sRUFBRSxVQUFVLEVBQUUsVUFBVSxFQUFFLENBQUMsR0FBRyxFQUFFLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRTtnQkFDN0QsV0FBVyxFQUFFLEtBQUssQ0FBQyxLQUFLO2FBQ3pCLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDBDQUEwQyxFQUFFLEtBQUssSUFBSSxFQUFFO1lBQ3hELE1BQU0sS0FBSyxHQUFHLDBCQUEwQixDQUFDO1lBQ3pDLE1BQU0sWUFBWSxHQUFHLElBQUksQ0FBQztZQUMxQixNQUFNLEtBQUssR0FBRyxJQUFJLEtBQUssQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUVwQyxnQkFBZ0IsQ0FBQyxpQkFBaUIsQ0FBQyxLQUFLLENBQUMsQ0FBQztZQUUxQyxNQUFNLE1BQU0sQ0FBQyxJQUFBLHVDQUFpQixFQUFDLEtBQUssRUFBRSxZQUFZLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxPQUFPLENBQUMsdUJBQWMsQ0FBQyxDQUFDO1lBRXJGLG1DQUFtQztZQUNuQyxNQUFNLENBQUMsVUFBVSxDQUFDLEtBQUssQ0FBQyxDQUFDLG9CQUFvQixDQUFDLCtCQUErQixFQUFFO2dCQUM3RSxVQUFVLEVBQUUsS0FBSyxDQUFDLElBQUk7Z0JBQ3RCLGFBQWEsRUFBRSxLQUFLLENBQUMsT0FBTztnQkFDNUIsT0FBTyxFQUFFLEVBQUUsTUFBTSxFQUFFLEtBQUssRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUFFO2dCQUNwRCxXQUFXLEVBQUUsS0FBSyxDQUFDLEtBQUs7YUFDekIsQ0FBQyxDQUFDO1FBQ0wsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxRQUFRLEVBQUUsR0FBRyxFQUFFO1FBQ3RCLEVBQUUsQ0FBQyxxQkFBcUIsRUFBRSxLQUFLLElBQUksRUFBRTtZQUNuQyxNQUFNLEtBQUssR0FBRywwQkFBMEIsQ0FBQztZQUN6QyxNQUFNLFVBQVUsR0FBRyxDQUFDLENBQUM7WUFFckIsTUFBTSxJQUFBLHVDQUFpQixFQUFDLEtBQUssRUFBRSxVQUFVLENBQUMsQ0FBQztZQUUzQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxvQkFBb0IsQ0FDM0MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxvQkFBUSxDQUFDLEVBQ3BCLE1BQU0sQ0FBQyxHQUFHLENBQUMsNEJBQWdCLENBQUMsRUFDNUIsRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFLENBQzFCLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywyQkFBMkIsRUFBRSxLQUFLLElBQUksRUFBRTtZQUN6QyxNQUFNLEtBQUssR0FBRywwQkFBMEIsQ0FBQztZQUN6QyxNQUFNLFNBQVMsR0FBRyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLENBQUM7WUFFbkMsTUFBTSxJQUFBLHVDQUFpQixFQUFDLEtBQUssRUFBRSxTQUFTLENBQUMsQ0FBQztZQUUxQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsQ0FBQyxvQkFBb0IsQ0FDM0MsTUFBTSxDQUFDLEdBQUcsQ0FBQyxvQkFBUSxDQUFDLEVBQ3BCLE1BQU0sQ0FBQyxHQUFHLENBQUMsNEJBQWdCLENBQUMsRUFDNUIsRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFLENBQ3pCLENBQUM7UUFDSixDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQyxpQkFBaUIsRUFBRSxLQUFLLElBQUksRUFBRTtZQUMvQixNQUFNLE9BQU8sR0FBRyxVQUFVLEdBQUcsR0FBRyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxPQUFPLENBQUM7WUFFeEQsTUFBTSxJQUFBLHVDQUFpQixFQUFDLE9BQU8sQ0FBQyxDQUFDO1lBRWpDLE1BQU0sQ0FBQyxnQkFBZ0IsQ0FBQyxDQUFDLGdCQUFnQixFQUFFLENBQUM7UUFDOUMsQ0FBQyxDQUFDLENBQUM7SUFDTCxDQUFDLENBQUMsQ0FBQztBQUNMLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcdGkxOThcXGludmVzdG1lbnRfYW5hbHlzaXNfb3BvcG9cXHNyY1xcbGFtYmRhXFxleHBvcnRcXF9fdGVzdHNfX1xcZ2VuZXJhdGUtc2lnbmVkLXVybC50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBnZW5lcmF0ZS1zaWduZWQtdXJsLnRzIOOBruODpuODi+ODg+ODiOODhuOCueODiFxyXG4gKlxyXG4gKiDjg5bjg6njg7Pjg4Hjgqvjg5Djg6zjg4Pjgrjnm67mqJk6IDgwJeS7peS4ilxyXG4gKiDnj77nirY6IDQwJSAoMi8144OW44Op44Oz44OBKVxyXG4gKiDnm67mqJk6IDgwJSsgKDQvNeODluODqeODs+ODgeS7peS4iilcclxuICovXHJcblxyXG5pbXBvcnQgeyBnZW5lcmF0ZVNpZ25lZFVybCB9IGZyb20gJy4uL2dlbmVyYXRlLXNpZ25lZC11cmwnO1xyXG5pbXBvcnQgeyBTM0NsaWVudCwgR2V0T2JqZWN0Q29tbWFuZCB9IGZyb20gJ0Bhd3Mtc2RrL2NsaWVudC1zMyc7XHJcbmltcG9ydCB7IGdldFNpZ25lZFVybCB9IGZyb20gJ0Bhd3Mtc2RrL3MzLXJlcXVlc3QtcHJlc2lnbmVyJztcclxuaW1wb3J0IHsgbG9nZ2VyIH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvbG9nZ2VyJztcclxuaW1wb3J0IHsgUmV0cnlhYmxlRXJyb3IgfSBmcm9tICcuLi8uLi8uLi9lcnJvcnMnO1xyXG5cclxuLy8g44Oi44OD44KvXHJcbmplc3QubW9jaygnQGF3cy1zZGsvY2xpZW50LXMzJyk7XHJcbmplc3QubW9jaygnQGF3cy1zZGsvczMtcmVxdWVzdC1wcmVzaWduZXInKTtcclxuamVzdC5tb2NrKCcuLi8uLi8uLi91dGlscy9sb2dnZXInKTtcclxuXHJcbmRlc2NyaWJlKCdnZW5lcmF0ZVNpZ25lZFVybCcsICgpID0+IHtcclxuICBjb25zdCBtb2NrR2V0U2lnbmVkVXJsID0gZ2V0U2lnbmVkVXJsIGFzIGplc3QuTW9ja2VkRnVuY3Rpb248dHlwZW9mIGdldFNpZ25lZFVybD47XHJcbiAgY29uc3QgbW9ja0xvZ2dlciA9IGxvZ2dlciBhcyBqZXN0Lk1vY2tlZDx0eXBlb2YgbG9nZ2VyPjtcclxuXHJcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcclxuICAgIFxyXG4gICAgLy8g44OH44OV44Kp44Or44OI44Gu44Oi44OD44Kv6Kit5a6aXHJcbiAgICBtb2NrR2V0U2lnbmVkVXJsLm1vY2tSZXNvbHZlZFZhbHVlKCdodHRwczovL3MzLmFtYXpvbmF3cy5jb20vc2lnbmVkLXVybCcpO1xyXG4gICAgbW9ja0xvZ2dlci5pbmZvID0gamVzdC5mbigpO1xyXG4gICAgbW9ja0xvZ2dlci5lcnJvciA9IGplc3QuZm4oKTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ+ato+W4uOezuycsICgpID0+IHtcclxuICAgIGl0KCfnvbLlkI3ku5jjgY1VUkzjgpLnlJ/miJDjgafjgY3jgovjgZPjgagnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHMzS2V5ID0gJ2V4cG9ydHMvdGVzdC1leHBvcnQuanNvbic7XHJcbiAgICAgIGNvbnN0IGV4cGVjdGVkVXJsID0gJ2h0dHBzOi8vczMuYW1hem9uYXdzLmNvbS9zaWduZWQtdXJsJztcclxuICAgICAgXHJcbiAgICAgIG1vY2tHZXRTaWduZWRVcmwubW9ja1Jlc29sdmVkVmFsdWUoZXhwZWN0ZWRVcmwpO1xyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2VuZXJhdGVTaWduZWRVcmwoczNLZXkpO1xyXG5cclxuICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShleHBlY3RlZFVybCk7XHJcbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmluZm8pLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdHZW5lcmF0aW5nIHNpZ25lZCBVUkwnLCB7XHJcbiAgICAgICAgczNfa2V5OiBzM0tleSxcclxuICAgICAgICBleHBpcmVzX2luOiA3ICogMjQgKiA2MCAqIDYwLFxyXG4gICAgICB9KTtcclxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuaW5mbykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ1NpZ25lZCBVUkwgZ2VuZXJhdGVkIHN1Y2Nlc3NmdWxseScsIHtcclxuICAgICAgICBzM19rZXk6IHMzS2V5LFxyXG4gICAgICAgIHNpZ25lZF91cmw6IGV4cGVjdGVkVXJsLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCfjgqvjgrnjgr/jg6DmnInlirnmnJ/pmZDjgafnvbLlkI3ku5jjgY1VUkzjgpLnlJ/miJDjgafjgY3jgovjgZPjgagnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHMzS2V5ID0gJ2V4cG9ydHMvdGVzdC1leHBvcnQuanNvbic7XHJcbiAgICAgIGNvbnN0IGN1c3RvbUV4cGlyeSA9IDM2MDA7IC8vIDHmmYLplpNcclxuICAgICAgY29uc3QgZXhwZWN0ZWRVcmwgPSAnaHR0cHM6Ly9zMy5hbWF6b25hd3MuY29tL3NpZ25lZC11cmwtY3VzdG9tJztcclxuICAgICAgXHJcbiAgICAgIG1vY2tHZXRTaWduZWRVcmwubW9ja1Jlc29sdmVkVmFsdWUoZXhwZWN0ZWRVcmwpO1xyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2VuZXJhdGVTaWduZWRVcmwoczNLZXksIGN1c3RvbUV4cGlyeSk7XHJcblxyXG4gICAgICBleHBlY3QocmVzdWx0KS50b0JlKGV4cGVjdGVkVXJsKTtcclxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuaW5mbykudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ0dlbmVyYXRpbmcgc2lnbmVkIFVSTCcsIHtcclxuICAgICAgICBzM19rZXk6IHMzS2V5LFxyXG4gICAgICAgIGV4cGlyZXNfaW46IGN1c3RvbUV4cGlyeSxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgn44OH44OV44Kp44Or44OI5pyJ5Yq55pyf6ZmQ77yIN+aXpemWk++8ieOBjOmBqeeUqOOBleOCjOOCi+OBk+OBqCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgczNLZXkgPSAnZXhwb3J0cy90ZXN0LWV4cG9ydC5qc29uJztcclxuICAgICAgXHJcbiAgICAgIGF3YWl0IGdlbmVyYXRlU2lnbmVkVXJsKHMzS2V5KTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrR2V0U2lnbmVkVXJsKS50b0hhdmVCZWVuQ2FsbGVkV2l0aChcclxuICAgICAgICBleHBlY3QuYW55KFMzQ2xpZW50KSxcclxuICAgICAgICBleHBlY3QuYW55KEdldE9iamVjdENvbW1hbmQpLFxyXG4gICAgICAgIHsgZXhwaXJlc0luOiA3ICogMjQgKiA2MCAqIDYwIH1cclxuICAgICAgKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgn55Kw5aKD5aSJ5pWwJywgKCkgPT4ge1xyXG4gICAgaXQoJ0VYUE9SVF9CVUNLRVRfTkFNReeSsOWig+WkieaVsOOBjOODh+ODleOCqeODq+ODiOWApOOCkuaMgeOBpOOBk+OBqCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgLy8g44OH44OV44Kp44Or44OI5YCkICd0ZG5ldC1leHBvcnRzJyDjgYzkvb/nlKjjgZXjgozjgovjgZPjgajjgpLnorroqo1cclxuICAgICAgY29uc3QgczNLZXkgPSAndGVzdC1rZXknO1xyXG4gICAgICBcclxuICAgICAgYXdhaXQgZ2VuZXJhdGVTaWduZWRVcmwoczNLZXkpO1xyXG5cclxuICAgICAgLy8gR2V0T2JqZWN0Q29tbWFuZOOBjOWRvOOBsOOCjOOBn+OBk+OBqOOCkueiuuiqje+8iOODkOOCseODg+ODiOWQjeOBr+ODouOCuOODpeODvOODq+WIneacn+WMluaZguOBq+axuuWumu+8iVxyXG4gICAgICBleHBlY3QobW9ja0dldFNpZ25lZFVybCkudG9IYXZlQmVlbkNhbGxlZCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ0FXU19SRUdJT07jga7jg4fjg5Xjgqnjg6vjg4jlgKTjgYwgYXAtbm9ydGhlYXN0LTEg44Gn44GC44KL44GT44GoJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICAvLyBTM0NsaWVudOOBjOODh+ODleOCqeODq+ODiOODquODvOOCuOODp+ODs+OBp+WIneacn+WMluOBleOCjOOCi+OBk+OBqOOCkueiuuiqjVxyXG4gICAgICBjb25zdCBzM0tleSA9ICd0ZXN0LWtleSc7XHJcbiAgICAgIFxyXG4gICAgICBhd2FpdCBnZW5lcmF0ZVNpZ25lZFVybChzM0tleSk7XHJcblxyXG4gICAgICAvLyDplqLmlbDjgYzmraPluLjjgavlrp/ooYzjgZXjgozjgovjgZPjgajjgpLnorroqo1cclxuICAgICAgZXhwZWN0KG1vY2tHZXRTaWduZWRVcmwpLnRvSGF2ZUJlZW5DYWxsZWQoKTtcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgn44Ko44Op44O844OP44Oz44OJ44Oq44Oz44KwJywgKCkgPT4ge1xyXG4gICAgaXQoJ2dldFNpZ25lZFVybOOBjOOCqOODqeODvOOCkuOCueODreODvOOBl+OBn+WgtOWQiOOAgVJldHJ5YWJsZUVycm9y44Gn44Op44OD44OX44GV44KM44KL44GT44GoJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBzM0tleSA9ICdleHBvcnRzL3Rlc3QtZXhwb3J0Lmpzb24nO1xyXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignUzMgYWNjZXNzIGRlbmllZCcpO1xyXG4gICAgICBcclxuICAgICAgbW9ja0dldFNpZ25lZFVybC5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XHJcblxyXG4gICAgICBhd2FpdCBleHBlY3QoZ2VuZXJhdGVTaWduZWRVcmwoczNLZXkpKS5yZWplY3RzLnRvVGhyb3coUmV0cnlhYmxlRXJyb3IpO1xyXG4gICAgICBhd2FpdCBleHBlY3QoZ2VuZXJhdGVTaWduZWRVcmwoczNLZXkpKS5yZWplY3RzLnRvVGhyb3coJ0ZhaWxlZCB0byBnZW5lcmF0ZSBzaWduZWQgVVJMJyk7XHJcbiAgICAgIFxyXG4gICAgICAvLyDjgqjjg6njg7zjg63jgrDjgYzoqJjpjLLjgZXjgozjgovjgZPjgajjgpLnorroqo1cclxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuZXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdGYWlsZWQgdG8gZ2VuZXJhdGUgc2lnbmVkIFVSTCcsIHtcclxuICAgICAgICBlcnJvcl90eXBlOiBlcnJvci5uYW1lLFxyXG4gICAgICAgIGVycm9yX21lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICAgICAgY29udGV4dDogeyBzM19rZXk6IHMzS2V5LCBleHBpcmVzX2luOiA3ICogMjQgKiA2MCAqIDYwIH0sXHJcbiAgICAgICAgc3RhY2tfdHJhY2U6IGVycm9yLnN0YWNrLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdTM0NsaWVudOOCqOODqeODvOaZguOBq1JldHJ5YWJsZUVycm9y44GM5Lyd5pKt44GZ44KL44GT44GoJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBzM0tleSA9ICdleHBvcnRzL3Rlc3QtZXhwb3J0Lmpzb24nO1xyXG4gICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcignTmV0d29yayBlcnJvcicpO1xyXG4gICAgICBcclxuICAgICAgbW9ja0dldFNpZ25lZFVybC5tb2NrUmVqZWN0ZWRWYWx1ZShlcnJvcik7XHJcblxyXG4gICAgICBhd2FpdCBleHBlY3QoZ2VuZXJhdGVTaWduZWRVcmwoczNLZXkpKS5yZWplY3RzLnRvVGhyb3coUmV0cnlhYmxlRXJyb3IpO1xyXG4gICAgICBcclxuICAgICAgLy8g44Ko44Op44O844Ot44Kw44GM6KiY6Yyy44GV44KM44KL44GT44Go44KS56K66KqNXHJcbiAgICAgIGV4cGVjdChtb2NrTG9nZ2VyLmVycm9yKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgn54Sh5Yq544GqUzPjgq3jg7zjgafjgoLjgqjjg6njg7zjg4/jg7Pjg4njg6rjg7PjgrDjgZXjgozjgovjgZPjgagnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGludmFsaWRLZXkgPSAnJztcclxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ0ludmFsaWQgUzMga2V5Jyk7XHJcbiAgICAgIFxyXG4gICAgICBtb2NrR2V0U2lnbmVkVXJsLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKTtcclxuXHJcbiAgICAgIGF3YWl0IGV4cGVjdChnZW5lcmF0ZVNpZ25lZFVybChpbnZhbGlkS2V5KSkucmVqZWN0cy50b1Rocm93KFJldHJ5YWJsZUVycm9yKTtcclxuICAgICAgXHJcbiAgICAgIC8vIOOCqOODqeODvOODreOCsOOBjOiomOmMsuOBleOCjOOCi+OBk+OBqOOCkueiuuiqjVxyXG4gICAgICBleHBlY3QobW9ja0xvZ2dlci5lcnJvcikudG9IYXZlQmVlbkNhbGxlZFdpdGgoJ0ZhaWxlZCB0byBnZW5lcmF0ZSBzaWduZWQgVVJMJywge1xyXG4gICAgICAgIGVycm9yX3R5cGU6IGVycm9yLm5hbWUsXHJcbiAgICAgICAgZXJyb3JfbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcclxuICAgICAgICBjb250ZXh0OiB7IHMzX2tleTogaW52YWxpZEtleSwgZXhwaXJlc19pbjogNyAqIDI0ICogNjAgKiA2MCB9LFxyXG4gICAgICAgIHN0YWNrX3RyYWNlOiBlcnJvci5zdGFjayxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgn44Kr44K544K/44Og5pyJ5Yq55pyf6ZmQ44Gn44Ko44Op44O844GM55m655Sf44GX44Gf5aC05ZCI44CBY29udGV4dOOBq+ato+OBl+OBhOWApOOBjOiomOmMsuOBleOCjOOCi+OBk+OBqCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgczNLZXkgPSAnZXhwb3J0cy90ZXN0LWV4cG9ydC5qc29uJztcclxuICAgICAgY29uc3QgY3VzdG9tRXhwaXJ5ID0gMzYwMDtcclxuICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoJ1MzIGVycm9yJyk7XHJcbiAgICAgIFxyXG4gICAgICBtb2NrR2V0U2lnbmVkVXJsLm1vY2tSZWplY3RlZFZhbHVlKGVycm9yKTtcclxuXHJcbiAgICAgIGF3YWl0IGV4cGVjdChnZW5lcmF0ZVNpZ25lZFVybChzM0tleSwgY3VzdG9tRXhwaXJ5KSkucmVqZWN0cy50b1Rocm93KFJldHJ5YWJsZUVycm9yKTtcclxuICAgICAgXHJcbiAgICAgIC8vIOOCqOODqeODvOODreOCsOOBrmNvbnRleHTjgavmraPjgZfjgYTmnInlirnmnJ/pmZDjgYzoqJjpjLLjgZXjgozjgovjgZPjgajjgpLnorroqo1cclxuICAgICAgZXhwZWN0KG1vY2tMb2dnZXIuZXJyb3IpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKCdGYWlsZWQgdG8gZ2VuZXJhdGUgc2lnbmVkIFVSTCcsIHtcclxuICAgICAgICBlcnJvcl90eXBlOiBlcnJvci5uYW1lLFxyXG4gICAgICAgIGVycm9yX21lc3NhZ2U6IGVycm9yLm1lc3NhZ2UsXHJcbiAgICAgICAgY29udGV4dDogeyBzM19rZXk6IHMzS2V5LCBleHBpcmVzX2luOiBjdXN0b21FeHBpcnkgfSxcclxuICAgICAgICBzdGFja190cmFjZTogZXJyb3Iuc3RhY2ssXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCflooPnlYzlgKTjg4bjgrnjg4gnLCAoKSA9PiB7XHJcbiAgICBpdCgn5pyJ5Yq55pyf6ZmQ44GMMOenkuOBruWgtOWQiOOBp+OCguWHpueQhuOBp+OBjeOCi+OBk+OBqCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgczNLZXkgPSAnZXhwb3J0cy90ZXN0LWV4cG9ydC5qc29uJztcclxuICAgICAgY29uc3QgemVyb0V4cGlyeSA9IDA7XHJcbiAgICAgIFxyXG4gICAgICBhd2FpdCBnZW5lcmF0ZVNpZ25lZFVybChzM0tleSwgemVyb0V4cGlyeSk7XHJcblxyXG4gICAgICBleHBlY3QobW9ja0dldFNpZ25lZFVybCkudG9IYXZlQmVlbkNhbGxlZFdpdGgoXHJcbiAgICAgICAgZXhwZWN0LmFueShTM0NsaWVudCksXHJcbiAgICAgICAgZXhwZWN0LmFueShHZXRPYmplY3RDb21tYW5kKSxcclxuICAgICAgICB7IGV4cGlyZXNJbjogemVyb0V4cGlyeSB9XHJcbiAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgn5pyJ5Yq55pyf6ZmQ44GM5pyA5aSn5YCk77yIN+aXpemWk++8ieOBruWgtOWQiOOBp+OCguWHpueQhuOBp+OBjeOCi+OBk+OBqCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgczNLZXkgPSAnZXhwb3J0cy90ZXN0LWV4cG9ydC5qc29uJztcclxuICAgICAgY29uc3QgbWF4RXhwaXJ5ID0gNyAqIDI0ICogNjAgKiA2MDtcclxuICAgICAgXHJcbiAgICAgIGF3YWl0IGdlbmVyYXRlU2lnbmVkVXJsKHMzS2V5LCBtYXhFeHBpcnkpO1xyXG5cclxuICAgICAgZXhwZWN0KG1vY2tHZXRTaWduZWRVcmwpLnRvSGF2ZUJlZW5DYWxsZWRXaXRoKFxyXG4gICAgICAgIGV4cGVjdC5hbnkoUzNDbGllbnQpLFxyXG4gICAgICAgIGV4cGVjdC5hbnkoR2V0T2JqZWN0Q29tbWFuZCksXHJcbiAgICAgICAgeyBleHBpcmVzSW46IG1heEV4cGlyeSB9XHJcbiAgICAgICk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgn6ZW344GEUzPjgq3jg7zjgafjgoLlh6bnkIbjgafjgY3jgovjgZPjgagnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGxvbmdLZXkgPSAnZXhwb3J0cy8nICsgJ2EnLnJlcGVhdCgxMDAwKSArICcuanNvbic7XHJcbiAgICAgIFxyXG4gICAgICBhd2FpdCBnZW5lcmF0ZVNpZ25lZFVybChsb25nS2V5KTtcclxuXHJcbiAgICAgIGV4cGVjdChtb2NrR2V0U2lnbmVkVXJsKS50b0hhdmVCZWVuQ2FsbGVkKCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7XHJcbiJdLCJ2ZXJzaW9uIjozfQ==