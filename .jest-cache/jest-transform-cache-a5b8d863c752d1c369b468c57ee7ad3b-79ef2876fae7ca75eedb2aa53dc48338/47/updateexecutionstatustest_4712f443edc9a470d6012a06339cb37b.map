{"file":"C:\\Users\\ti198\\investment_analysis_opopo\\src\\lambda\\collector\\__tests__\\update-execution-status.test.ts","mappings":"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","names":[],"sources":["C:\\Users\\ti198\\investment_analysis_opopo\\src\\lambda\\collector\\__tests__\\update-execution-status.test.ts"],"sourcesContent":["/**\r\n * updateExecutionStatus関数のユニットテスト\r\n *\r\n * Requirements: 要件5.4（実行状態管理）\r\n */\r\n\r\nimport { DynamoDBClient, PutItemCommand, GetItemCommand } from '@aws-sdk/client-dynamodb';\r\nimport { mockClient } from 'aws-sdk-client-mock';\r\nimport { updateExecutionStatus, getExecutionStatus } from '../update-execution-status';\r\n\r\nconst dynamoMock = mockClient(DynamoDBClient);\r\n\r\ndescribe('updateExecutionStatus', () => {\r\n  const originalEnv = process.env.DYNAMODB_EXECUTIONS_TABLE;\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    dynamoMock.reset();\r\n    process.env.DYNAMODB_EXECUTIONS_TABLE = 'test-executions-table';\r\n  });\r\n\r\n  afterEach(() => {\r\n    process.env.DYNAMODB_EXECUTIONS_TABLE = originalEnv;\r\n  });\r\n\r\n  describe('正常系', () => {\r\n    it('実行状態を作成できる（pending）', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_001';\r\n      dynamoMock.on(PutItemCommand).resolves({});\r\n\r\n      // Act\r\n      const result = await updateExecutionStatus(execution_id, 'pending', 0);\r\n\r\n      // Assert\r\n      expect(result).toMatchObject({\r\n        execution_id: 'exec_001',\r\n        status: 'pending',\r\n        progress: 0,\r\n        collected_count: 0,\r\n        failed_count: 0,\r\n      });\r\n      expect(result.started_at).toBeDefined();\r\n      expect(result.updated_at).toBeDefined();\r\n      expect(result.completed_at).toBeUndefined();\r\n      expect(result.ttl).toBeUndefined();\r\n      expect(dynamoMock.calls()).toHaveLength(1);\r\n    });\r\n\r\n    it('実行状態を更新できる（running）', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_001';\r\n      dynamoMock.on(PutItemCommand).resolves({});\r\n\r\n      // Act\r\n      const result = await updateExecutionStatus(execution_id, 'running', 50, 25, 0);\r\n\r\n      // Assert\r\n      expect(result).toMatchObject({\r\n        execution_id: 'exec_001',\r\n        status: 'running',\r\n        progress: 50,\r\n        collected_count: 25,\r\n        failed_count: 0,\r\n      });\r\n      expect(result.completed_at).toBeUndefined();\r\n      expect(result.ttl).toBeUndefined();\r\n    });\r\n\r\n    it('実行状態を完了にできる（completed）', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_001';\r\n      dynamoMock.on(PutItemCommand).resolves({});\r\n\r\n      // Act\r\n      const result = await updateExecutionStatus(execution_id, 'completed', 100, 50, 0);\r\n\r\n      // Assert\r\n      expect(result).toMatchObject({\r\n        execution_id: 'exec_001',\r\n        status: 'completed',\r\n        progress: 100,\r\n        collected_count: 50,\r\n        failed_count: 0,\r\n      });\r\n      expect(result.completed_at).toBeDefined();\r\n      expect(result.ttl).toBeDefined();\r\n      expect(result.error_message).toBeUndefined();\r\n    });\r\n\r\n    it('実行状態を失敗にできる（failed）', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_001';\r\n      const error_message = 'Network error occurred';\r\n      dynamoMock.on(PutItemCommand).resolves({});\r\n\r\n      // Act\r\n      const result = await updateExecutionStatus(\r\n        execution_id,\r\n        'failed',\r\n        50,\r\n        25,\r\n        5,\r\n        error_message\r\n      );\r\n\r\n      // Assert\r\n      expect(result).toMatchObject({\r\n        execution_id: 'exec_001',\r\n        status: 'failed',\r\n        progress: 50,\r\n        collected_count: 25,\r\n        failed_count: 5,\r\n        error_message: 'Network error occurred',\r\n      });\r\n      expect(result.completed_at).toBeDefined();\r\n      expect(result.ttl).toBeDefined();\r\n    });\r\n\r\n    it('進捗率を0-100の範囲に制限する（負の値）', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_001';\r\n      dynamoMock.on(PutItemCommand).resolves({});\r\n\r\n      // Act\r\n      const result = await updateExecutionStatus(execution_id, 'running', -10);\r\n\r\n      // Assert\r\n      expect(result.progress).toBe(0);\r\n    });\r\n\r\n    it('進捗率を0-100の範囲に制限する（100超過）', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_001';\r\n      dynamoMock.on(PutItemCommand).resolves({});\r\n\r\n      // Act\r\n      const result = await updateExecutionStatus(execution_id, 'running', 150);\r\n\r\n      // Assert\r\n      expect(result.progress).toBe(100);\r\n    });\r\n\r\n    it('TTLが30日後に設定される（completed）', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_001';\r\n      dynamoMock.on(PutItemCommand).resolves({});\r\n      const beforeTime = Math.floor(Date.now() / 1000) + 30 * 24 * 60 * 60;\r\n\r\n      // Act\r\n      const result = await updateExecutionStatus(execution_id, 'completed', 100);\r\n\r\n      const afterTime = Math.floor(Date.now() / 1000) + 30 * 24 * 60 * 60;\r\n\r\n      // Assert\r\n      expect(result.ttl).toBeDefined();\r\n      expect(result.ttl!).toBeGreaterThanOrEqual(beforeTime - 1);\r\n      expect(result.ttl!).toBeLessThanOrEqual(afterTime + 1);\r\n    });\r\n\r\n    it('TTLが30日後に設定される（failed）', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_001';\r\n      dynamoMock.on(PutItemCommand).resolves({});\r\n      const beforeTime = Math.floor(Date.now() / 1000) + 30 * 24 * 60 * 60;\r\n\r\n      // Act\r\n      const result = await updateExecutionStatus(execution_id, 'failed', 50, 0, 0, 'Error');\r\n\r\n      const afterTime = Math.floor(Date.now() / 1000) + 30 * 24 * 60 * 60;\r\n\r\n      // Assert\r\n      expect(result.ttl).toBeDefined();\r\n      expect(result.ttl!).toBeGreaterThanOrEqual(beforeTime - 1);\r\n      expect(result.ttl!).toBeLessThanOrEqual(afterTime + 1);\r\n    });\r\n\r\n    it('環境変数が未設定の場合、デフォルト値を使用する', async () => {\r\n      // Arrange\r\n      delete process.env.DYNAMODB_EXECUTIONS_TABLE;\r\n      const execution_id = 'exec_001';\r\n      dynamoMock.on(PutItemCommand).resolves({});\r\n\r\n      // Act\r\n      await updateExecutionStatus(execution_id, 'pending', 0);\r\n\r\n      // Assert\r\n      const input = dynamoMock.call(0).args[0].input as any;\r\n      expect(input.TableName).toBe('tdnet_executions');\r\n    });\r\n  });\r\n\r\n  describe('異常系', () => {\r\n    it('DynamoDBエラーで失敗する', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_001';\r\n      dynamoMock.on(PutItemCommand).rejects(new Error('DynamoDB error'));\r\n\r\n      // Act & Assert\r\n      await expect(updateExecutionStatus(execution_id, 'pending', 0)).rejects.toThrow(\r\n        'DynamoDB error'\r\n      );\r\n    });\r\n\r\n    it('エラーメッセージなしでfailedステータスを設定できる', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_001';\r\n      dynamoMock.on(PutItemCommand).resolves({});\r\n\r\n      // Act\r\n      const result = await updateExecutionStatus(execution_id, 'failed', 50, 25, 5);\r\n\r\n      // Assert\r\n      expect(result.status).toBe('failed');\r\n      expect(result.error_message).toBeUndefined();\r\n      expect(result.completed_at).toBeDefined();\r\n      expect(result.ttl).toBeDefined();\r\n    });\r\n  });\r\n\r\n  describe('エッジケース', () => {\r\n    it('進捗率が0の場合', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_001';\r\n      dynamoMock.on(PutItemCommand).resolves({});\r\n\r\n      // Act\r\n      const result = await updateExecutionStatus(execution_id, 'pending', 0);\r\n\r\n      // Assert\r\n      expect(result.progress).toBe(0);\r\n    });\r\n\r\n    it('進捗率が100の場合', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_001';\r\n      dynamoMock.on(PutItemCommand).resolves({});\r\n\r\n      // Act\r\n      const result = await updateExecutionStatus(execution_id, 'completed', 100);\r\n\r\n      // Assert\r\n      expect(result.progress).toBe(100);\r\n    });\r\n\r\n    it('collected_countとfailed_countが0の場合', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_001';\r\n      dynamoMock.on(PutItemCommand).resolves({});\r\n\r\n      // Act\r\n      const result = await updateExecutionStatus(execution_id, 'pending', 0, 0, 0);\r\n\r\n      // Assert\r\n      expect(result.collected_count).toBe(0);\r\n      expect(result.failed_count).toBe(0);\r\n    });\r\n\r\n    it('collected_countとfailed_countが大きい値の場合', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_001';\r\n      dynamoMock.on(PutItemCommand).resolves({});\r\n\r\n      // Act\r\n      const result = await updateExecutionStatus(execution_id, 'completed', 100, 1000, 50);\r\n\r\n      // Assert\r\n      expect(result.collected_count).toBe(1000);\r\n      expect(result.failed_count).toBe(50);\r\n    });\r\n  });\r\n});\r\n\r\ndescribe('getExecutionStatus', () => {\r\n  const originalEnv = process.env.DYNAMODB_EXECUTIONS_TABLE;\r\n\r\n  beforeEach(() => {\r\n    jest.clearAllMocks();\r\n    dynamoMock.reset();\r\n    process.env.DYNAMODB_EXECUTIONS_TABLE = 'test-executions-table';\r\n  });\r\n\r\n  afterEach(() => {\r\n    process.env.DYNAMODB_EXECUTIONS_TABLE = originalEnv;\r\n  });\r\n\r\n  describe('正常系', () => {\r\n    it('実行状態を取得できる', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_001';\r\n      dynamoMock.on(GetItemCommand).resolves({\r\n        Item: {\r\n          execution_id: { S: 'exec_001' },\r\n          status: { S: 'running' },\r\n          progress: { N: '50' },\r\n          collected_count: { N: '25' },\r\n          failed_count: { N: '0' },\r\n          started_at: { S: '2024-01-15T10:30:00Z' },\r\n          updated_at: { S: '2024-01-15T10:35:00Z' },\r\n        },\r\n      });\r\n\r\n      // Act\r\n      const result = await getExecutionStatus(execution_id);\r\n\r\n      // Assert\r\n      expect(result).toMatchObject({\r\n        execution_id: 'exec_001',\r\n        status: 'running',\r\n        progress: 50,\r\n        collected_count: 25,\r\n        failed_count: 0,\r\n      });\r\n      expect(dynamoMock.calls()).toHaveLength(1);\r\n    });\r\n\r\n    it('存在しない実行IDの場合、nullを返す', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_999';\r\n      dynamoMock.on(GetItemCommand).resolves({});\r\n\r\n      // Act\r\n      const result = await getExecutionStatus(execution_id);\r\n\r\n      // Assert\r\n      expect(result).toBeNull();\r\n    });\r\n  });\r\n\r\n  describe('異常系', () => {\r\n    it('DynamoDBエラーで失敗する', async () => {\r\n      // Arrange\r\n      const execution_id = 'exec_001';\r\n      dynamoMock.on(GetItemCommand).rejects(new Error('DynamoDB error'));\r\n\r\n      // Act & Assert\r\n      await expect(getExecutionStatus(execution_id)).rejects.toThrow('DynamoDB error');\r\n    });\r\n  });\r\n});\r\n"],"version":3}