8a0cbb0acd7eb1fe2623f1b4140761f0
"use strict";
/**
 * Date Range Validation Property Tests
 *
 * Property 8: 日付範囲の順序性
 * Validates: Requirements 5.2
 *
 * 開始日が終了日より後の場合はバリデーションエラーを返すことを検証
 *
 * Requirements: 要件14.2（プロパティテスト）
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
// モック
jest.mock('../query-disclosures');
jest.mock('../format-csv');
jest.mock('../../../utils/logger');
jest.mock('../../../utils/cloudwatch-metrics');
const fc = __importStar(require("fast-check"));
const handler_1 = require("../handler");
const client_secrets_manager_1 = require("@aws-sdk/client-secrets-manager");
const aws_sdk_client_mock_1 = require("aws-sdk-client-mock");
// Secrets Managerモック
const secretsManagerMock = (0, aws_sdk_client_mock_1.mockClient)(client_secrets_manager_1.SecretsManagerClient);
describe('Property 8: 日付範囲の順序性', () => {
    let mockContext;
    let baseEvent;
    beforeEach(() => {
        // Secrets Managerモックのセットアップ
        secretsManagerMock.reset();
        secretsManagerMock.on(client_secrets_manager_1.GetSecretValueCommand).resolves({
            SecretString: 'test-api-key',
        });
        // モックコンテキスト
        mockContext = {
            awsRequestId: 'test-request-id',
            functionName: 'tdnet-query',
            functionVersion: '1',
            invokedFunctionArn: 'arn:aws:lambda:ap-northeast-1:123456789012:function:tdnet-query',
            memoryLimitInMB: '256',
            logGroupName: '/aws/lambda/tdnet-query',
            logStreamName: '2024/01/15/[$LATEST]abcdef',
            getRemainingTimeInMillis: () => 30000,
            callbackWaitsForEmptyEventLoop: true,
            done: jest.fn(),
            fail: jest.fn(),
            succeed: jest.fn(),
        };
        // ベースイベント
        baseEvent = {
            body: null,
            headers: {
                'x-api-key': 'test-api-key',
            },
            multiValueHeaders: {},
            httpMethod: 'GET',
            isBase64Encoded: false,
            path: '/disclosures',
            pathParameters: null,
            queryStringParameters: null,
            multiValueQueryStringParameters: null,
            stageVariables: null,
            requestContext: {
                accountId: '123456789012',
                apiId: 'test-api-id',
                protocol: 'HTTP/1.1',
                httpMethod: 'GET',
                path: '/disclosures',
                stage: 'prod',
                requestId: 'test-request-id',
                requestTime: '15/Jan/2024:10:30:00 +0000',
                requestTimeEpoch: 1705315800000,
                identity: {
                    accessKey: null,
                    accountId: null,
                    apiKey: null,
                    apiKeyId: null,
                    caller: null,
                    clientCert: null,
                    cognitoAuthenticationProvider: null,
                    cognitoAuthenticationType: null,
                    cognitoIdentityId: null,
                    cognitoIdentityPoolId: null,
                    principalOrgId: null,
                    sourceIp: '192.168.1.1',
                    user: null,
                    userAgent: 'Mozilla/5.0',
                    userArn: null,
                },
                authorizer: null,
                domainName: 'api.example.com',
                domainPrefix: 'api',
                resourceId: 'test-resource-id',
                resourcePath: '/disclosures',
            },
            resource: '/disclosures',
        };
        // 環境変数設定
        process.env.API_KEY = 'test-api-key';
        process.env.DYNAMODB_TABLE_NAME = 'tdnet_disclosures';
        process.env.S3_BUCKET_NAME = 'tdnet-pdfs';
        jest.clearAllMocks();
    });
    /**
     * 日付文字列生成（YYYY-MM-DD形式）
     */
    const dateArbitrary = fc.date({
        min: new Date('2020-01-01'),
        max: new Date('2025-12-31'),
    }).map((date) => {
        const year = date.getFullYear();
        const month = String(date.getMonth() + 1).padStart(2, '0');
        const day = String(date.getDate()).padStart(2, '0');
        return `${year}-${month}-${day}`;
    });
    it('Property 8.1: 開始日が終了日より後の場合は必ずバリデーションエラー', async () => {
        await fc.assert(fc.asyncProperty(dateArbitrary, dateArbitrary, async (date1, date2) => {
            // date1 > date2 となるペアのみテスト
            if (date1 <= date2) {
                return true; // スキップ
            }
            const event = {
                ...baseEvent,
                queryStringParameters: {
                    start_date: date1, // 後の日付
                    end_date: date2, // 前の日付
                },
            };
            const result = await (0, handler_1.handler)(event, mockContext);
            // バリデーションエラー（400）が返されることを確認
            expect(result.statusCode).toBe(400);
            const body = JSON.parse(result.body);
            expect(body.error_code).toBe('VALIDATION_ERROR');
            expect(body.message).toContain('start_date');
            expect(body.message).toContain('must be before or equal to');
            expect(body.message).toContain('end_date');
            return true;
        }), { numRuns: 100 } // 100回反復実行
        );
    });
    it('Property 8.2: 開始日が終了日と同じ場合は成功', async () => {
        await fc.assert(fc.asyncProperty(dateArbitrary, async (date) => {
            const event = {
                ...baseEvent,
                queryStringParameters: {
                    start_date: date,
                    end_date: date, // 同じ日付
                },
            };
            const result = await (0, handler_1.handler)(event, mockContext);
            // バリデーションエラーではないことを確認（200または500）
            expect(result.statusCode).not.toBe(400);
            return true;
        }), { numRuns: 100 });
    });
    it('Property 8.3: 開始日が終了日より前の場合は成功', async () => {
        await fc.assert(fc.asyncProperty(dateArbitrary, dateArbitrary, async (date1, date2) => {
            // date1 < date2 となるペアのみテスト
            if (date1 >= date2) {
                return true; // スキップ
            }
            const event = {
                ...baseEvent,
                queryStringParameters: {
                    start_date: date1, // 前の日付
                    end_date: date2, // 後の日付
                },
            };
            const result = await (0, handler_1.handler)(event, mockContext);
            // バリデーションエラーではないことを確認
            expect(result.statusCode).not.toBe(400);
            return true;
        }), { numRuns: 100 });
    });
    describe('エッジケース', () => {
        it('月またぎの日付範囲', async () => {
            const event = {
                ...baseEvent,
                queryStringParameters: {
                    start_date: '2024-01-31',
                    end_date: '2024-02-01',
                },
            };
            const result = await (0, handler_1.handler)(event, mockContext);
            // バリデーションエラーではないことを確認
            expect(result.statusCode).not.toBe(400);
        });
        it('年またぎの日付範囲', async () => {
            const event = {
                ...baseEvent,
                queryStringParameters: {
                    start_date: '2023-12-31',
                    end_date: '2024-01-01',
                },
            };
            const result = await (0, handler_1.handler)(event, mockContext);
            // バリデーションエラーではないことを確認
            expect(result.statusCode).not.toBe(400);
        });
        it('うるう年の2月29日', async () => {
            const event = {
                ...baseEvent,
                queryStringParameters: {
                    start_date: '2024-02-29', // うるう年
                    end_date: '2024-03-01',
                },
            };
            const result = await (0, handler_1.handler)(event, mockContext);
            // バリデーションエラーではないことを確認
            expect(result.statusCode).not.toBe(400);
        });
        it('非うるう年の2月29日はバリデーションエラー', async () => {
            const event = {
                ...baseEvent,
                queryStringParameters: {
                    start_date: '2023-02-29', // 非うるう年
                    end_date: '2023-03-01',
                },
            };
            const result = await (0, handler_1.handler)(event, mockContext);
            // バリデーションエラー（存在しない日付）
            expect(result.statusCode).toBe(400);
            const body = JSON.parse(result.body);
            expect(body.error_code).toBe('VALIDATION_ERROR');
            expect(body.message).toContain('Date does not exist');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFx0aTE5OFxcaW52ZXN0bWVudF9hbmFseXNpc19vcG9wb1xcc3JjXFxsYW1iZGFcXHF1ZXJ5XFxfX3Rlc3RzX19cXGRhdGUtcmFuZ2UtdmFsaWRhdGlvbi5wcm9wZXJ0eS50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7O0dBU0c7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBUUgsTUFBTTtBQUNOLElBQUksQ0FBQyxJQUFJLENBQUMsc0JBQXNCLENBQUMsQ0FBQztBQUNsQyxJQUFJLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBQzNCLElBQUksQ0FBQyxJQUFJLENBQUMsdUJBQXVCLENBQUMsQ0FBQztBQUNuQyxJQUFJLENBQUMsSUFBSSxDQUFDLG1DQUFtQyxDQUFDLENBQUM7QUFWL0MsK0NBQWlDO0FBRWpDLHdDQUFxQztBQUNyQyw0RUFBOEY7QUFDOUYsNkRBQWlEO0FBUWpELHFCQUFxQjtBQUNyQixNQUFNLGtCQUFrQixHQUFHLElBQUEsZ0NBQVUsRUFBQyw2Q0FBb0IsQ0FBQyxDQUFDO0FBRTVELFFBQVEsQ0FBQyxzQkFBc0IsRUFBRSxHQUFHLEVBQUU7SUFDcEMsSUFBSSxXQUFvQixDQUFDO0lBQ3pCLElBQUksU0FBK0IsQ0FBQztJQUVwQyxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ2QsNEJBQTRCO1FBQzVCLGtCQUFrQixDQUFDLEtBQUssRUFBRSxDQUFDO1FBQzNCLGtCQUFrQixDQUFDLEVBQUUsQ0FBQyw4Q0FBcUIsQ0FBQyxDQUFDLFFBQVEsQ0FBQztZQUNwRCxZQUFZLEVBQUUsY0FBYztTQUM3QixDQUFDLENBQUM7UUFFSCxZQUFZO1FBQ1osV0FBVyxHQUFHO1lBQ1osWUFBWSxFQUFFLGlCQUFpQjtZQUMvQixZQUFZLEVBQUUsYUFBYTtZQUMzQixlQUFlLEVBQUUsR0FBRztZQUNwQixrQkFBa0IsRUFBRSxpRUFBaUU7WUFDckYsZUFBZSxFQUFFLEtBQUs7WUFDdEIsWUFBWSxFQUFFLHlCQUF5QjtZQUN2Qyxh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QU0sQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUMsSUFBSSxDQUFDLGtCQUFrQixDQUFDLENBQUM7WUFDakQsTUFBTSxDQUFDLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQyxTQUFTLENBQUMscUJBQXFCLENBQUMsQ0FBQztRQUN4RCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFx0aTE5OFxcaW52ZXN0bWVudF9hbmFseXNpc19vcG9wb1xcc3JjXFxsYW1iZGFcXHF1ZXJ5XFxfX3Rlc3RzX19cXGRhdGUtcmFuZ2UtdmFsaWRhdGlvbi5wcm9wZXJ0eS50ZXN0LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBEYXRlIFJhbmdlIFZhbGlkYXRpb24gUHJvcGVydHkgVGVzdHNcclxuICpcclxuICogUHJvcGVydHkgODog5pel5LuY56+E5Zuy44Gu6aCG5bqP5oCnXHJcbiAqIFZhbGlkYXRlczogUmVxdWlyZW1lbnRzIDUuMlxyXG4gKlxyXG4gKiDplovlp4vml6XjgYzntYLkuobml6Xjgojjgorlvozjga7loLTlkIjjga/jg5Djg6rjg4fjg7zjgrfjg6fjg7Pjgqjjg6njg7zjgpLov5TjgZnjgZPjgajjgpLmpJzoqLxcclxuICpcclxuICogUmVxdWlyZW1lbnRzOiDopoHku7YxNC4y77yI44OX44Ot44OR44OG44Kj44OG44K544OI77yJXHJcbiAqL1xyXG5cclxuaW1wb3J0ICogYXMgZmMgZnJvbSAnZmFzdC1jaGVjayc7XHJcbmltcG9ydCB7IENvbnRleHQsIEFQSUdhdGV3YXlQcm94eUV2ZW50IH0gZnJvbSAnYXdzLWxhbWJkYSc7XHJcbmltcG9ydCB7IGhhbmRsZXIgfSBmcm9tICcuLi9oYW5kbGVyJztcclxuaW1wb3J0IHsgU2VjcmV0c01hbmFnZXJDbGllbnQsIEdldFNlY3JldFZhbHVlQ29tbWFuZCB9IGZyb20gJ0Bhd3Mtc2RrL2NsaWVudC1zZWNyZXRzLW1hbmFnZXInO1xyXG5pbXBvcnQgeyBtb2NrQ2xpZW50IH0gZnJvbSAnYXdzLXNkay1jbGllbnQtbW9jayc7XHJcblxyXG4vLyDjg6Ljg4Pjgq9cclxuamVzdC5tb2NrKCcuLi9xdWVyeS1kaXNjbG9zdXJlcycpO1xyXG5qZXN0Lm1vY2soJy4uL2Zvcm1hdC1jc3YnKTtcclxuamVzdC5tb2NrKCcuLi8uLi8uLi91dGlscy9sb2dnZXInKTtcclxuamVzdC5tb2NrKCcuLi8uLi8uLi91dGlscy9jbG91ZHdhdGNoLW1ldHJpY3MnKTtcclxuXHJcbi8vIFNlY3JldHMgTWFuYWdlcuODouODg+OCr1xyXG5jb25zdCBzZWNyZXRzTWFuYWdlck1vY2sgPSBtb2NrQ2xpZW50KFNlY3JldHNNYW5hZ2VyQ2xpZW50KTtcclxuXHJcbmRlc2NyaWJlKCdQcm9wZXJ0eSA4OiDml6Xku5jnr4Tlm7Ljga7poIbluo/mgKcnLCAoKSA9PiB7XHJcbiAgbGV0IG1vY2tDb250ZXh0OiBDb250ZXh0O1xyXG4gIGxldCBiYXNlRXZlbnQ6IEFQSUdhdGV3YXlQcm94eUV2ZW50O1xyXG5cclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIC8vIFNlY3JldHMgTWFuYWdlcuODouODg+OCr+OBruOCu+ODg+ODiOOCouODg+ODl1xyXG4gICAgc2VjcmV0c01hbmFnZXJNb2NrLnJlc2V0KCk7XHJcbiAgICBzZWNyZXRzTWFuYWdlck1vY2sub24oR2V0U2VjcmV0VmFsdWVDb21tYW5kKS5yZXNvbHZlcyh7XHJcbiAgICAgIFNlY3JldFN0cmluZzogJ3Rlc3QtYXBpLWtleScsXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyDjg6Ljg4Pjgq/jgrPjg7Pjg4bjgq3jgrnjg4hcclxuICAgIG1vY2tDb250ZXh0ID0ge1xyXG4gICAgICBhd3NSZXF1ZXN0SWQ6ICd0ZXN0LXJlcXVlc3QtaWQnLFxyXG4gICAgICBmdW5jdGlvbk5hbWU6ICd0ZG5ldC1xdWVyeScsXHJcbiAgICAgIGZ1bmN0aW9uVmVyc2lvbjogJzEnLFxyXG4gICAgICBpbnZva2VkRnVuY3Rpb25Bcm46ICdhcm46YXdzOmxhbWJkYTphcC1ub3J0aGVhc3QtMToxMjM0NTY3ODkwMTI6ZnVuY3Rpb246dGRuZXQtcXVlcnknLFxyXG4gICAgICBtZW1vcnlMaW1pdEluTUI6ICcyNTYnLFxyXG4gICAgICBsb2dHcm91cE5hbWU6ICcvYXdzL2xhbWJkYS90ZG5ldC1xdWVyeScsXHJcbiAgICAgIGxvZ1N0cmVhbU5hbWU6ICcyMDI0LzAxLzE1L1skTEFURVNUXWFiY2RlZicsXHJcbiAgICAgIGdldFJlbWFpbmluZ1RpbWVJbk1pbGxpczogKCkgPT4gMzAwMDAsXHJcbiAgICAgIGNhbGxiYWNrV2FpdHNGb3JFbXB0eUV2ZW50TG9vcDogdHJ1ZSxcclxuICAgICAgZG9uZTogamVzdC5mbigpLFxyXG4gICAgICBmYWlsOiBqZXN0LmZuKCksXHJcbiAgICAgIHN1Y2NlZWQ6IGplc3QuZm4oKSxcclxuICAgIH07XHJcblxyXG4gICAgLy8g44OZ44O844K544Kk44OZ44Oz44OIXHJcbiAgICBiYXNlRXZlbnQgPSB7XHJcbiAgICAgIGJvZHk6IG51bGwsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAneC1hcGkta2V5JzogJ3Rlc3QtYXBpLWtleScsXHJcbiAgICAgIH0sXHJcbiAgICAgIG11bHRpVmFsdWVIZWFkZXJzOiB7fSxcclxuICAgICAgaHR0cE1ldGhvZDogJ0dFVCcsXHJcbiAgICAgIGlzQmFzZTY0RW5jb2RlZDogZmFsc2UsXHJcbiAgICAgIHBhdGg6ICcvZGlzY2xvc3VyZXMnLFxyXG4gICAgICBwYXRoUGFyYW1ldGVyczogbnVsbCxcclxuICAgICAgcXVlcnlTdHJpbmdQYXJhbWV0ZXJzOiBudWxsLFxyXG4gICAgICBtdWx0aVZhbHVlUXVlcnlTdHJpbmdQYXJhbWV0ZXJzOiBudWxsLFxyXG4gICAgICBzdGFnZVZhcmlhYmxlczogbnVsbCxcclxuICAgICAgcmVxdWVzdENvbnRleHQ6IHtcclxuICAgICAgICBhY2NvdW50SWQ6ICcxMjM0NTY3ODkwMTInLFxyXG4gICAgICAgIGFwaUlkOiAndGVzdC1hcGktaWQnLFxyXG4gICAgICAgIHByb3RvY29sOiAnSFRUUC8xLjEnLFxyXG4gICAgICAgIGh0dHBNZXRob2Q6ICdHRVQnLFxyXG4gICAgICAgIHBhdGg6ICcvZGlzY2xvc3VyZXMnLFxyXG4gICAgICAgIHN0YWdlOiAncHJvZCcsXHJcbiAgICAgICAgcmVxdWVzdElkOiAndGVzdC1yZXF1ZXN0LWlkJyxcclxuICAgICAgICByZXF1ZXN0VGltZTogJzE1L0phbi8yMDI0OjEwOjMwOjAwICswMDAwJyxcclxuICAgICAgICByZXF1ZXN0VGltZUVwb2NoOiAxNzA1MzE1ODAwMDAwLFxyXG4gICAgICAgIGlkZW50aXR5OiB7XHJcbiAgICAgICAgICBhY2Nlc3NLZXk6IG51bGwsXHJcbiAgICAgICAgICBhY2NvdW50SWQ6IG51bGwsXHJcbiAgICAgICAgICBhcGlLZXk6IG51bGwsXHJcbiAgICAgICAgICBhcGlLZXlJZDogbnVsbCxcclxuICAgICAgICAgIGNhbGxlcjogbnVsbCxcclxuICAgICAgICAgIGNsaWVudENlcnQ6IG51bGwsXHJcbiAgICAgICAgICBjb2duaXRvQXV0aGVudGljYXRpb25Qcm92aWRlcjogbnVsbCxcclxuICAgICAgICAgIGNvZ25pdG9BdXRoZW50aWNhdGlvblR5cGU6IG51bGwsXHJcbiAgICAgICAgICBjb2duaXRvSWRlbnRpdHlJZDogbnVsbCxcclxuICAgICAgICAgIGNvZ25pdG9JZGVudGl0eVBvb2xJZDogbnVsbCxcclxuICAgICAgICAgIHByaW5jaXBhbE9yZ0lkOiBudWxsLFxyXG4gICAgICAgICAgc291cmNlSXA6ICcxOTIuMTY4LjEuMScsXHJcbiAgICAgICAgICB1c2VyOiBudWxsLFxyXG4gICAgICAgICAgdXNlckFnZW50OiAnTW96aWxsYS81LjAnLFxyXG4gICAgICAgICAgdXNlckFybjogbnVsbCxcclxuICAgICAgICB9LFxyXG4gICAgICAgIGF1dGhvcml6ZXI6IG51bGwsXHJcbiAgICAgICAgZG9tYWluTmFtZTogJ2FwaS5leGFtcGxlLmNvbScsXHJcbiAgICAgICAgZG9tYWluUHJlZml4OiAnYXBpJyxcclxuICAgICAgICByZXNvdXJjZUlkOiAndGVzdC1yZXNvdXJjZS1pZCcsXHJcbiAgICAgICAgcmVzb3VyY2VQYXRoOiAnL2Rpc2Nsb3N1cmVzJyxcclxuICAgICAgfSxcclxuICAgICAgcmVzb3VyY2U6ICcvZGlzY2xvc3VyZXMnLFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyDnkrDlooPlpInmlbDoqK3lrppcclxuICAgIHByb2Nlc3MuZW52LkFQSV9LRVkgPSAndGVzdC1hcGkta2V5JztcclxuICAgIHByb2Nlc3MuZW52LkRZTkFNT0RCX1RBQkxFX05BTUUgPSAndGRuZXRfZGlzY2xvc3VyZXMnO1xyXG4gICAgcHJvY2Vzcy5lbnYuUzNfQlVDS0VUX05BTUUgPSAndGRuZXQtcGRmcyc7XHJcblxyXG4gICAgamVzdC5jbGVhckFsbE1vY2tzKCk7XHJcbiAgfSk7XHJcblxyXG4gIC8qKlxyXG4gICAqIOaXpeS7mOaWh+Wtl+WIl+eUn+aIkO+8iFlZWVktTU0tRETlvaLlvI/vvIlcclxuICAgKi9cclxuICBjb25zdCBkYXRlQXJiaXRyYXJ5ID0gZmMuZGF0ZSh7XHJcbiAgICBtaW46IG5ldyBEYXRlKCcyMDIwLTAxLTAxJyksXHJcbiAgICBtYXg6IG5ldyBEYXRlKCcyMDI1LTEyLTMxJyksXHJcbiAgfSkubWFwKChkYXRlKSA9PiB7XHJcbiAgICBjb25zdCB5ZWFyID0gZGF0ZS5nZXRGdWxsWWVhcigpO1xyXG4gICAgY29uc3QgbW9udGggPSBTdHJpbmcoZGF0ZS5nZXRNb250aCgpICsgMSkucGFkU3RhcnQoMiwgJzAnKTtcclxuICAgIGNvbnN0IGRheSA9IFN0cmluZyhkYXRlLmdldERhdGUoKSkucGFkU3RhcnQoMiwgJzAnKTtcclxuICAgIHJldHVybiBgJHt5ZWFyfS0ke21vbnRofS0ke2RheX1gO1xyXG4gIH0pO1xyXG5cclxuICBpdCgnUHJvcGVydHkgOC4xOiDplovlp4vml6XjgYzntYLkuobml6Xjgojjgorlvozjga7loLTlkIjjga/lv4XjgZrjg5Djg6rjg4fjg7zjgrfjg6fjg7Pjgqjjg6njg7wnLCBhc3luYyAoKSA9PiB7XHJcbiAgICBhd2FpdCBmYy5hc3NlcnQoXHJcbiAgICAgIGZjLmFzeW5jUHJvcGVydHkoZGF0ZUFyYml0cmFyeSwgZGF0ZUFyYml0cmFyeSwgYXN5bmMgKGRhdGUxLCBkYXRlMikgPT4ge1xyXG4gICAgICAgIC8vIGRhdGUxID4gZGF0ZTIg44Go44Gq44KL44Oa44Ki44Gu44G/44OG44K544OIXHJcbiAgICAgICAgaWYgKGRhdGUxIDw9IGRhdGUyKSB7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTsgLy8g44K544Kt44OD44OXXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBldmVudCA9IHtcclxuICAgICAgICAgIC4uLmJhc2VFdmVudCxcclxuICAgICAgICAgIHF1ZXJ5U3RyaW5nUGFyYW1ldGVyczoge1xyXG4gICAgICAgICAgICBzdGFydF9kYXRlOiBkYXRlMSwgLy8g5b6M44Gu5pel5LuYXHJcbiAgICAgICAgICAgIGVuZF9kYXRlOiBkYXRlMiwgLy8g5YmN44Gu5pel5LuYXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhhbmRsZXIoZXZlbnQsIG1vY2tDb250ZXh0KTtcclxuXHJcbiAgICAgICAgLy8g44OQ44Oq44OH44O844K344On44Oz44Ko44Op44O877yINDAw77yJ44GM6L+U44GV44KM44KL44GT44Go44KS56K66KqNXHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0dXNDb2RlKS50b0JlKDQwMCk7XHJcblxyXG4gICAgICAgIGNvbnN0IGJvZHkgPSBKU09OLnBhcnNlKHJlc3VsdC5ib2R5KTtcclxuICAgICAgICBleHBlY3QoYm9keS5lcnJvcl9jb2RlKS50b0JlKCdWQUxJREFUSU9OX0VSUk9SJyk7XHJcbiAgICAgICAgZXhwZWN0KGJvZHkubWVzc2FnZSkudG9Db250YWluKCdzdGFydF9kYXRlJyk7XHJcbiAgICAgICAgZXhwZWN0KGJvZHkubWVzc2FnZSkudG9Db250YWluKCdtdXN0IGJlIGJlZm9yZSBvciBlcXVhbCB0bycpO1xyXG4gICAgICAgIGV4cGVjdChib2R5Lm1lc3NhZ2UpLnRvQ29udGFpbignZW5kX2RhdGUnKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH0pLFxyXG4gICAgICB7IG51bVJ1bnM6IDEwMCB9IC8vIDEwMOWbnuWPjeW+qeWun+ihjFxyXG4gICAgKTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ1Byb3BlcnR5IDguMjog6ZaL5aeL5pel44GM57WC5LqG5pel44Go5ZCM44GY5aC05ZCI44Gv5oiQ5YqfJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgYXdhaXQgZmMuYXNzZXJ0KFxyXG4gICAgICBmYy5hc3luY1Byb3BlcnR5KGRhdGVBcmJpdHJhcnksIGFzeW5jIChkYXRlKSA9PiB7XHJcbiAgICAgICAgY29uc3QgZXZlbnQgPSB7XHJcbiAgICAgICAgICAuLi5iYXNlRXZlbnQsXHJcbiAgICAgICAgICBxdWVyeVN0cmluZ1BhcmFtZXRlcnM6IHtcclxuICAgICAgICAgICAgc3RhcnRfZGF0ZTogZGF0ZSxcclxuICAgICAgICAgICAgZW5kX2RhdGU6IGRhdGUsIC8vIOWQjOOBmOaXpeS7mFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBoYW5kbGVyKGV2ZW50LCBtb2NrQ29udGV4dCk7XHJcblxyXG4gICAgICAgIC8vIOODkOODquODh+ODvOOCt+ODp+ODs+OCqOODqeODvOOBp+OBr+OBquOBhOOBk+OBqOOCkueiuuiqje+8iDIwMOOBvuOBn+OBrzUwMO+8iVxyXG4gICAgICAgIGV4cGVjdChyZXN1bHQuc3RhdHVzQ29kZSkubm90LnRvQmUoNDAwKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgIH0pLFxyXG4gICAgICB7IG51bVJ1bnM6IDEwMCB9XHJcbiAgICApO1xyXG4gIH0pO1xyXG5cclxuICBpdCgnUHJvcGVydHkgOC4zOiDplovlp4vml6XjgYzntYLkuobml6XjgojjgorliY3jga7loLTlkIjjga/miJDlip8nLCBhc3luYyAoKSA9PiB7XHJcbiAgICBhd2FpdCBmYy5hc3NlcnQoXHJcbiAgICAgIGZjLmFzeW5jUHJvcGVydHkoZGF0ZUFyYml0cmFyeSwgZGF0ZUFyYml0cmFyeSwgYXN5bmMgKGRhdGUxLCBkYXRlMikgPT4ge1xyXG4gICAgICAgIC8vIGRhdGUxIDwgZGF0ZTIg44Go44Gq44KL44Oa44Ki44Gu44G/44OG44K544OIXHJcbiAgICAgICAgaWYgKGRhdGUxID49IGRhdGUyKSB7XHJcbiAgICAgICAgICByZXR1cm4gdHJ1ZTsgLy8g44K544Kt44OD44OXXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBldmVudCA9IHtcclxuICAgICAgICAgIC4uLmJhc2VFdmVudCxcclxuICAgICAgICAgIHF1ZXJ5U3RyaW5nUGFyYW1ldGVyczoge1xyXG4gICAgICAgICAgICBzdGFydF9kYXRlOiBkYXRlMSwgLy8g5YmN44Gu5pel5LuYXHJcbiAgICAgICAgICAgIGVuZF9kYXRlOiBkYXRlMiwgLy8g5b6M44Gu5pel5LuYXHJcbiAgICAgICAgICB9LFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhhbmRsZXIoZXZlbnQsIG1vY2tDb250ZXh0KTtcclxuXHJcbiAgICAgICAgLy8g44OQ44Oq44OH44O844K344On44Oz44Ko44Op44O844Gn44Gv44Gq44GE44GT44Go44KS56K66KqNXHJcbiAgICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0dXNDb2RlKS5ub3QudG9CZSg0MDApO1xyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgfSksXHJcbiAgICAgIHsgbnVtUnVuczogMTAwIH1cclxuICAgICk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCfjgqjjg4PjgrjjgrHjg7zjgrknLCAoKSA9PiB7XHJcbiAgICBpdCgn5pyI44G+44Gf44GO44Gu5pel5LuY56+E5ZuyJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgICBjb25zdCBldmVudCA9IHtcclxuICAgICAgICAuLi5iYXNlRXZlbnQsXHJcbiAgICAgICAgcXVlcnlTdHJpbmdQYXJhbWV0ZXJzOiB7XHJcbiAgICAgICAgICBzdGFydF9kYXRlOiAnMjAyNC0wMS0zMScsXHJcbiAgICAgICAgICBlbmRfZGF0ZTogJzIwMjQtMDItMDEnLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBoYW5kbGVyKGV2ZW50LCBtb2NrQ29udGV4dCk7XHJcblxyXG4gICAgICAvLyDjg5Djg6rjg4fjg7zjgrfjg6fjg7Pjgqjjg6njg7zjgafjga/jgarjgYTjgZPjgajjgpLnorroqo1cclxuICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0dXNDb2RlKS5ub3QudG9CZSg0MDApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ+W5tOOBvuOBn+OBjuOBruaXpeS7mOevhOWbsicsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgZXZlbnQgPSB7XHJcbiAgICAgICAgLi4uYmFzZUV2ZW50LFxyXG4gICAgICAgIHF1ZXJ5U3RyaW5nUGFyYW1ldGVyczoge1xyXG4gICAgICAgICAgc3RhcnRfZGF0ZTogJzIwMjMtMTItMzEnLFxyXG4gICAgICAgICAgZW5kX2RhdGU6ICcyMDI0LTAxLTAxJyxcclxuICAgICAgICB9LFxyXG4gICAgICB9O1xyXG5cclxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgaGFuZGxlcihldmVudCwgbW9ja0NvbnRleHQpO1xyXG5cclxuICAgICAgLy8g44OQ44Oq44OH44O844K344On44Oz44Ko44Op44O844Gn44Gv44Gq44GE44GT44Go44KS56K66KqNXHJcbiAgICAgIGV4cGVjdChyZXN1bHQuc3RhdHVzQ29kZSkubm90LnRvQmUoNDAwKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCfjgYbjgovjgYblubTjga4y5pyIMjnml6UnLCBhc3luYyAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGV2ZW50ID0ge1xyXG4gICAgICAgIC4uLmJhc2VFdmVudCxcclxuICAgICAgICBxdWVyeVN0cmluZ1BhcmFtZXRlcnM6IHtcclxuICAgICAgICAgIHN0YXJ0X2RhdGU6ICcyMDI0LTAyLTI5JywgLy8g44GG44KL44GG5bm0XHJcbiAgICAgICAgICBlbmRfZGF0ZTogJzIwMjQtMDMtMDEnLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH07XHJcblxyXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBoYW5kbGVyKGV2ZW50LCBtb2NrQ29udGV4dCk7XHJcblxyXG4gICAgICAvLyDjg5Djg6rjg4fjg7zjgrfjg6fjg7Pjgqjjg6njg7zjgafjga/jgarjgYTjgZPjgajjgpLnorroqo1cclxuICAgICAgZXhwZWN0KHJlc3VsdC5zdGF0dXNDb2RlKS5ub3QudG9CZSg0MDApO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ+mdnuOBhuOCi+OBhuW5tOOBrjLmnIgyOeaXpeOBr+ODkOODquODh+ODvOOCt+ODp+ODs+OCqOODqeODvCcsIGFzeW5jICgpID0+IHtcclxuICAgICAgY29uc3QgZXZlbnQgPSB7XHJcbiAgICAgICAgLi4uYmFzZUV2ZW50LFxyXG4gICAgICAgIHF1ZXJ5U3RyaW5nUGFyYW1ldGVyczoge1xyXG4gICAgICAgICAgc3RhcnRfZGF0ZTogJzIwMjMtMDItMjknLCAvLyDpnZ7jgYbjgovjgYblubRcclxuICAgICAgICAgIGVuZF9kYXRlOiAnMjAyMy0wMy0wMScsXHJcbiAgICAgICAgfSxcclxuICAgICAgfTtcclxuXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGhhbmRsZXIoZXZlbnQsIG1vY2tDb250ZXh0KTtcclxuXHJcbiAgICAgIC8vIOODkOODquODh+ODvOOCt+ODp+ODs+OCqOODqeODvO+8iOWtmOWcqOOBl+OBquOBhOaXpeS7mO+8iVxyXG4gICAgICBleHBlY3QocmVzdWx0LnN0YXR1c0NvZGUpLnRvQmUoNDAwKTtcclxuICAgICAgY29uc3QgYm9keSA9IEpTT04ucGFyc2UocmVzdWx0LmJvZHkpO1xyXG4gICAgICBleHBlY3QoYm9keS5lcnJvcl9jb2RlKS50b0JlKCdWQUxJREFUSU9OX0VSUk9SJyk7XHJcbiAgICAgIGV4cGVjdChib2R5Lm1lc3NhZ2UpLnRvQ29udGFpbignRGF0ZSBkb2VzIG5vdCBleGlzdCcpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXSwidmVyc2lvbiI6M30=