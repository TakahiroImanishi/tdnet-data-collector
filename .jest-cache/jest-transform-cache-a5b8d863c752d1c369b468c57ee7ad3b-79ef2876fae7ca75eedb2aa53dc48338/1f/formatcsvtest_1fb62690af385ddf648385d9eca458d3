10438be36c87ae8b961c4da94efa1804
"use strict";
/**
 * Format CSV Tests
 *
 * Requirements: 要件14.1（ユニットテスト）
 */
Object.defineProperty(exports, "__esModule", { value: true });
const format_csv_1 = require("../format-csv");
describe('Format CSV', () => {
    const mockDisclosures = [
        {
            disclosure_id: 'TD20240115001',
            company_code: '7203',
            company_name: 'トヨタ自動車',
            disclosure_type: '決算短信',
            title: '2024年3月期 第3四半期決算短信',
            disclosed_at: '2024-01-15T10:30:00Z',
            pdf_url: 'https://www.release.tdnet.info/inbs/140120240115533808.pdf',
            s3_key: '2024/01/15/TD20240115001_7203.pdf',
            collected_at: '2024-01-15T10:35:00Z',
            date_partition: '2024-01',
        },
        {
            disclosure_id: 'TD20240115002',
            company_code: '6758',
            company_name: 'ソニーグループ',
            disclosure_type: '有価証券報告書',
            title: '第78期有価証券報告書',
            disclosed_at: '2024-01-15T11:00:00Z',
            pdf_url: 'https://www.release.tdnet.info/inbs/140120240115534001.pdf',
            s3_key: '2024/01/15/TD20240115002_6758.pdf',
            collected_at: '2024-01-15T11:05:00Z',
            date_partition: '2024-01',
        },
    ];
    describe('formatAsCsv', () => {
        it('開示情報リストをCSV形式に変換', () => {
            const csv = (0, format_csv_1.formatAsCsv)(mockDisclosures);
            // ヘッダー行を確認
            expect(csv).toContain('disclosure_id,company_code,company_name');
            expect(csv).toContain('disclosure_type,title,disclosed_at');
            expect(csv).toContain('pdf_url,s3_key,collected_at,date_partition');
            // データ行を確認
            expect(csv).toContain('TD20240115001');
            expect(csv).toContain('7203');
            expect(csv).toContain('トヨタ自動車');
            expect(csv).toContain('TD20240115002');
            expect(csv).toContain('6758');
            expect(csv).toContain('ソニーグループ');
        });
        it('空のリストは ヘッダーのみ返す', () => {
            const csv = (0, format_csv_1.formatAsCsv)([]);
            const lines = csv.split('\n');
            expect(lines.length).toBe(1); // ヘッダーのみ
            expect(lines[0]).toContain('disclosure_id,company_code');
        });
        it('カンマを含むフィールドをエスケープ', () => {
            const disclosures = [
                {
                    ...mockDisclosures[0],
                    title: 'タイトル, カンマ付き',
                },
            ];
            const csv = (0, format_csv_1.formatAsCsv)(disclosures);
            // カンマを含むフィールドはダブルクォートで囲まれる
            expect(csv).toContain('"タイトル, カンマ付き"');
        });
        it('ダブルクォートを含むフィールドをエスケープ', () => {
            const disclosures = [
                {
                    ...mockDisclosures[0],
                    title: 'タイトル "引用符" 付き',
                },
            ];
            const csv = (0, format_csv_1.formatAsCsv)(disclosures);
            // ダブルクォートは2つ連続させてエスケープ
            expect(csv).toContain('"タイトル ""引用符"" 付き"');
        });
        it('改行を含むフィールドをエスケープ', () => {
            const disclosures = [
                {
                    ...mockDisclosures[0],
                    title: 'タイトル\n改行付き',
                },
            ];
            const csv = (0, format_csv_1.formatAsCsv)(disclosures);
            // 改行を含むフィールドはダブルクォートで囲まれる
            expect(csv).toContain('"タイトル\n改行付き"');
        });
        it('すべてのフィールドが含まれる', () => {
            const csv = (0, format_csv_1.formatAsCsv)(mockDisclosures);
            const lines = csv.split('\n');
            const headers = lines[0].split(',');
            expect(headers).toContain('disclosure_id');
            expect(headers).toContain('company_code');
            expect(headers).toContain('company_name');
            expect(headers).toContain('disclosure_type');
            expect(headers).toContain('title');
            expect(headers).toContain('disclosed_at');
            expect(headers).toContain('pdf_url');
            expect(headers).toContain('s3_key');
            expect(headers).toContain('collected_at');
            expect(headers).toContain('date_partition');
        });
        it('複数の開示情報を正しく変換', () => {
            const csv = (0, format_csv_1.formatAsCsv)(mockDisclosures);
            const lines = csv.split('\n').filter((line) => line.trim() !== '');
            expect(lines.length).toBe(3); // ヘッダー + 2データ行
        });
    });
    describe('parseCsv（テスト用）', () => {
        it('CSV文字列をパース', () => {
            const csv = (0, format_csv_1.formatAsCsv)(mockDisclosures);
            const parsed = (0, format_csv_1.parseCsv)(csv);
            expect(parsed.length).toBe(2);
            expect(parsed[0].disclosure_id).toBe('TD20240115001');
            expect(parsed[0].company_code).toBe('7203');
            expect(parsed[1].disclosure_id).toBe('TD20240115002');
            expect(parsed[1].company_code).toBe('6758');
        });
        it('空のCSV文字列は空配列を返す', () => {
            const parsed = (0, format_csv_1.parseCsv)('');
            expect(parsed).toEqual([]);
        });
    });
    describe('エッジケース', () => {
        it('null/undefinedフィールドは空文字列として扱う', () => {
            const disclosures = [
                {
                    disclosure_id: 'TD20240115001',
                    company_code: '7203',
                    company_name: null,
                    disclosure_type: undefined,
                    title: '2024年3月期 第3四半期決算短信',
                    disclosed_at: '2024-01-15T10:30:00Z',
                    pdf_url: 'https://www.release.tdnet.info/...',
                    s3_key: '2024/01/15/TD20240115001_7203.pdf',
                    collected_at: '2024-01-15T10:35:00Z',
                    date_partition: '2024-01',
                },
            ];
            const csv = (0, format_csv_1.formatAsCsv)(disclosures);
            // null/undefinedは空文字列として扱われる
            expect(csv).toContain('TD20240115001,7203,,');
        });
        it('特殊文字を含むフィールドを正しく処理', () => {
            const disclosures = [
                {
                    ...mockDisclosures[0],
                    title: 'タイトル & 特殊文字 < > " \' / \\',
                },
            ];
            const csv = (0, format_csv_1.formatAsCsv)(disclosures);
            // ダブルクォートのみエスケープが必要
            expect(csv).toContain('"タイトル & 特殊文字 < > "" \' / \\"');
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFx0aTE5OFxcaW52ZXN0bWVudF9hbmFseXNpc19vcG9wb1xcc3JjXFxsYW1iZGFcXHF1ZXJ5XFxfX3Rlc3RzX19cXGZvcm1hdC1jc3YudGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7R0FJRzs7QUFFSCw4Q0FBc0Q7QUFHdEQsUUFBUSxDQUFDLFlBQVksRUFBRSxHQUFHLEVBQUU7SUFDMUIsTUFBTSxlQUFlLEdBQWlCO1FBQ3BDO1lBQ0UsYUFBYSxFQUFFLGVBQWU7WUFDOUIsWUFBWSxFQUFFLE1BQU07WUFDcEIsWUFBWSxFQUFFLFFBQVE7WUFDdEIsZUFBZSxFQUFFLE1BQU07WUFDdkIsS0FBSyxFQUFFLG9CQUFvQjtZQUMzQixZQUFZLEVBQUUsc0JBQXNCO1lBQ3BDLE9BQU8sRUFBRSw0REFBNEQ7WUFDckUsTUFBTSxFQUFFLG1DQUFtQztZQUMzQyxZQUFZLEVBQUUsc0JBQXNCO1lBQ3BDLGNBQWMsRUFBRSxTQUFTO1NBQzFCO1FBQ0Q7WUFDRSxhQUFhLEVBQUUsZUFBZTtZQUM5QixZQUFZLEVBQUUsTUFBTTtZQUNwQixZQUFZLEVBQUUsU0FBUztZQUN2QixlQUFlLEVBQUUsU0FBUztZQUMxQixLQUFLLEVBQUUsYUFBYTtZQUNwQixZQUFZLEVBQUUsc0JBQXNCO1lBQ3BDLE9BQU8sRUFBRSw0REFBNEQ7WUFDckUsTUFBTSxFQUFFLG1DQUFtQztZQUMzQyxZQUFZLEVBQUUsc0JBQXNCO1lBQ3BDLGNBQWMsRUFBRSxTQUFTO1NBQzFCO0tBQ0YsQ0FBQztJQUVGLFFBQVEsQ0FBQyxhQUFhLEVBQUUsR0FBRyxFQUFFO1FBQzNCLEVBQUUsQ0FBQyxrQkFBa0IsRUFBRSxHQUFHLEVBQUU7WUFDMUIsTUFBTSxHQUFHLEdBQUcsSUFBQSx3QkFBVyxFQUFDLGVBQWUsQ0FBQyxDQUFDO1lBRXpDLFdBQVc7WUFDWCxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsU0FBUyxDQUFDLHlDQUF5QyxDQUFDLENBQUM7WUFDakUsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLFNBQVMs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QkFDekI7b0JBQ0UsYUFBYSxFQUFFLGVBQWU7b0JBQzlCLFlBQVksRUFBRSxNQUFNO29CQUNwQixZQUFZLEVBQUUsSUFBSTtvQkFDbEIsZUFBZSxFQUFFLFNBQVM7b0JBQzFCLEtBQUssRUFBRSxvQkFBb0I7b0JBQzNCLFlBQVksRUFBRSxzQkFBc0I7b0JBQ3BDLE9BQU8sRUFBRSxvQ0FBb0M7b0JBQzdDLE1BQU0sRUFBRSxtQ0FBbUM7b0JBQzNDLFlBQVksRUFBRSxzQkFBc0I7b0JBQ3BDLGNBQWMsRUFBRSxTQUFTO2lCQUMxQjthQUNGLENBQUM7WUFFRixNQUFNLEdBQUcsR0FBRyxJQUFBLHdCQUFXLEVBQUMsV0FBMkIsQ0FBQyxDQUFDO1lBRXJELDZCQUE2QjtZQUM3QixNQUFNLENBQUMsR0FBRyxDQUFDLENBQUMsU0FBUyxDQUFDLHNCQUFzQixDQUFDLENBQUM7UUFDaEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsb0JBQW9CLEVBQUUsR0FBRyxFQUFFO1lBQzVCLE1BQU0sV0FBVyxHQUFpQjtnQkFDaEM7b0JBQ0UsR0FBRyxlQUFlLENBQUMsQ0FBQyxDQUFDO29CQUNyQixLQUFLLEVBQUUsMkJBQTJCO2lCQUNuQzthQUNGLENBQUM7WUFFRixNQUFNLEdBQUcsR0FBRyxJQUFBLHdCQUFXLEVBQUMsV0FBVyxDQUFDLENBQUM7WUFFckMsb0JBQW9CO1lBQ3BCLE1BQU0sQ0FBQyxHQUFHLENBQUMsQ0FBQyxTQUFTLENBQUMsOEJBQThCLENBQUMsQ0FBQztRQUN4RCxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFx0aTE5OFxcaW52ZXN0bWVudF9hbmFseXNpc19vcG9wb1xcc3JjXFxsYW1iZGFcXHF1ZXJ5XFxfX3Rlc3RzX19cXGZvcm1hdC1jc3YudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogRm9ybWF0IENTViBUZXN0c1xyXG4gKlxyXG4gKiBSZXF1aXJlbWVudHM6IOimgeS7tjE0LjHvvIjjg6bjg4vjg4Pjg4jjg4bjgrnjg4jvvIlcclxuICovXHJcblxyXG5pbXBvcnQgeyBmb3JtYXRBc0NzdiwgcGFyc2VDc3YgfSBmcm9tICcuLi9mb3JtYXQtY3N2JztcclxuaW1wb3J0IHsgRGlzY2xvc3VyZSB9IGZyb20gJy4uLy4uLy4uL3R5cGVzJztcclxuXHJcbmRlc2NyaWJlKCdGb3JtYXQgQ1NWJywgKCkgPT4ge1xyXG4gIGNvbnN0IG1vY2tEaXNjbG9zdXJlczogRGlzY2xvc3VyZVtdID0gW1xyXG4gICAge1xyXG4gICAgICBkaXNjbG9zdXJlX2lkOiAnVEQyMDI0MDExNTAwMScsXHJcbiAgICAgIGNvbXBhbnlfY29kZTogJzcyMDMnLFxyXG4gICAgICBjb21wYW55X25hbWU6ICfjg4jjg6jjgr/oh6rli5Xou4onLFxyXG4gICAgICBkaXNjbG9zdXJlX3R5cGU6ICfmsbrnrpfnn63kv6EnLFxyXG4gICAgICB0aXRsZTogJzIwMjTlubQz5pyI5pyfIOesrDPlm5vljYrmnJ/msbrnrpfnn63kv6EnLFxyXG4gICAgICBkaXNjbG9zZWRfYXQ6ICcyMDI0LTAxLTE1VDEwOjMwOjAwWicsXHJcbiAgICAgIHBkZl91cmw6ICdodHRwczovL3d3dy5yZWxlYXNlLnRkbmV0LmluZm8vaW5icy8xNDAxMjAyNDAxMTU1MzM4MDgucGRmJyxcclxuICAgICAgczNfa2V5OiAnMjAyNC8wMS8xNS9URDIwMjQwMTE1MDAxXzcyMDMucGRmJyxcclxuICAgICAgY29sbGVjdGVkX2F0OiAnMjAyNC0wMS0xNVQxMDozNTowMFonLFxyXG4gICAgICBkYXRlX3BhcnRpdGlvbjogJzIwMjQtMDEnLFxyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgZGlzY2xvc3VyZV9pZDogJ1REMjAyNDAxMTUwMDInLFxyXG4gICAgICBjb21wYW55X2NvZGU6ICc2NzU4JyxcclxuICAgICAgY29tcGFueV9uYW1lOiAn44K944OL44O844Kw44Or44O844OXJyxcclxuICAgICAgZGlzY2xvc3VyZV90eXBlOiAn5pyJ5L6h6Ki85Yi45aCx5ZGK5pu4JyxcclxuICAgICAgdGl0bGU6ICfnrKw3OOacn+acieS+oeiovOWIuOWgseWRiuabuCcsXHJcbiAgICAgIGRpc2Nsb3NlZF9hdDogJzIwMjQtMDEtMTVUMTE6MDA6MDBaJyxcclxuICAgICAgcGRmX3VybDogJ2h0dHBzOi8vd3d3LnJlbGVhc2UudGRuZXQuaW5mby9pbmJzLzE0MDEyMDI0MDExNTUzNDAwMS5wZGYnLFxyXG4gICAgICBzM19rZXk6ICcyMDI0LzAxLzE1L1REMjAyNDAxMTUwMDJfNjc1OC5wZGYnLFxyXG4gICAgICBjb2xsZWN0ZWRfYXQ6ICcyMDI0LTAxLTE1VDExOjA1OjAwWicsXHJcbiAgICAgIGRhdGVfcGFydGl0aW9uOiAnMjAyNC0wMScsXHJcbiAgICB9LFxyXG4gIF07XHJcblxyXG4gIGRlc2NyaWJlKCdmb3JtYXRBc0NzdicsICgpID0+IHtcclxuICAgIGl0KCfplovnpLrmg4XloLHjg6rjgrnjg4jjgpJDU1blvaLlvI/jgavlpInmj5snLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGNzdiA9IGZvcm1hdEFzQ3N2KG1vY2tEaXNjbG9zdXJlcyk7XHJcblxyXG4gICAgICAvLyDjg5jjg4Pjg4Djg7zooYzjgpLnorroqo1cclxuICAgICAgZXhwZWN0KGNzdikudG9Db250YWluKCdkaXNjbG9zdXJlX2lkLGNvbXBhbnlfY29kZSxjb21wYW55X25hbWUnKTtcclxuICAgICAgZXhwZWN0KGNzdikudG9Db250YWluKCdkaXNjbG9zdXJlX3R5cGUsdGl0bGUsZGlzY2xvc2VkX2F0Jyk7XHJcbiAgICAgIGV4cGVjdChjc3YpLnRvQ29udGFpbigncGRmX3VybCxzM19rZXksY29sbGVjdGVkX2F0LGRhdGVfcGFydGl0aW9uJyk7XHJcblxyXG4gICAgICAvLyDjg4fjg7zjgr/ooYzjgpLnorroqo1cclxuICAgICAgZXhwZWN0KGNzdikudG9Db250YWluKCdURDIwMjQwMTE1MDAxJyk7XHJcbiAgICAgIGV4cGVjdChjc3YpLnRvQ29udGFpbignNzIwMycpO1xyXG4gICAgICBleHBlY3QoY3N2KS50b0NvbnRhaW4oJ+ODiOODqOOCv+iHquWLlei7iicpO1xyXG4gICAgICBleHBlY3QoY3N2KS50b0NvbnRhaW4oJ1REMjAyNDAxMTUwMDInKTtcclxuICAgICAgZXhwZWN0KGNzdikudG9Db250YWluKCc2NzU4Jyk7XHJcbiAgICAgIGV4cGVjdChjc3YpLnRvQ29udGFpbign44K944OL44O844Kw44Or44O844OXJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgn56m644Gu44Oq44K544OI44GvIOODmOODg+ODgOODvOOBruOBv+i/lOOBmScsICgpID0+IHtcclxuICAgICAgY29uc3QgY3N2ID0gZm9ybWF0QXNDc3YoW10pO1xyXG5cclxuICAgICAgY29uc3QgbGluZXMgPSBjc3Yuc3BsaXQoJ1xcbicpO1xyXG4gICAgICBleHBlY3QobGluZXMubGVuZ3RoKS50b0JlKDEpOyAvLyDjg5jjg4Pjg4Djg7zjga7jgb9cclxuICAgICAgZXhwZWN0KGxpbmVzWzBdKS50b0NvbnRhaW4oJ2Rpc2Nsb3N1cmVfaWQsY29tcGFueV9jb2RlJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgn44Kr44Oz44Oe44KS5ZCr44KA44OV44Kj44O844Or44OJ44KS44Ko44K544Kx44O844OXJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBkaXNjbG9zdXJlczogRGlzY2xvc3VyZVtdID0gW1xyXG4gICAgICAgIHtcclxuICAgICAgICAgIC4uLm1vY2tEaXNjbG9zdXJlc1swXSxcclxuICAgICAgICAgIHRpdGxlOiAn44K/44Kk44OI44OrLCDjgqvjg7Pjg57ku5jjgY0nLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIF07XHJcblxyXG4gICAgICBjb25zdCBjc3YgPSBmb3JtYXRBc0NzdihkaXNjbG9zdXJlcyk7XHJcblxyXG4gICAgICAvLyDjgqvjg7Pjg57jgpLlkKvjgoDjg5XjgqPjg7zjg6vjg4njga/jg4Djg5bjg6vjgq/jgqnjg7zjg4jjgaflm7Ljgb7jgozjgotcclxuICAgICAgZXhwZWN0KGNzdikudG9Db250YWluKCdcIuOCv+OCpOODiOODqywg44Kr44Oz44Oe5LuY44GNXCInKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCfjg4Djg5bjg6vjgq/jgqnjg7zjg4jjgpLlkKvjgoDjg5XjgqPjg7zjg6vjg4njgpLjgqjjgrnjgrHjg7zjg5cnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGRpc2Nsb3N1cmVzOiBEaXNjbG9zdXJlW10gPSBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgLi4ubW9ja0Rpc2Nsb3N1cmVzWzBdLFxyXG4gICAgICAgICAgdGl0bGU6ICfjgr/jgqTjg4jjg6sgXCLlvJXnlKjnrKZcIiDku5jjgY0nLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIF07XHJcblxyXG4gICAgICBjb25zdCBjc3YgPSBmb3JtYXRBc0NzdihkaXNjbG9zdXJlcyk7XHJcblxyXG4gICAgICAvLyDjg4Djg5bjg6vjgq/jgqnjg7zjg4jjga8y44Gk6YCj57aa44GV44Gb44Gm44Ko44K544Kx44O844OXXHJcbiAgICAgIGV4cGVjdChjc3YpLnRvQ29udGFpbignXCLjgr/jgqTjg4jjg6sgXCJcIuW8leeUqOesplwiXCIg5LuY44GNXCInKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCfmlLnooYzjgpLlkKvjgoDjg5XjgqPjg7zjg6vjg4njgpLjgqjjgrnjgrHjg7zjg5cnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGRpc2Nsb3N1cmVzOiBEaXNjbG9zdXJlW10gPSBbXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgLi4ubW9ja0Rpc2Nsb3N1cmVzWzBdLFxyXG4gICAgICAgICAgdGl0bGU6ICfjgr/jgqTjg4jjg6tcXG7mlLnooYzku5jjgY0nLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIF07XHJcblxyXG4gICAgICBjb25zdCBjc3YgPSBmb3JtYXRBc0NzdihkaXNjbG9zdXJlcyk7XHJcblxyXG4gICAgICAvLyDmlLnooYzjgpLlkKvjgoDjg5XjgqPjg7zjg6vjg4njga/jg4Djg5bjg6vjgq/jgqnjg7zjg4jjgaflm7Ljgb7jgozjgotcclxuICAgICAgZXhwZWN0KGNzdikudG9Db250YWluKCdcIuOCv+OCpOODiOODq1xcbuaUueihjOS7mOOBjVwiJyk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgn44GZ44G544Gm44Gu44OV44Kj44O844Or44OJ44GM5ZCr44G+44KM44KLJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBjc3YgPSBmb3JtYXRBc0Nzdihtb2NrRGlzY2xvc3VyZXMpO1xyXG5cclxuICAgICAgY29uc3QgbGluZXMgPSBjc3Yuc3BsaXQoJ1xcbicpO1xyXG4gICAgICBjb25zdCBoZWFkZXJzID0gbGluZXNbMF0uc3BsaXQoJywnKTtcclxuXHJcbiAgICAgIGV4cGVjdChoZWFkZXJzKS50b0NvbnRhaW4oJ2Rpc2Nsb3N1cmVfaWQnKTtcclxuICAgICAgZXhwZWN0KGhlYWRlcnMpLnRvQ29udGFpbignY29tcGFueV9jb2RlJyk7XHJcbiAgICAgIGV4cGVjdChoZWFkZXJzKS50b0NvbnRhaW4oJ2NvbXBhbnlfbmFtZScpO1xyXG4gICAgICBleHBlY3QoaGVhZGVycykudG9Db250YWluKCdkaXNjbG9zdXJlX3R5cGUnKTtcclxuICAgICAgZXhwZWN0KGhlYWRlcnMpLnRvQ29udGFpbigndGl0bGUnKTtcclxuICAgICAgZXhwZWN0KGhlYWRlcnMpLnRvQ29udGFpbignZGlzY2xvc2VkX2F0Jyk7XHJcbiAgICAgIGV4cGVjdChoZWFkZXJzKS50b0NvbnRhaW4oJ3BkZl91cmwnKTtcclxuICAgICAgZXhwZWN0KGhlYWRlcnMpLnRvQ29udGFpbignczNfa2V5Jyk7XHJcbiAgICAgIGV4cGVjdChoZWFkZXJzKS50b0NvbnRhaW4oJ2NvbGxlY3RlZF9hdCcpO1xyXG4gICAgICBleHBlY3QoaGVhZGVycykudG9Db250YWluKCdkYXRlX3BhcnRpdGlvbicpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ+ikh+aVsOOBrumWi+ekuuaDheWgseOCkuato+OBl+OBj+WkieaPmycsICgpID0+IHtcclxuICAgICAgY29uc3QgY3N2ID0gZm9ybWF0QXNDc3YobW9ja0Rpc2Nsb3N1cmVzKTtcclxuXHJcbiAgICAgIGNvbnN0IGxpbmVzID0gY3N2LnNwbGl0KCdcXG4nKS5maWx0ZXIoKGxpbmUpID0+IGxpbmUudHJpbSgpICE9PSAnJyk7XHJcbiAgICAgIGV4cGVjdChsaW5lcy5sZW5ndGgpLnRvQmUoMyk7IC8vIOODmOODg+ODgOODvCArIDLjg4fjg7zjgr/ooYxcclxuICAgIH0pO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgncGFyc2VDc3bvvIjjg4bjgrnjg4jnlKjvvIknLCAoKSA9PiB7XHJcbiAgICBpdCgnQ1NW5paH5a2X5YiX44KS44OR44O844K5JywgKCkgPT4ge1xyXG4gICAgICBjb25zdCBjc3YgPSBmb3JtYXRBc0Nzdihtb2NrRGlzY2xvc3VyZXMpO1xyXG4gICAgICBjb25zdCBwYXJzZWQgPSBwYXJzZUNzdihjc3YpO1xyXG5cclxuICAgICAgZXhwZWN0KHBhcnNlZC5sZW5ndGgpLnRvQmUoMik7XHJcbiAgICAgIGV4cGVjdChwYXJzZWRbMF0uZGlzY2xvc3VyZV9pZCkudG9CZSgnVEQyMDI0MDExNTAwMScpO1xyXG4gICAgICBleHBlY3QocGFyc2VkWzBdLmNvbXBhbnlfY29kZSkudG9CZSgnNzIwMycpO1xyXG4gICAgICBleHBlY3QocGFyc2VkWzFdLmRpc2Nsb3N1cmVfaWQpLnRvQmUoJ1REMjAyNDAxMTUwMDInKTtcclxuICAgICAgZXhwZWN0KHBhcnNlZFsxXS5jb21wYW55X2NvZGUpLnRvQmUoJzY3NTgnKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCfnqbrjga5DU1bmloflrZfliJfjga/nqbrphY3liJfjgpLov5TjgZknLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IHBhcnNlZCA9IHBhcnNlQ3N2KCcnKTtcclxuXHJcbiAgICAgIGV4cGVjdChwYXJzZWQpLnRvRXF1YWwoW10pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCfjgqjjg4PjgrjjgrHjg7zjgrknLCAoKSA9PiB7XHJcbiAgICBpdCgnbnVsbC91bmRlZmluZWTjg5XjgqPjg7zjg6vjg4njga/nqbrmloflrZfliJfjgajjgZfjgabmibHjgYYnLCAoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGRpc2Nsb3N1cmVzOiBhbnlbXSA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICBkaXNjbG9zdXJlX2lkOiAnVEQyMDI0MDExNTAwMScsXHJcbiAgICAgICAgICBjb21wYW55X2NvZGU6ICc3MjAzJyxcclxuICAgICAgICAgIGNvbXBhbnlfbmFtZTogbnVsbCxcclxuICAgICAgICAgIGRpc2Nsb3N1cmVfdHlwZTogdW5kZWZpbmVkLFxyXG4gICAgICAgICAgdGl0bGU6ICcyMDI05bm0M+aciOacnyDnrKwz5Zub5Y2K5pyf5rG6566X55+t5L+hJyxcclxuICAgICAgICAgIGRpc2Nsb3NlZF9hdDogJzIwMjQtMDEtMTVUMTA6MzA6MDBaJyxcclxuICAgICAgICAgIHBkZl91cmw6ICdodHRwczovL3d3dy5yZWxlYXNlLnRkbmV0LmluZm8vLi4uJyxcclxuICAgICAgICAgIHMzX2tleTogJzIwMjQvMDEvMTUvVEQyMDI0MDExNTAwMV83MjAzLnBkZicsXHJcbiAgICAgICAgICBjb2xsZWN0ZWRfYXQ6ICcyMDI0LTAxLTE1VDEwOjM1OjAwWicsXHJcbiAgICAgICAgICBkYXRlX3BhcnRpdGlvbjogJzIwMjQtMDEnLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIF07XHJcblxyXG4gICAgICBjb25zdCBjc3YgPSBmb3JtYXRBc0NzdihkaXNjbG9zdXJlcyBhcyBEaXNjbG9zdXJlW10pO1xyXG5cclxuICAgICAgLy8gbnVsbC91bmRlZmluZWTjga/nqbrmloflrZfliJfjgajjgZfjgabmibHjgo/jgozjgotcclxuICAgICAgZXhwZWN0KGNzdikudG9Db250YWluKCdURDIwMjQwMTE1MDAxLDcyMDMsLCcpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ+eJueauiuaWh+Wtl+OCkuWQq+OCgOODleOCo+ODvOODq+ODieOCkuato+OBl+OBj+WHpueQhicsICgpID0+IHtcclxuICAgICAgY29uc3QgZGlzY2xvc3VyZXM6IERpc2Nsb3N1cmVbXSA9IFtcclxuICAgICAgICB7XHJcbiAgICAgICAgICAuLi5tb2NrRGlzY2xvc3VyZXNbMF0sXHJcbiAgICAgICAgICB0aXRsZTogJ+OCv+OCpOODiOODqyAmIOeJueauiuaWh+WtlyA8ID4gXCIgXFwnIC8gXFxcXCcsXHJcbiAgICAgICAgfSxcclxuICAgICAgXTtcclxuXHJcbiAgICAgIGNvbnN0IGNzdiA9IGZvcm1hdEFzQ3N2KGRpc2Nsb3N1cmVzKTtcclxuXHJcbiAgICAgIC8vIOODgOODluODq+OCr+OCqeODvOODiOOBruOBv+OCqOOCueOCseODvOODl+OBjOW/heimgVxyXG4gICAgICBleHBlY3QoY3N2KS50b0NvbnRhaW4oJ1wi44K/44Kk44OI44OrICYg54m55q6K5paH5a2XIDwgPiBcIlwiIFxcJyAvIFxcXFxcIicpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXSwidmVyc2lvbiI6M30=