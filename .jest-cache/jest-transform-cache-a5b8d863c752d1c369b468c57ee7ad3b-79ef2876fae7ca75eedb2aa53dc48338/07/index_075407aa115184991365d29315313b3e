a0021531fcd718ef7ac5ad87df79fa8c
"use strict";
/**
 * カスタムエラークラス
 *
 * TDnet Data Collectorで使用するカスタムエラークラスを定義します。
 * エラーの種類に応じて適切なエラークラスを使用することで、
 * エラーハンドリングを統一し、再試行ロジックを適切に適用できます。
 *
 * Requirements: 要件6.1, 6.2（エラーハンドリング）
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.ConfigurationError = exports.AuthenticationError = exports.RateLimitError = exports.NotFoundError = exports.ValidationError = exports.RetryableError = exports.TDnetError = void 0;
/**
 * 基底エラークラス
 */
class TDnetError extends Error {
    cause;
    constructor(message, cause) {
        super(message);
        this.cause = cause;
        this.name = this.constructor.name;
        Error.captureStackTrace(this, this.constructor);
    }
}
exports.TDnetError = TDnetError;
/**
 * 再試行可能なエラー
 *
 * 一時的な問題である可能性が高いため、再試行すべきエラー：
 * - ネットワークエラー（ECONNRESET, ETIMEDOUT, ENOTFOUND）
 * - HTTPタイムアウト
 * - 5xxエラー（500 Internal Server Error, 503 Service Unavailable）
 * - AWS一時的エラー（ThrottlingException, ServiceUnavailable）
 * - レート制限（429 Too Many Requests）
 */
class RetryableError extends TDnetError {
    constructor(message, cause) {
        super(message, cause);
    }
}
exports.RetryableError = RetryableError;
/**
 * バリデーションエラー
 *
 * 入力データが不正な場合のエラー。再試行しても解決しないため、
 * 即座に失敗として扱います。
 *
 * 例：
 * - 不正なフォーマット（ISO8601以外）
 * - 存在しない日付（2024-02-30）
 * - 範囲外の日付（1970年以前、現在+1日以降）
 * - 必須フィールドの欠落
 */
class ValidationError extends TDnetError {
    details;
    constructor(message, details) {
        super(message);
        this.details = details;
    }
}
exports.ValidationError = ValidationError;
/**
 * リソース不存在エラー
 *
 * 指定されたリソースが存在しない場合のエラー。
 * 再試行しても解決しないため、即座に失敗として扱います。
 *
 * 例：
 * - 404 Not Found
 * - DynamoDBアイテムが存在しない
 * - S3オブジェクトが存在しない
 */
class NotFoundError extends TDnetError {
    resourceId;
    constructor(message, resourceId) {
        super(message);
        this.resourceId = resourceId;
    }
}
exports.NotFoundError = NotFoundError;
/**
 * レート制限エラー
 *
 * レート制限に達した場合のエラー。
 * 再試行可能ですが、適切な遅延時間を設けてから再試行する必要があります。
 *
 * 例：
 * - 429 Too Many Requests
 * - TDnetサーバーからのレート制限
 */
class RateLimitError extends RetryableError {
    retryAfter;
    constructor(message, retryAfter, // 秒単位
    cause) {
        super(message, cause);
        this.retryAfter = retryAfter;
    }
}
exports.RateLimitError = RateLimitError;
/**
 * 認証エラー
 *
 * 認証に失敗した場合のエラー。
 * 再試行しても解決しないため、即座に失敗として扱います。
 *
 * 例：
 * - 401 Unauthorized
 * - 403 Forbidden
 * - 無効なAPIキー
 */
class AuthenticationError extends TDnetError {
    constructor(message) {
        super(message);
    }
}
exports.AuthenticationError = AuthenticationError;
/**
 * 設定エラー
 *
 * 設定が不正な場合のエラー。
 * 再試行しても解決しないため、即座に失敗として扱います。
 *
 * 例：
 * - 環境変数未設定
 * - 不正な設定値
 */
class ConfigurationError extends TDnetError {
    configKey;
    constructor(message, configKey) {
        super(message);
        this.configKey = configKey;
    }
}
exports.ConfigurationError = ConfigurationError;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFx0aTE5OFxcaW52ZXN0bWVudF9hbmFseXNpc19vcG9wb1xcc3JjXFxlcnJvcnNcXGluZGV4LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7R0FRRzs7O0FBRUg7O0dBRUc7QUFDSCxNQUFhLFVBQVcsU0FBUSxLQUFLO0lBR2pCO0lBRmxCLFlBQ0UsT0FBZSxFQUNDLEtBQWE7UUFFN0IsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRkMsVUFBSyxHQUFMLEtBQUssQ0FBUTtRQUc3QixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDO1FBQ2xDLEtBQUssQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ2xELENBQUM7Q0FDRjtBQVRELGdDQVNDO0FBRUQ7Ozs7Ozs7OztHQVNHO0FBQ0gsTUFBYSxjQUFlLFNBQVEsVUFBVTtJQUM1QyxZQUFZLE9BQWUsRUFBRSxLQUFhO1FBQ3hDLEtBQUssQ0FBQyxPQUFPLEVBQUUsS0FBSyxDQUFDLENBQUM7SUFDeEIsQ0FBQztDQUNGO0FBSkQsd0NBSUM7QUFFRDs7Ozs7Ozs7Ozs7R0FXRztBQUNILE1BQWEsZUFBZ0IsU0FBUSxVQUFVO0lBRzNCO0lBRmxCLFlBQ0UsT0FBZSxFQUNDLE9BQWlDO1FBRWpELEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUZDLFlBQU8sR0FBUCxPQUFPLENBQTBCO0lBR25ELENBQUM7Q0FDRjtBQVBELDBDQU9DO0FBRUQ7Ozs7Ozs7Ozs7R0FVRztBQUNILE1BQWEsYUFBYyxTQUFRLFVBQVU7SUFHekI7SUFGbEIsWUFDRSxPQUFlLEVBQ0MsVUFBbUI7UUFFbkMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxDQUFDO1FBRkMsZUFBVSxHQUFWLFVBQVUsQ0FBUztJQUdyQyxDQUFDO0NBQ0Y7QUFQRCxzQ0FPQztBQUVEOzs7Ozs7Ozs7R0FTRztBQUNILE1BQWEsY0FBZSxTQUFRLGNBQWM7SUFHOUI7SUFGbEIsWUFDRSxPQUFlLEVBQ0MsVUFBbUIsRUFBRSxNQUFNO0lBQzNDLEtBQWE7UUFFYixLQUFLLENBQUMsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDO1FBSE4sZUFBVSxHQUFWLFVBQVUsQ0FBUztJQUlyQyxDQUFDO0NBQ0Y7QUFSRCx3Q0FRQztBQUVEOzs7Ozs7Ozs7O0dBVUc7QUFDSCxNQUFhLG1CQUFvQixTQUFRLFVBQVU7SUFDakQsWUFBWSxPQUFlO1FBQ3pCLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNqQixDQUFDO0NBQ0Y7QUFKRCxrREFJQztBQUVEOzs7Ozs7Ozs7R0FTRztBQUNILE1BQWEsa0JBQW1CLFNBQVEsVUFBVTtJQUc5QjtJQUZsQixZQUNFLE9BQWUsRUFDQyxTQUFrQjtRQUVsQyxLQUFLLENBQUMsT0FBTyxDQUFDLENBQUM7UUFGQyxjQUFTLEdBQVQsU0FBUyxDQUFTO0lBR3BDLENBQUM7Q0FDRjtBQVBELGdEQU9DIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcdGkxOThcXGludmVzdG1lbnRfYW5hbHlzaXNfb3BvcG9cXHNyY1xcZXJyb3JzXFxpbmRleC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIOOCq+OCueOCv+ODoOOCqOODqeODvOOCr+ODqeOCuVxuICpcbiAqIFREbmV0IERhdGEgQ29sbGVjdG9y44Gn5L2/55So44GZ44KL44Kr44K544K/44Og44Ko44Op44O844Kv44Op44K544KS5a6a576p44GX44G+44GZ44CCXG4gKiDjgqjjg6njg7zjga7nqK7poZ7jgavlv5zjgZjjgabpganliIfjgarjgqjjg6njg7zjgq/jg6njgrnjgpLkvb/nlKjjgZnjgovjgZPjgajjgafjgIFcbiAqIOOCqOODqeODvOODj+ODs+ODieODquODs+OCsOOCkue1seS4gOOBl+OAgeWGjeippuihjOODreOCuOODg+OCr+OCkumBqeWIh+OBq+mBqeeUqOOBp+OBjeOBvuOBmeOAglxuICpcbiAqIFJlcXVpcmVtZW50czog6KaB5Lu2Ni4xLCA2LjLvvIjjgqjjg6njg7zjg4/jg7Pjg4njg6rjg7PjgrDvvIlcbiAqL1xuXG4vKipcbiAqIOWfuuW6leOCqOODqeODvOOCr+ODqeOCuVxuICovXG5leHBvcnQgY2xhc3MgVERuZXRFcnJvciBleHRlbmRzIEVycm9yIHtcbiAgY29uc3RydWN0b3IoXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIHB1YmxpYyByZWFkb25seSBjYXVzZT86IEVycm9yXG4gICkge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICAgIHRoaXMubmFtZSA9IHRoaXMuY29uc3RydWN0b3IubmFtZTtcbiAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLCB0aGlzLmNvbnN0cnVjdG9yKTtcbiAgfVxufVxuXG4vKipcbiAqIOWGjeippuihjOWPr+iDveOBquOCqOODqeODvFxuICpcbiAqIOS4gOaZgueahOOBquWVj+mhjOOBp+OBguOCi+WPr+iDveaAp+OBjOmrmOOBhOOBn+OCgeOAgeWGjeippuihjOOBmeOBueOBjeOCqOODqeODvO+8mlxuICogLSDjg43jg4Pjg4jjg6/jg7zjgq/jgqjjg6njg7zvvIhFQ09OTlJFU0VULCBFVElNRURPVVQsIEVOT1RGT1VORO+8iVxuICogLSBIVFRQ44K/44Kk44Og44Ki44Km44OIXG4gKiAtIDV4eOOCqOODqeODvO+8iDUwMCBJbnRlcm5hbCBTZXJ2ZXIgRXJyb3IsIDUwMyBTZXJ2aWNlIFVuYXZhaWxhYmxl77yJXG4gKiAtIEFXU+S4gOaZgueahOOCqOODqeODvO+8iFRocm90dGxpbmdFeGNlcHRpb24sIFNlcnZpY2VVbmF2YWlsYWJsZe+8iVxuICogLSDjg6zjg7zjg4jliLbpmZDvvIg0MjkgVG9vIE1hbnkgUmVxdWVzdHPvvIlcbiAqL1xuZXhwb3J0IGNsYXNzIFJldHJ5YWJsZUVycm9yIGV4dGVuZHMgVERuZXRFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZywgY2F1c2U/OiBFcnJvcikge1xuICAgIHN1cGVyKG1lc3NhZ2UsIGNhdXNlKTtcbiAgfVxufVxuXG4vKipcbiAqIOODkOODquODh+ODvOOCt+ODp+ODs+OCqOODqeODvFxuICpcbiAqIOWFpeWKm+ODh+ODvOOCv+OBjOS4jeato+OBquWgtOWQiOOBruOCqOODqeODvOOAguWGjeippuihjOOBl+OBpuOCguino+axuuOBl+OBquOBhOOBn+OCgeOAgVxuICog5Y2z5bqn44Gr5aSx5pWX44Go44GX44Gm5omx44GE44G+44GZ44CCXG4gKlxuICog5L6L77yaXG4gKiAtIOS4jeato+OBquODleOCqeODvOODnuODg+ODiO+8iElTTzg2MDHku6XlpJbvvIlcbiAqIC0g5a2Y5Zyo44GX44Gq44GE5pel5LuY77yIMjAyNC0wMi0zMO+8iVxuICogLSDnr4Tlm7LlpJbjga7ml6Xku5jvvIgxOTcw5bm05Lul5YmN44CB54++5ZyoKzHml6Xku6XpmY3vvIlcbiAqIC0g5b+F6aCI44OV44Kj44O844Or44OJ44Gu5qyg6JC9XG4gKi9cbmV4cG9ydCBjbGFzcyBWYWxpZGF0aW9uRXJyb3IgZXh0ZW5kcyBURG5ldEVycm9yIHtcbiAgY29uc3RydWN0b3IoXG4gICAgbWVzc2FnZTogc3RyaW5nLFxuICAgIHB1YmxpYyByZWFkb25seSBkZXRhaWxzPzogUmVjb3JkPHN0cmluZywgdW5rbm93bj5cbiAgKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gIH1cbn1cblxuLyoqXG4gKiDjg6rjgr3jg7zjgrnkuI3lrZjlnKjjgqjjg6njg7xcbiAqXG4gKiDmjIflrprjgZXjgozjgZ/jg6rjgr3jg7zjgrnjgYzlrZjlnKjjgZfjgarjgYTloLTlkIjjga7jgqjjg6njg7zjgIJcbiAqIOWGjeippuihjOOBl+OBpuOCguino+axuuOBl+OBquOBhOOBn+OCgeOAgeWNs+W6p+OBq+WkseaVl+OBqOOBl+OBpuaJseOBhOOBvuOBmeOAglxuICpcbiAqIOS+i++8mlxuICogLSA0MDQgTm90IEZvdW5kXG4gKiAtIER5bmFtb0RC44Ki44Kk44OG44Og44GM5a2Y5Zyo44GX44Gq44GEXG4gKiAtIFMz44Kq44OW44K444Kn44Kv44OI44GM5a2Y5Zyo44GX44Gq44GEXG4gKi9cbmV4cG9ydCBjbGFzcyBOb3RGb3VuZEVycm9yIGV4dGVuZHMgVERuZXRFcnJvciB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBwdWJsaWMgcmVhZG9ubHkgcmVzb3VyY2VJZD86IHN0cmluZ1xuICApIHtcbiAgICBzdXBlcihtZXNzYWdlKTtcbiAgfVxufVxuXG4vKipcbiAqIOODrOODvOODiOWItumZkOOCqOODqeODvFxuICpcbiAqIOODrOODvOODiOWItumZkOOBq+mBlOOBl+OBn+WgtOWQiOOBruOCqOODqeODvOOAglxuICog5YaN6Kmm6KGM5Y+v6IO944Gn44GZ44GM44CB6YGp5YiH44Gq6YGF5bu25pmC6ZaT44KS6Kit44GR44Gm44GL44KJ5YaN6Kmm6KGM44GZ44KL5b+F6KaB44GM44GC44KK44G+44GZ44CCXG4gKlxuICog5L6L77yaXG4gKiAtIDQyOSBUb28gTWFueSBSZXF1ZXN0c1xuICogLSBURG5ldOOCteODvOODkOODvOOBi+OCieOBruODrOODvOODiOWItumZkFxuICovXG5leHBvcnQgY2xhc3MgUmF0ZUxpbWl0RXJyb3IgZXh0ZW5kcyBSZXRyeWFibGVFcnJvciB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBwdWJsaWMgcmVhZG9ubHkgcmV0cnlBZnRlcj86IG51bWJlciwgLy8g56eS5Y2Y5L2NXG4gICAgY2F1c2U/OiBFcnJvclxuICApIHtcbiAgICBzdXBlcihtZXNzYWdlLCBjYXVzZSk7XG4gIH1cbn1cblxuLyoqXG4gKiDoqo3oqLzjgqjjg6njg7xcbiAqXG4gKiDoqo3oqLzjgavlpLHmlZfjgZfjgZ/loLTlkIjjga7jgqjjg6njg7zjgIJcbiAqIOWGjeippuihjOOBl+OBpuOCguino+axuuOBl+OBquOBhOOBn+OCgeOAgeWNs+W6p+OBq+WkseaVl+OBqOOBl+OBpuaJseOBhOOBvuOBmeOAglxuICpcbiAqIOS+i++8mlxuICogLSA0MDEgVW5hdXRob3JpemVkXG4gKiAtIDQwMyBGb3JiaWRkZW5cbiAqIC0g54Sh5Yq544GqQVBJ44Kt44O8XG4gKi9cbmV4cG9ydCBjbGFzcyBBdXRoZW50aWNhdGlvbkVycm9yIGV4dGVuZHMgVERuZXRFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2U6IHN0cmluZykge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICB9XG59XG5cbi8qKlxuICog6Kit5a6a44Ko44Op44O8XG4gKlxuICog6Kit5a6a44GM5LiN5q2j44Gq5aC05ZCI44Gu44Ko44Op44O844CCXG4gKiDlho3oqabooYzjgZfjgabjgoLop6PmsbrjgZfjgarjgYTjgZ/jgoHjgIHljbPluqfjgavlpLHmlZfjgajjgZfjgabmibHjgYTjgb7jgZnjgIJcbiAqXG4gKiDkvovvvJpcbiAqIC0g55Kw5aKD5aSJ5pWw5pyq6Kit5a6aXG4gKiAtIOS4jeato+OBquioreWumuWApFxuICovXG5leHBvcnQgY2xhc3MgQ29uZmlndXJhdGlvbkVycm9yIGV4dGVuZHMgVERuZXRFcnJvciB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIG1lc3NhZ2U6IHN0cmluZyxcbiAgICBwdWJsaWMgcmVhZG9ubHkgY29uZmlnS2V5Pzogc3RyaW5nXG4gICkge1xuICAgIHN1cGVyKG1lc3NhZ2UpO1xuICB9XG59XG4iXSwidmVyc2lvbiI6M30=