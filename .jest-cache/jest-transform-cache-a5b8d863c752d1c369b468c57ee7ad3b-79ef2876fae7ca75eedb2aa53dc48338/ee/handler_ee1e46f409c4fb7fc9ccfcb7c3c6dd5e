ccf4656d019400e31b56b78757340809
"use strict";
/**
 * Lambda Export Status Handler
 *
 * GET /exports/{export_id} エンドポイント
 * エクスポート状態をDynamoDBから取得して返却します。
 *
 * Requirements: タスク13.5
 */
Object.defineProperty(exports, "__esModule", { value: true });
exports.handler = handler;
const client_dynamodb_1 = require("@aws-sdk/client-dynamodb");
const logger_1 = require("../../../utils/logger");
const cloudwatch_metrics_1 = require("../../../utils/cloudwatch-metrics");
const errors_1 = require("../../../errors");
const retry_1 = require("../../../utils/retry");
// DynamoDBクライアント（グローバルスコープで初期化）
const dynamoClient = new client_dynamodb_1.DynamoDBClient({ region: process.env.AWS_REGION || 'ap-northeast-1' });
// 環境変数
const EXPORT_STATUS_TABLE = process.env.EXPORT_STATUS_TABLE_NAME || 'tdnet_export_status';
const API_KEY = process.env.API_KEY;
/**
 * Lambda Export Status Handler
 *
 * @param event APIGatewayProxyEvent
 * @param context Lambda Context
 * @returns APIGatewayProxyResult
 *
 * @example
 * ```typescript
 * // GET /exports/export-20240115-xyz789
 * const response = await handler({
 *   pathParameters: { export_id: 'export-20240115-xyz789' },
 *   headers: { 'x-api-key': 'your-api-key' },
 * }, context);
 * ```
 */
async function handler(event, context) {
    const startTime = Date.now();
    try {
        logger_1.logger.info('Lambda Export Status started', {
            request_id: context.awsRequestId,
            function_name: context.functionName,
            export_id: event.pathParameters?.export_id,
        });
        // APIキー認証
        validateApiKey(event);
        // export_idの取得とバリデーション
        const exportId = validateExportId(event);
        // DynamoDBからエクスポート状態を取得
        const exportStatus = await getExportStatus(exportId);
        const duration = Date.now() - startTime;
        logger_1.logger.info('Lambda Export Status completed', {
            export_id: exportId,
            status: exportStatus.status,
            duration_ms: duration,
        });
        // 成功メトリクス送信
        await (0, cloudwatch_metrics_1.sendMetrics)([
            {
                name: 'LambdaExecutionTime',
                value: duration,
                unit: 'Milliseconds',
                dimensions: { FunctionName: 'ExportStatus' },
            },
            {
                name: 'ExportStatusQueries',
                value: 1,
                unit: 'Count',
                dimensions: { Status: exportStatus.status },
            },
        ]);
        // レスポンス
        return {
            statusCode: 200,
            headers: {
                'Content-Type': 'application/json',
                'Access-Control-Allow-Origin': '*',
                'Access-Control-Allow-Headers': 'Content-Type,X-Api-Key',
            },
            body: JSON.stringify({
                status: 'success',
                data: exportStatus,
            }),
        };
    }
    catch (error) {
        const duration = Date.now() - startTime;
        logger_1.logger.error('Lambda Export Status failed', (0, logger_1.createErrorContext)(error, {
            request_id: context.awsRequestId,
            export_id: event.pathParameters?.export_id,
            duration_ms: duration,
        }));
        // エラーメトリクス送信
        await (0, cloudwatch_metrics_1.sendErrorMetric)(error instanceof Error ? error.constructor.name : 'Unknown', 'ExportStatus');
        // エラーレスポンス
        return handleError(error, context.awsRequestId);
    }
}
/**
 * APIキー認証
 *
 * @param event APIGatewayProxyEvent
 * @throws AuthenticationError APIキーが無効な場合
 */
function validateApiKey(event) {
    const apiKey = event.headers?.['x-api-key'] || event.headers?.['X-Api-Key'];
    if (!apiKey) {
        throw new errors_1.AuthenticationError('API key is required');
    }
    // 環境変数から直接読み取る（テスト環境での動的設定に対応）
    const expectedApiKey = process.env.API_KEY;
    if (expectedApiKey && apiKey !== expectedApiKey) {
        throw new errors_1.AuthenticationError('Invalid API key');
    }
}
/**
 * export_idのバリデーション
 *
 * @param event APIGatewayProxyEvent
 * @returns export_id
 * @throws ValidationError export_idが無効な場合
 */
function validateExportId(event) {
    const exportId = event.pathParameters?.export_id;
    if (!exportId) {
        throw new errors_1.ValidationError('export_id is required');
    }
    // export_idのフォーマット検証（例: export-20240115-xyz789）
    if (!/^export-\d{8}-[a-z0-9]+$/.test(exportId)) {
        throw new errors_1.ValidationError(`Invalid export_id format: ${exportId}. Expected format: export-YYYYMMDD-{id}`);
    }
    return exportId;
}
/**
 * DynamoDBからエクスポート状態を取得
 *
 * @param exportId エクスポートID
 * @returns エクスポート状態
 * @throws NotFoundError エクスポートが見つからない場合
 */
async function getExportStatus(exportId) {
    logger_1.logger.info('Fetching export status from DynamoDB', {
        export_id: exportId,
        table: EXPORT_STATUS_TABLE,
    });
    const result = await (0, retry_1.retryWithBackoff)(async () => {
        return await dynamoClient.send(new client_dynamodb_1.GetItemCommand({
            TableName: EXPORT_STATUS_TABLE,
            Key: {
                export_id: { S: exportId },
            },
        }));
    }, {
        maxRetries: 3,
        initialDelay: 1000,
        backoffMultiplier: 2,
        jitter: true,
        shouldRetry: (error) => {
            return error.name === 'ProvisionedThroughputExceededException';
        },
    });
    if (!result.Item) {
        throw new errors_1.NotFoundError(`Export not found: ${exportId}`);
    }
    // DynamoDBアイテムをExportStatusに変換
    const item = result.Item;
    const exportStatus = {
        export_id: item.export_id.S,
        status: item.status.S,
        progress: parseInt(item.progress.N, 10),
        requested_at: item.requested_at.S,
        completed_at: item.completed_at?.S || null,
        export_count: item.export_count?.N ? parseInt(item.export_count.N, 10) : null,
        file_size: item.file_size?.N ? parseInt(item.file_size.N, 10) : null,
        download_url: item.download_url?.S || null,
        expires_at: item.expires_at?.S || null,
        error_message: item.error_message?.S || null,
    };
    logger_1.logger.info('Export status fetched successfully', {
        export_id: exportId,
        status: exportStatus.status,
        progress: exportStatus.progress,
    });
    return exportStatus;
}
/**
 * エラーハンドリング
 *
 * @param error エラーオブジェクト
 * @param requestId リクエストID
 * @returns APIGatewayProxyResult
 */
function handleError(error, requestId) {
    // エラー種別に応じたステータスコードとエラーコード
    let statusCode = 500;
    let errorCode = 'INTERNAL_ERROR';
    if (error instanceof errors_1.ValidationError) {
        statusCode = 400;
        errorCode = 'VALIDATION_ERROR';
    }
    else if (error instanceof errors_1.AuthenticationError) {
        statusCode = 401;
        errorCode = 'UNAUTHORIZED';
    }
    else if (error instanceof errors_1.NotFoundError) {
        statusCode = 404;
        errorCode = 'NOT_FOUND';
    }
    return {
        statusCode,
        headers: {
            'Content-Type': 'application/json',
            'Access-Control-Allow-Origin': '*',
            'Access-Control-Allow-Headers': 'Content-Type,X-Api-Key',
        },
        body: JSON.stringify({
            status: 'error',
            error: {
                code: errorCode,
                message: error.message,
                details: error.details || {},
            },
            request_id: requestId,
        }),
    };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFx0aTE5OFxcaW52ZXN0bWVudF9hbmFseXNpc19vcG9wb1xcc3JjXFxsYW1iZGFcXGFwaVxcZXhwb3J0LXN0YXR1c1xcaGFuZGxlci50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7R0FPRzs7QUFnQ0gsMEJBZ0ZDO0FBN0dELDhEQUEwRTtBQUMxRSxrREFBbUU7QUFDbkUsMEVBQWlGO0FBQ2pGLDRDQUFzRjtBQUN0RixnREFBd0Q7QUFFeEQsZ0NBQWdDO0FBQ2hDLE1BQU0sWUFBWSxHQUFHLElBQUksZ0NBQWMsQ0FBQyxFQUFFLE1BQU0sRUFBRSxPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVUsSUFBSSxnQkFBZ0IsRUFBRSxDQUFDLENBQUM7QUFFaEcsT0FBTztBQUNQLE1BQU0sbUJBQW1CLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyx3QkFBd0IsSUFBSSxxQkFBcUIsQ0FBQztBQUMxRixNQUFNLE9BQU8sR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQztBQUVwQzs7Ozs7Ozs7Ozs7Ozs7O0dBZUc7QUFDSSxLQUFLLFVBQVUsT0FBTyxDQUMzQixLQUEyQixFQUMzQixPQUFnQjtJQUVoQixNQUFNLFNBQVMsR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7SUFFN0IsSUFBSSxDQUFDO1FBQ0gsZUFBTSxDQUFDLElBQUksQ0FBQyw4QkFBOEIsRUFBRTtZQUMxQyxVQUFVLEVBQUUsT0FBTyxDQUFDLFlBQVk7WUFDaEMsYUFBYSxFQUFFLE9BQU8sQ0FBQyxZQUFZO1lBQ25DLFNBQVMsRUFBRSxLQUFLLENBQUMsY0FBYyxFQUFFLFNBQVM7U0FDM0MsQ0FBQyxDQUFDO1FBRUgsVUFBVTtRQUNWLGNBQWMsQ0FBQyxLQUFLLENBQUMsQ0FBQztRQUV0Qix1QkFBdUI7UUFDdkIsTUFBTSxRQUFRLEdBQUcsZ0JBQWdCLENBQUMsS0FBSyxDQUFDLENBQUM7UUFFekMsd0JBQXdCO1FBQ3hCLE1BQU0sWUFBWSxHQUFHLE1BQU0sZUFBZSxDQUFDLFFBQVEsQ0FBQyxD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LFVBQVUsR0FBRyxHQUFHLENBQUM7SUFDckIsSUFBSSxTQUFTLEdBQUcsZ0JBQWdCLENBQUM7SUFFakMsSUFBSSxLQUFLLFlBQVksd0JBQWUsRUFBRSxDQUFDO1FBQ3JDLFVBQVUsR0FBRyxHQUFHLENBQUM7UUFDakIsU0FBUyxHQUFHLGtCQUFrQixDQUFDO0lBQ2pDLENBQUM7U0FBTSxJQUFJLEtBQUssWUFBWSw0QkFBbUIsRUFBRSxDQUFDO1FBQ2hELFVBQVUsR0FBRyxHQUFHLENBQUM7UUFDakIsU0FBUyxHQUFHLGNBQWMsQ0FBQztJQUM3QixDQUFDO1NBQU0sSUFBSSxLQUFLLFlBQVksc0JBQWEsRUFBRSxDQUFDO1FBQzFDLFVBQVUsR0FBRyxHQUFHLENBQUM7UUFDakIsU0FBUyxHQUFHLFdBQVcsQ0FBQztJQUMxQixDQUFDO0lBRUQsT0FBTztRQUNMLFVBQVU7UUFDVixPQUFPLEVBQUU7WUFDUCxjQUFjLEVBQUUsa0JBQWtCO1lBQ2xDLDZCQUE2QixFQUFFLEdBQUc7WUFDbEMsOEJBQThCLEVBQUUsd0JBQXdCO1NBQ3pEO1FBQ0QsSUFBSSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUM7WUFDbkIsTUFBTSxFQUFFLE9BQU87WUFDZixLQUFLLEVBQUU7Z0JBQ0wsSUFBSSxFQUFFLFNBQVM7Z0JBQ2YsT0FBTyxFQUFFLEtBQUssQ0FBQyxPQUFPO2dCQUN0QixPQUFPLEVBQUcsS0FBYSxDQUFDLE9BQU8sSUFBSSxFQUFFO2FBQ3RDO1lBQ0QsVUFBVSxFQUFFLFNBQVM7U0FDdEIsQ0FBQztLQUNILENBQUM7QUFDSixDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcdGkxOThcXGludmVzdG1lbnRfYW5hbHlzaXNfb3BvcG9cXHNyY1xcbGFtYmRhXFxhcGlcXGV4cG9ydC1zdGF0dXNcXGhhbmRsZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIExhbWJkYSBFeHBvcnQgU3RhdHVzIEhhbmRsZXJcclxuICpcclxuICogR0VUIC9leHBvcnRzL3tleHBvcnRfaWR9IOOCqOODs+ODieODneOCpOODs+ODiFxyXG4gKiDjgqjjgq/jgrnjg53jg7zjg4jnirbmhYvjgpJEeW5hbW9EQuOBi+OCieWPluW+l+OBl+OBpui/lOWNtOOBl+OBvuOBmeOAglxyXG4gKlxyXG4gKiBSZXF1aXJlbWVudHM6IOOCv+OCueOCrzEzLjVcclxuICovXHJcblxyXG5pbXBvcnQgeyBBUElHYXRld2F5UHJveHlFdmVudCwgQVBJR2F0ZXdheVByb3h5UmVzdWx0LCBDb250ZXh0IH0gZnJvbSAnYXdzLWxhbWJkYSc7XHJcbmltcG9ydCB7IER5bmFtb0RCQ2xpZW50LCBHZXRJdGVtQ29tbWFuZCB9IGZyb20gJ0Bhd3Mtc2RrL2NsaWVudC1keW5hbW9kYic7XHJcbmltcG9ydCB7IGxvZ2dlciwgY3JlYXRlRXJyb3JDb250ZXh0IH0gZnJvbSAnLi4vLi4vLi4vdXRpbHMvbG9nZ2VyJztcclxuaW1wb3J0IHsgc2VuZEVycm9yTWV0cmljLCBzZW5kTWV0cmljcyB9IGZyb20gJy4uLy4uLy4uL3V0aWxzL2Nsb3Vkd2F0Y2gtbWV0cmljcyc7XHJcbmltcG9ydCB7IFZhbGlkYXRpb25FcnJvciwgTm90Rm91bmRFcnJvciwgQXV0aGVudGljYXRpb25FcnJvciB9IGZyb20gJy4uLy4uLy4uL2Vycm9ycyc7XHJcbmltcG9ydCB7IHJldHJ5V2l0aEJhY2tvZmYgfSBmcm9tICcuLi8uLi8uLi91dGlscy9yZXRyeSc7XHJcblxyXG4vLyBEeW5hbW9EQuOCr+ODqeOCpOOCouODs+ODiO+8iOOCsOODreODvOODkOODq+OCueOCs+ODvOODl+OBp+WIneacn+WMlu+8iVxyXG5jb25zdCBkeW5hbW9DbGllbnQgPSBuZXcgRHluYW1vREJDbGllbnQoeyByZWdpb246IHByb2Nlc3MuZW52LkFXU19SRUdJT04gfHwgJ2FwLW5vcnRoZWFzdC0xJyB9KTtcclxuXHJcbi8vIOeSsOWig+WkieaVsFxyXG5jb25zdCBFWFBPUlRfU1RBVFVTX1RBQkxFID0gcHJvY2Vzcy5lbnYuRVhQT1JUX1NUQVRVU19UQUJMRV9OQU1FIHx8ICd0ZG5ldF9leHBvcnRfc3RhdHVzJztcclxuY29uc3QgQVBJX0tFWSA9IHByb2Nlc3MuZW52LkFQSV9LRVk7XHJcblxyXG4vKipcclxuICogTGFtYmRhIEV4cG9ydCBTdGF0dXMgSGFuZGxlclxyXG4gKlxyXG4gKiBAcGFyYW0gZXZlbnQgQVBJR2F0ZXdheVByb3h5RXZlbnRcclxuICogQHBhcmFtIGNvbnRleHQgTGFtYmRhIENvbnRleHRcclxuICogQHJldHVybnMgQVBJR2F0ZXdheVByb3h5UmVzdWx0XHJcbiAqXHJcbiAqIEBleGFtcGxlXHJcbiAqIGBgYHR5cGVzY3JpcHRcclxuICogLy8gR0VUIC9leHBvcnRzL2V4cG9ydC0yMDI0MDExNS14eXo3ODlcclxuICogY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBoYW5kbGVyKHtcclxuICogICBwYXRoUGFyYW1ldGVyczogeyBleHBvcnRfaWQ6ICdleHBvcnQtMjAyNDAxMTUteHl6Nzg5JyB9LFxyXG4gKiAgIGhlYWRlcnM6IHsgJ3gtYXBpLWtleSc6ICd5b3VyLWFwaS1rZXknIH0sXHJcbiAqIH0sIGNvbnRleHQpO1xyXG4gKiBgYGBcclxuICovXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKFxyXG4gIGV2ZW50OiBBUElHYXRld2F5UHJveHlFdmVudCxcclxuICBjb250ZXh0OiBDb250ZXh0XHJcbik6IFByb21pc2U8QVBJR2F0ZXdheVByb3h5UmVzdWx0PiB7XHJcbiAgY29uc3Qgc3RhcnRUaW1lID0gRGF0ZS5ub3coKTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIGxvZ2dlci5pbmZvKCdMYW1iZGEgRXhwb3J0IFN0YXR1cyBzdGFydGVkJywge1xyXG4gICAgICByZXF1ZXN0X2lkOiBjb250ZXh0LmF3c1JlcXVlc3RJZCxcclxuICAgICAgZnVuY3Rpb25fbmFtZTogY29udGV4dC5mdW5jdGlvbk5hbWUsXHJcbiAgICAgIGV4cG9ydF9pZDogZXZlbnQucGF0aFBhcmFtZXRlcnM/LmV4cG9ydF9pZCxcclxuICAgIH0pO1xyXG5cclxuICAgIC8vIEFQSeOCreODvOiqjeiovFxyXG4gICAgdmFsaWRhdGVBcGlLZXkoZXZlbnQpO1xyXG5cclxuICAgIC8vIGV4cG9ydF9pZOOBruWPluW+l+OBqOODkOODquODh+ODvOOCt+ODp+ODs1xyXG4gICAgY29uc3QgZXhwb3J0SWQgPSB2YWxpZGF0ZUV4cG9ydElkKGV2ZW50KTtcclxuXHJcbiAgICAvLyBEeW5hbW9EQuOBi+OCieOCqOOCr+OCueODneODvOODiOeKtuaFi+OCkuWPluW+l1xyXG4gICAgY29uc3QgZXhwb3J0U3RhdHVzID0gYXdhaXQgZ2V0RXhwb3J0U3RhdHVzKGV4cG9ydElkKTtcclxuXHJcbiAgICBjb25zdCBkdXJhdGlvbiA9IERhdGUubm93KCkgLSBzdGFydFRpbWU7XHJcblxyXG4gICAgbG9nZ2VyLmluZm8oJ0xhbWJkYSBFeHBvcnQgU3RhdHVzIGNvbXBsZXRlZCcsIHtcclxuICAgICAgZXhwb3J0X2lkOiBleHBvcnRJZCxcclxuICAgICAgc3RhdHVzOiBleHBvcnRTdGF0dXMuc3RhdHVzLFxyXG4gICAgICBkdXJhdGlvbl9tczogZHVyYXRpb24sXHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyDmiJDlip/jg6Hjg4jjg6rjgq/jgrnpgIHkv6FcclxuICAgIGF3YWl0IHNlbmRNZXRyaWNzKFtcclxuICAgICAge1xyXG4gICAgICAgIG5hbWU6ICdMYW1iZGFFeGVjdXRpb25UaW1lJyxcclxuICAgICAgICB2YWx1ZTogZHVyYXRpb24sXHJcbiAgICAgICAgdW5pdDogJ01pbGxpc2Vjb25kcycsXHJcbiAgICAgICAgZGltZW5zaW9uczogeyBGdW5jdGlvbk5hbWU6ICdFeHBvcnRTdGF0dXMnIH0sXHJcbiAgICAgIH0sXHJcbiAgICAgIHtcclxuICAgICAgICBuYW1lOiAnRXhwb3J0U3RhdHVzUXVlcmllcycsXHJcbiAgICAgICAgdmFsdWU6IDEsXHJcbiAgICAgICAgdW5pdDogJ0NvdW50JyxcclxuICAgICAgICBkaW1lbnNpb25zOiB7IFN0YXR1czogZXhwb3J0U3RhdHVzLnN0YXR1cyB9LFxyXG4gICAgICB9LFxyXG4gICAgXSk7XHJcblxyXG4gICAgLy8g44Os44K544Od44Oz44K5XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICBzdGF0dXNDb2RlOiAyMDAsXHJcbiAgICAgIGhlYWRlcnM6IHtcclxuICAgICAgICAnQ29udGVudC1UeXBlJzogJ2FwcGxpY2F0aW9uL2pzb24nLFxyXG4gICAgICAgICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nOiAnKicsXHJcbiAgICAgICAgJ0FjY2Vzcy1Db250cm9sLUFsbG93LUhlYWRlcnMnOiAnQ29udGVudC1UeXBlLFgtQXBpLUtleScsXHJcbiAgICAgIH0sXHJcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgICBzdGF0dXM6ICdzdWNjZXNzJyxcclxuICAgICAgICBkYXRhOiBleHBvcnRTdGF0dXMsXHJcbiAgICAgIH0pLFxyXG4gICAgfTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc3QgZHVyYXRpb24gPSBEYXRlLm5vdygpIC0gc3RhcnRUaW1lO1xyXG5cclxuICAgIGxvZ2dlci5lcnJvcihcclxuICAgICAgJ0xhbWJkYSBFeHBvcnQgU3RhdHVzIGZhaWxlZCcsXHJcbiAgICAgIGNyZWF0ZUVycm9yQ29udGV4dChlcnJvciBhcyBFcnJvciwge1xyXG4gICAgICAgIHJlcXVlc3RfaWQ6IGNvbnRleHQuYXdzUmVxdWVzdElkLFxyXG4gICAgICAgIGV4cG9ydF9pZDogZXZlbnQucGF0aFBhcmFtZXRlcnM/LmV4cG9ydF9pZCxcclxuICAgICAgICBkdXJhdGlvbl9tczogZHVyYXRpb24sXHJcbiAgICAgIH0pXHJcbiAgICApO1xyXG5cclxuICAgIC8vIOOCqOODqeODvOODoeODiOODquOCr+OCuemAgeS/oVxyXG4gICAgYXdhaXQgc2VuZEVycm9yTWV0cmljKFxyXG4gICAgICBlcnJvciBpbnN0YW5jZW9mIEVycm9yID8gZXJyb3IuY29uc3RydWN0b3IubmFtZSA6ICdVbmtub3duJyxcclxuICAgICAgJ0V4cG9ydFN0YXR1cydcclxuICAgICk7XHJcblxyXG4gICAgLy8g44Ko44Op44O844Os44K544Od44Oz44K5XHJcbiAgICByZXR1cm4gaGFuZGxlRXJyb3IoZXJyb3IgYXMgRXJyb3IsIGNvbnRleHQuYXdzUmVxdWVzdElkKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBBUEnjgq3jg7zoqo3oqLxcclxuICpcclxuICogQHBhcmFtIGV2ZW50IEFQSUdhdGV3YXlQcm94eUV2ZW50XHJcbiAqIEB0aHJvd3MgQXV0aGVudGljYXRpb25FcnJvciBBUEnjgq3jg7zjgYznhKHlirnjgarloLTlkIhcclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlQXBpS2V5KGV2ZW50OiBBUElHYXRld2F5UHJveHlFdmVudCk6IHZvaWQge1xyXG4gIGNvbnN0IGFwaUtleSA9IGV2ZW50LmhlYWRlcnM/LlsneC1hcGkta2V5J10gfHwgZXZlbnQuaGVhZGVycz8uWydYLUFwaS1LZXknXTtcclxuXHJcbiAgaWYgKCFhcGlLZXkpIHtcclxuICAgIHRocm93IG5ldyBBdXRoZW50aWNhdGlvbkVycm9yKCdBUEkga2V5IGlzIHJlcXVpcmVkJyk7XHJcbiAgfVxyXG5cclxuICAvLyDnkrDlooPlpInmlbDjgYvjgonnm7TmjqXoqq3jgb/lj5bjgovvvIjjg4bjgrnjg4jnkrDlooPjgafjga7li5XnmoToqK3lrprjgavlr77lv5zvvIlcclxuICBjb25zdCBleHBlY3RlZEFwaUtleSA9IHByb2Nlc3MuZW52LkFQSV9LRVk7XHJcbiAgaWYgKGV4cGVjdGVkQXBpS2V5ICYmIGFwaUtleSAhPT0gZXhwZWN0ZWRBcGlLZXkpIHtcclxuICAgIHRocm93IG5ldyBBdXRoZW50aWNhdGlvbkVycm9yKCdJbnZhbGlkIEFQSSBrZXknKTtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBleHBvcnRfaWTjga7jg5Djg6rjg4fjg7zjgrfjg6fjg7NcclxuICpcclxuICogQHBhcmFtIGV2ZW50IEFQSUdhdGV3YXlQcm94eUV2ZW50XHJcbiAqIEByZXR1cm5zIGV4cG9ydF9pZFxyXG4gKiBAdGhyb3dzIFZhbGlkYXRpb25FcnJvciBleHBvcnRfaWTjgYznhKHlirnjgarloLTlkIhcclxuICovXHJcbmZ1bmN0aW9uIHZhbGlkYXRlRXhwb3J0SWQoZXZlbnQ6IEFQSUdhdGV3YXlQcm94eUV2ZW50KTogc3RyaW5nIHtcclxuICBjb25zdCBleHBvcnRJZCA9IGV2ZW50LnBhdGhQYXJhbWV0ZXJzPy5leHBvcnRfaWQ7XHJcblxyXG4gIGlmICghZXhwb3J0SWQpIHtcclxuICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoJ2V4cG9ydF9pZCBpcyByZXF1aXJlZCcpO1xyXG4gIH1cclxuXHJcbiAgLy8gZXhwb3J0X2lk44Gu44OV44Kp44O844Oe44OD44OI5qSc6Ki877yI5L6LOiBleHBvcnQtMjAyNDAxMTUteHl6Nzg577yJXHJcbiAgaWYgKCEvXmV4cG9ydC1cXGR7OH0tW2EtejAtOV0rJC8udGVzdChleHBvcnRJZCkpIHtcclxuICAgIHRocm93IG5ldyBWYWxpZGF0aW9uRXJyb3IoXHJcbiAgICAgIGBJbnZhbGlkIGV4cG9ydF9pZCBmb3JtYXQ6ICR7ZXhwb3J0SWR9LiBFeHBlY3RlZCBmb3JtYXQ6IGV4cG9ydC1ZWVlZTU1ERC17aWR9YFxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIHJldHVybiBleHBvcnRJZDtcclxufVxyXG5cclxuLyoqXHJcbiAqIER5bmFtb0RC44GL44KJ44Ko44Kv44K544Od44O844OI54q25oWL44KS5Y+W5b6XXHJcbiAqXHJcbiAqIEBwYXJhbSBleHBvcnRJZCDjgqjjgq/jgrnjg53jg7zjg4hJRFxyXG4gKiBAcmV0dXJucyDjgqjjgq/jgrnjg53jg7zjg4jnirbmhYtcclxuICogQHRocm93cyBOb3RGb3VuZEVycm9yIOOCqOOCr+OCueODneODvOODiOOBjOimi+OBpOOBi+OCieOBquOBhOWgtOWQiFxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gZ2V0RXhwb3J0U3RhdHVzKGV4cG9ydElkOiBzdHJpbmcpOiBQcm9taXNlPEV4cG9ydFN0YXR1cz4ge1xyXG4gIGxvZ2dlci5pbmZvKCdGZXRjaGluZyBleHBvcnQgc3RhdHVzIGZyb20gRHluYW1vREInLCB7XHJcbiAgICBleHBvcnRfaWQ6IGV4cG9ydElkLFxyXG4gICAgdGFibGU6IEVYUE9SVF9TVEFUVVNfVEFCTEUsXHJcbiAgfSk7XHJcblxyXG4gIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJldHJ5V2l0aEJhY2tvZmYoXHJcbiAgICBhc3luYyAoKSA9PiB7XHJcbiAgICAgIHJldHVybiBhd2FpdCBkeW5hbW9DbGllbnQuc2VuZChcclxuICAgICAgICBuZXcgR2V0SXRlbUNvbW1hbmQoe1xyXG4gICAgICAgICAgVGFibGVOYW1lOiBFWFBPUlRfU1RBVFVTX1RBQkxFLFxyXG4gICAgICAgICAgS2V5OiB7XHJcbiAgICAgICAgICAgIGV4cG9ydF9pZDogeyBTOiBleHBvcnRJZCB9LFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9KVxyXG4gICAgICApO1xyXG4gICAgfSxcclxuICAgIHtcclxuICAgICAgbWF4UmV0cmllczogMyxcclxuICAgICAgaW5pdGlhbERlbGF5OiAxMDAwLFxyXG4gICAgICBiYWNrb2ZmTXVsdGlwbGllcjogMixcclxuICAgICAgaml0dGVyOiB0cnVlLFxyXG4gICAgICBzaG91bGRSZXRyeTogKGVycm9yKSA9PiB7XHJcbiAgICAgICAgcmV0dXJuIGVycm9yLm5hbWUgPT09ICdQcm92aXNpb25lZFRocm91Z2hwdXRFeGNlZWRlZEV4Y2VwdGlvbic7XHJcbiAgICAgIH0sXHJcbiAgICB9XHJcbiAgKTtcclxuXHJcbiAgaWYgKCFyZXN1bHQuSXRlbSkge1xyXG4gICAgdGhyb3cgbmV3IE5vdEZvdW5kRXJyb3IoYEV4cG9ydCBub3QgZm91bmQ6ICR7ZXhwb3J0SWR9YCk7XHJcbiAgfVxyXG5cclxuICAvLyBEeW5hbW9EQuOCouOCpOODhuODoOOCkkV4cG9ydFN0YXR1c+OBq+WkieaPm1xyXG4gIGNvbnN0IGl0ZW0gPSByZXN1bHQuSXRlbTtcclxuXHJcbiAgY29uc3QgZXhwb3J0U3RhdHVzOiBFeHBvcnRTdGF0dXMgPSB7XHJcbiAgICBleHBvcnRfaWQ6IGl0ZW0uZXhwb3J0X2lkLlMhLFxyXG4gICAgc3RhdHVzOiBpdGVtLnN0YXR1cy5TISBhcyAncGVuZGluZycgfCAncHJvY2Vzc2luZycgfCAnY29tcGxldGVkJyB8ICdmYWlsZWQnLFxyXG4gICAgcHJvZ3Jlc3M6IHBhcnNlSW50KGl0ZW0ucHJvZ3Jlc3MuTiEsIDEwKSxcclxuICAgIHJlcXVlc3RlZF9hdDogaXRlbS5yZXF1ZXN0ZWRfYXQuUyEsXHJcbiAgICBjb21wbGV0ZWRfYXQ6IGl0ZW0uY29tcGxldGVkX2F0Py5TIHx8IG51bGwsXHJcbiAgICBleHBvcnRfY291bnQ6IGl0ZW0uZXhwb3J0X2NvdW50Py5OID8gcGFyc2VJbnQoaXRlbS5leHBvcnRfY291bnQuTiwgMTApIDogbnVsbCxcclxuICAgIGZpbGVfc2l6ZTogaXRlbS5maWxlX3NpemU/Lk4gPyBwYXJzZUludChpdGVtLmZpbGVfc2l6ZS5OLCAxMCkgOiBudWxsLFxyXG4gICAgZG93bmxvYWRfdXJsOiBpdGVtLmRvd25sb2FkX3VybD8uUyB8fCBudWxsLFxyXG4gICAgZXhwaXJlc19hdDogaXRlbS5leHBpcmVzX2F0Py5TIHx8IG51bGwsXHJcbiAgICBlcnJvcl9tZXNzYWdlOiBpdGVtLmVycm9yX21lc3NhZ2U/LlMgfHwgbnVsbCxcclxuICB9O1xyXG5cclxuICBsb2dnZXIuaW5mbygnRXhwb3J0IHN0YXR1cyBmZXRjaGVkIHN1Y2Nlc3NmdWxseScsIHtcclxuICAgIGV4cG9ydF9pZDogZXhwb3J0SWQsXHJcbiAgICBzdGF0dXM6IGV4cG9ydFN0YXR1cy5zdGF0dXMsXHJcbiAgICBwcm9ncmVzczogZXhwb3J0U3RhdHVzLnByb2dyZXNzLFxyXG4gIH0pO1xyXG5cclxuICByZXR1cm4gZXhwb3J0U3RhdHVzO1xyXG59XHJcblxyXG4vKipcclxuICog44Ko44Op44O844OP44Oz44OJ44Oq44Oz44KwXHJcbiAqXHJcbiAqIEBwYXJhbSBlcnJvciDjgqjjg6njg7zjgqrjg5bjgrjjgqfjgq/jg4hcclxuICogQHBhcmFtIHJlcXVlc3RJZCDjg6rjgq/jgqjjgrnjg4hJRFxyXG4gKiBAcmV0dXJucyBBUElHYXRld2F5UHJveHlSZXN1bHRcclxuICovXHJcbmZ1bmN0aW9uIGhhbmRsZUVycm9yKGVycm9yOiBFcnJvciwgcmVxdWVzdElkOiBzdHJpbmcpOiBBUElHYXRld2F5UHJveHlSZXN1bHQge1xyXG4gIC8vIOOCqOODqeODvOeoruWIpeOBq+W/nOOBmOOBn+OCueODhuODvOOCv+OCueOCs+ODvOODieOBqOOCqOODqeODvOOCs+ODvOODiVxyXG4gIGxldCBzdGF0dXNDb2RlID0gNTAwO1xyXG4gIGxldCBlcnJvckNvZGUgPSAnSU5URVJOQUxfRVJST1InO1xyXG5cclxuICBpZiAoZXJyb3IgaW5zdGFuY2VvZiBWYWxpZGF0aW9uRXJyb3IpIHtcclxuICAgIHN0YXR1c0NvZGUgPSA0MDA7XHJcbiAgICBlcnJvckNvZGUgPSAnVkFMSURBVElPTl9FUlJPUic7XHJcbiAgfSBlbHNlIGlmIChlcnJvciBpbnN0YW5jZW9mIEF1dGhlbnRpY2F0aW9uRXJyb3IpIHtcclxuICAgIHN0YXR1c0NvZGUgPSA0MDE7XHJcbiAgICBlcnJvckNvZGUgPSAnVU5BVVRIT1JJWkVEJztcclxuICB9IGVsc2UgaWYgKGVycm9yIGluc3RhbmNlb2YgTm90Rm91bmRFcnJvcikge1xyXG4gICAgc3RhdHVzQ29kZSA9IDQwNDtcclxuICAgIGVycm9yQ29kZSA9ICdOT1RfRk9VTkQnO1xyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHtcclxuICAgIHN0YXR1c0NvZGUsXHJcbiAgICBoZWFkZXJzOiB7XHJcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXHJcbiAgICAgICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1PcmlnaW4nOiAnKicsXHJcbiAgICAgICdBY2Nlc3MtQ29udHJvbC1BbGxvdy1IZWFkZXJzJzogJ0NvbnRlbnQtVHlwZSxYLUFwaS1LZXknLFxyXG4gICAgfSxcclxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcclxuICAgICAgc3RhdHVzOiAnZXJyb3InLFxyXG4gICAgICBlcnJvcjoge1xyXG4gICAgICAgIGNvZGU6IGVycm9yQ29kZSxcclxuICAgICAgICBtZXNzYWdlOiBlcnJvci5tZXNzYWdlLFxyXG4gICAgICAgIGRldGFpbHM6IChlcnJvciBhcyBhbnkpLmRldGFpbHMgfHwge30sXHJcbiAgICAgIH0sXHJcbiAgICAgIHJlcXVlc3RfaWQ6IHJlcXVlc3RJZCxcclxuICAgIH0pLFxyXG4gIH07XHJcbn1cclxuXHJcbi8qKlxyXG4gKiDjgqjjgq/jgrnjg53jg7zjg4jnirbmhYvjga7lnovlrprnvqlcclxuICovXHJcbmludGVyZmFjZSBFeHBvcnRTdGF0dXMge1xyXG4gIGV4cG9ydF9pZDogc3RyaW5nO1xyXG4gIHN0YXR1czogJ3BlbmRpbmcnIHwgJ3Byb2Nlc3NpbmcnIHwgJ2NvbXBsZXRlZCcgfCAnZmFpbGVkJztcclxuICBwcm9ncmVzczogbnVtYmVyO1xyXG4gIHJlcXVlc3RlZF9hdDogc3RyaW5nO1xyXG4gIGNvbXBsZXRlZF9hdDogc3RyaW5nIHwgbnVsbDtcclxuICBleHBvcnRfY291bnQ6IG51bWJlciB8IG51bGw7XHJcbiAgZmlsZV9zaXplOiBudW1iZXIgfCBudWxsO1xyXG4gIGRvd25sb2FkX3VybDogc3RyaW5nIHwgbnVsbDtcclxuICBleHBpcmVzX2F0OiBzdHJpbmcgfCBudWxsO1xyXG4gIGVycm9yX21lc3NhZ2U6IHN0cmluZyB8IG51bGw7XHJcbn1cclxuIl0sInZlcnNpb24iOjN9