b5b9473a688c1077aee28bd7cd2b664e
"use strict";
/**
 * API Gateway + WAF構造の検証テスト
 *
 * このテストは、API GatewayとAWS WAFが正しく設定されていることを検証します。
 *
 * Requirements:
 * - 要件11.1: API認証（APIキー認証）
 * - 要件11.2: 使用量プラン設定
 * - 要件13.1: WAF保護（レート制限、マネージドルール）
 *
 * Test Coverage:
 * - API Gatewayが正しく作成されていることを確認
 * - APIキー認証が有効化されていることを確認
 * - 使用量プランが設定されていることを確認
 * - CORS設定が正しいことを確認
 * - WAFが関連付けられていることを確認
 * - WAFルールが正しく設定されていることを確認
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const cdk = __importStar(require("aws-cdk-lib"));
const assertions_1 = require("aws-cdk-lib/assertions");
const tdnet_data_collector_stack_1 = require("../lib/tdnet-data-collector-stack");
describe('API Gateway + WAF構造の検証', () => {
    let template;
    beforeAll(() => {
        const app = new cdk.App();
        const stack = new tdnet_data_collector_stack_1.TdnetDataCollectorStack(app, 'TestStack', {
            env: {
                account: '123456789012',
                region: 'ap-northeast-1',
            },
        });
        template = assertions_1.Template.fromStack(stack);
    });
    describe('API Gateway REST API', () => {
        it('REST APIが作成されていること', () => {
            template.hasResourceProperties('AWS::ApiGateway::RestApi', {
                Name: 'tdnet-data-collector-api',
                Description: 'TDnet Data Collector REST API',
            });
        });
        it('デプロイメント設定が正しいこと', () => {
            template.hasResourceProperties('AWS::ApiGateway::Deployment', {
                Description: assertions_1.Match.anyValue(),
            });
            template.hasResourceProperties('AWS::ApiGateway::Stage', {
                StageName: 'prod',
                MethodSettings: assertions_1.Match.arrayWith([
                    assertions_1.Match.objectLike({
                        LoggingLevel: 'INFO',
                        DataTraceEnabled: true,
                        MetricsEnabled: true,
                    }),
                ]),
            });
        });
        it('CORS設定が有効化されていること', () => {
            // OPTIONSメソッドが存在することを確認
            template.hasResourceProperties('AWS::ApiGateway::Method', {
                HttpMethod: 'OPTIONS',
                Integration: assertions_1.Match.objectLike({
                    Type: 'MOCK',
                    IntegrationResponses: assertions_1.Match.arrayWith([
                        assertions_1.Match.objectLike({
                            ResponseParameters: assertions_1.Match.objectLike({
                                'method.response.header.Access-Control-Allow-Headers': assertions_1.Match.stringLikeRegexp('.*X-Api-Key.*'),
                                'method.response.header.Access-Control-Allow-Methods': assertions_1.Match.anyValue(),
                                'method.response.header.Access-Control-Allow-Origin': assertions_1.Match.anyValue(),
                            }),
                        }),
                    ]),
                }),
            });
        });
        it('CloudWatch Logsロールが設定されていること', () => {
            template.hasResourceProperties('AWS::ApiGateway::Account', {
                CloudWatchRoleArn: assertions_1.Match.anyValue(),
            });
        });
    });
    describe('API Key認証', () => {
        it('APIキーが作成されていること', () => {
            template.hasResourceProperties('AWS::ApiGateway::ApiKey', {
                Name: 'tdnet-api-key',
                Description: 'API Key for TDnet Data Collector',
                Enabled: true,
            });
        });
        it('使用量プランが作成されていること', () => {
            template.hasResourceProperties('AWS::ApiGateway::UsagePlan', {
                UsagePlanName: 'tdnet-usage-plan',
                Description: 'Usage plan for TDnet Data Collector API',
                Throttle: {
                    RateLimit: 100,
                    BurstLimit: 200,
                },
                Quota: {
                    Limit: 10000,
                    Period: 'MONTH',
                },
            });
        });
        it('APIキーが使用量プランに関連付けられていること', () => {
            template.hasResourceProperties('AWS::ApiGateway::UsagePlanKey', {
                KeyType: 'API_KEY',
            });
        });
    });
    describe('AWS WAF設定', () => {
        it('Web ACLが作成されていること', () => {
            template.hasResourceProperties('AWS::WAFv2::WebACL', {
                Name: 'tdnet-web-acl',
                Scope: 'REGIONAL',
                DefaultAction: { Allow: {} },
                Description: 'Web ACL for TDnet Data Collector API',
                VisibilityConfig: {
                    SampledRequestsEnabled: true,
                    CloudWatchMetricsEnabled: true,
                    MetricName: 'TdnetWebAcl',
                },
            });
        });
        it('レート制限ルールが設定されていること', () => {
            template.hasResourceProperties('AWS::WAFv2::WebACL', {
                Rules: assertions_1.Match.arrayWith([
                    assertions_1.Match.objectLike({
                        Name: 'RateLimitRule',
                        Priority: 1,
                        Statement: {
                            RateBasedStatement: {
                                Limit: 2000, // 5分間で2000リクエスト
                                AggregateKeyType: 'IP',
                            },
                        },
                        Action: {
                            Block: {
                                CustomResponse: {
                                    ResponseCode: 429,
                                    CustomResponseBodyKey: 'RateLimitExceeded',
                                },
                            },
                        },
                        VisibilityConfig: {
                            SampledRequestsEnabled: true,
                            CloudWatchMetricsEnabled: true,
                            MetricName: 'RateLimitRule',
                        },
                    }),
                ]),
            });
        });
        it('AWSマネージドルール（Common Rule Set）が適用されていること', () => {
            template.hasResourceProperties('AWS::WAFv2::WebACL', {
                Rules: assertions_1.Match.arrayWith([
                    assertions_1.Match.objectLike({
                        Name: 'AWSManagedRulesCommonRuleSet',
                        Priority: 2,
                        Statement: {
                            ManagedRuleGroupStatement: {
                                VendorName: 'AWS',
                                Name: 'AWSManagedRulesCommonRuleSet',
                            },
                        },
                        OverrideAction: { None: {} },
                    }),
                ]),
            });
        });
        it('AWSマネージドルール（Known Bad Inputs）が適用されていること', () => {
            template.hasResourceProperties('AWS::WAFv2::WebACL', {
                Rules: assertions_1.Match.arrayWith([
                    assertions_1.Match.objectLike({
                        Name: 'AWSManagedRulesKnownBadInputsRuleSet',
                        Priority: 3,
                        Statement: {
                            ManagedRuleGroupStatement: {
                                VendorName: 'AWS',
                                Name: 'AWSManagedRulesKnownBadInputsRuleSet',
                            },
                        },
                        OverrideAction: { None: {} },
                    }),
                ]),
            });
        });
        it('カスタムレスポンスボディが設定されていること', () => {
            template.hasResourceProperties('AWS::WAFv2::WebACL', {
                CustomResponseBodies: {
                    RateLimitExceeded: {
                        ContentType: 'APPLICATION_JSON',
                        Content: assertions_1.Match.stringLikeRegexp('.*RATE_LIMIT_EXCEEDED.*'),
                    },
                },
            });
        });
        it('WAFがAPI Gatewayに関連付けられていること', () => {
            template.hasResourceProperties('AWS::WAFv2::WebACLAssociation', {
                ResourceArn: assertions_1.Match.anyValue(),
                WebACLArn: assertions_1.Match.anyValue(), // 正しいプロパティ名は WebACLArn
            });
        });
    });
    describe('CloudFormation Outputs', () => {
        it('API Endpointが出力されていること', () => {
            template.hasOutput('ApiEndpoint', {
                Description: 'API Gateway endpoint URL',
                Export: {
                    Name: 'TdnetApiEndpoint',
                },
            });
        });
        it('API Key IDが出力されていること', () => {
            template.hasOutput('ApiKeyId', {
                Description: 'API Key ID',
                Export: {
                    Name: 'TdnetApiKeyId',
                },
            });
        });
        it('Web ACL ARNが出力されていること', () => {
            template.hasOutput('WebAclArn', {
                Description: 'WAF Web ACL ARN',
                Export: {
                    Name: 'TdnetWebAclArn',
                },
            });
        });
    });
    describe('セキュリティ設定', () => {
        it('API Gatewayのログが有効化されていること', () => {
            template.hasResourceProperties('AWS::ApiGateway::Stage', {
                MethodSettings: assertions_1.Match.arrayWith([
                    assertions_1.Match.objectLike({
                        LoggingLevel: 'INFO',
                        DataTraceEnabled: true,
                    }),
                ]),
            });
        });
        it('スロットリング設定が有効化されていること', () => {
            // スロットリング設定は使用量プランで管理される
            template.hasResourceProperties('AWS::ApiGateway::UsagePlan', {
                Throttle: {
                    RateLimit: 100,
                    BurstLimit: 200,
                },
            });
        });
        it('使用量プランにクォータが設定されていること', () => {
            template.hasResourceProperties('AWS::ApiGateway::UsagePlan', {
                Quota: {
                    Limit: 10000,
                    Period: 'MONTH',
                },
            });
        });
    });
    describe('パフォーマンス設定', () => {
        it('API Gatewayメトリクスが有効化されていること', () => {
            template.hasResourceProperties('AWS::ApiGateway::Stage', {
                MethodSettings: assertions_1.Match.arrayWith([
                    assertions_1.Match.objectLike({
                        MetricsEnabled: true,
                    }),
                ]),
            });
        });
        it('WAFメトリクスが有効化されていること', () => {
            template.hasResourceProperties('AWS::WAFv2::WebACL', {
                VisibilityConfig: {
                    CloudWatchMetricsEnabled: true,
                    MetricName: 'TdnetWebAcl',
                },
            });
        });
    });
    describe('エラーハンドリング', () => {
        it('レート制限超過時のカスタムレスポンスが設定されていること', () => {
            template.hasResourceProperties('AWS::WAFv2::WebACL', {
                Rules: assertions_1.Match.arrayWith([
                    assertions_1.Match.objectLike({
                        Name: 'RateLimitRule',
                        Action: {
                            Block: {
                                CustomResponse: {
                                    ResponseCode: 429,
                                    CustomResponseBodyKey: 'RateLimitExceeded',
                                },
                            },
                        },
                    }),
                ]),
            });
        });
        it('カスタムレスポンスにエラーコードが含まれていること', () => {
            template.hasResourceProperties('AWS::WAFv2::WebACL', {
                CustomResponseBodies: {
                    RateLimitExceeded: {
                        Content: assertions_1.Match.stringLikeRegexp('.*error_code.*'),
                    },
                },
            });
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFx0aTE5OFxcaW52ZXN0bWVudF9hbmFseXNpc19vcG9wb1xcY2RrXFxfX3Rlc3RzX19cXGFwaS1nYXRld2F5LXdhZi50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7Ozs7Ozs7Ozs7Ozs7Ozs7R0FpQkc7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBRUgsaURBQW1DO0FBQ25DLHVEQUF5RDtBQUN6RCxrRkFBNEU7QUFFNUUsUUFBUSxDQUFDLHdCQUF3QixFQUFFLEdBQUcsRUFBRTtJQUN0QyxJQUFJLFFBQWtCLENBQUM7SUFFdkIsU0FBUyxDQUFDLEdBQUcsRUFBRTtRQUNiLE1BQU0sR0FBRyxHQUFHLElBQUksR0FBRyxDQUFDLEdBQUcsRUFBRSxDQUFDO1FBQzFCLE1BQU0sS0FBSyxHQUFHLElBQUksb0RBQXVCLENBQUMsR0FBRyxFQUFFLFdBQVcsRUFBRTtZQUMxRCxHQUFHLEVBQUU7Z0JBQ0gsT0FBTyxFQUFFLGNBQWM7Z0JBQ3ZCLE1BQU0sRUFBRSxnQkFBZ0I7YUFDekI7U0FDRixDQUFDLENBQUM7UUFDSCxRQUFRLEdBQUcscUJBQVEsQ0FBQyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDdkMsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsc0JBQXNCLEVBQUUsR0FBRyxFQUFFO1FBQ3BDLEVBQUUsQ0FBQyxvQkFBb0IsRUFBRSxHQUFHLEVBQUU7WUFDNUIsUUFBUSxDQUFDLHFCQUFxQixDQUFDLDBCQUEwQixFQUFFO2dCQUN6RCxJQUFJLEVBQUUsMEJBQTBCO2dCQUNoQyxXQUFXLEVBQUUsK0JBQStCO2FBQzdDLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLGlCQUFpQixFQUFFLEdBQUcsRUFBRTtZQUN6QixRQUFRLENBQUMscUJBQXFCLENBQUMsNkJBQTZCLEVBQUU7Z0JBQzVELFdBQVcsRUFBRSxrQkFBSyxDQUFDLFFBQVEsRUFBRTthQUM5QixDQUFDLENBQUM7WUFFSCxRQUFRLENBQUMs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TCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxXQUFXLEVBQUUsR0FBRyxFQUFFO1FBQ3pCLEVBQUUsQ0FBQyw4QkFBOEIsRUFBRSxHQUFHLEVBQUU7WUFDdEMsUUFBUSxDQUFDLHFCQUFxQixDQUFDLG9CQUFvQixFQUFFO2dCQUNuRCxLQUFLLEVBQUUsa0JBQUssQ0FBQyxTQUFTLENBQUM7b0JBQ3JCLGtCQUFLLENBQUMsVUFBVSxDQUFDO3dCQUNmLElBQUksRUFBRSxlQUFlO3dCQUNyQixNQUFNLEVBQUU7NEJBQ04sS0FBSyxFQUFFO2dDQUNMLGNBQWMsRUFBRTtvQ0FDZCxZQUFZLEVBQUUsR0FBRztvQ0FDakIscUJBQXFCLEVBQUUsbUJBQW1CO2lDQUMzQzs2QkFDRjt5QkFDRjtxQkFDRixDQUFDO2lCQUNILENBQUM7YUFDSCxDQUFDLENBQUM7UUFDTCxDQUFDLENBQUMsQ0FBQztRQUVILEVBQUUsQ0FBQywyQkFBMkIsRUFBRSxHQUFHLEVBQUU7WUFDbkMsUUFBUSxDQUFDLHFCQUFxQixDQUFDLG9CQUFvQixFQUFFO2dCQUNuRCxvQkFBb0IsRUFBRTtvQkFDcEIsaUJBQWlCLEVBQUU7d0JBQ2pCLE9BQU8sRUFBRSxrQkFBSyxDQUFDLGdCQUFnQixDQUFDLGdCQUFnQixDQUFDO3FCQUNsRDtpQkFDRjthQUNGLENBQUMsQ0FBQztRQUNMLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDLENBQUMsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXHRpMTk4XFxpbnZlc3RtZW50X2FuYWx5c2lzX29wb3BvXFxjZGtcXF9fdGVzdHNfX1xcYXBpLWdhdGV3YXktd2FmLnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXHJcbiAqIEFQSSBHYXRld2F5ICsgV0FG5qeL6YCg44Gu5qSc6Ki844OG44K544OIXHJcbiAqIFxyXG4gKiDjgZPjga7jg4bjgrnjg4jjga/jgIFBUEkgR2F0ZXdheeOBqEFXUyBXQUbjgYzmraPjgZfjgY/oqK3lrprjgZXjgozjgabjgYTjgovjgZPjgajjgpLmpJzoqLzjgZfjgb7jgZnjgIJcclxuICogXHJcbiAqIFJlcXVpcmVtZW50czpcclxuICogLSDopoHku7YxMS4xOiBBUEnoqo3oqLzvvIhBUEnjgq3jg7zoqo3oqLzvvIlcclxuICogLSDopoHku7YxMS4yOiDkvb/nlKjph4/jg5fjg6njg7PoqK3lrppcclxuICogLSDopoHku7YxMy4xOiBXQUbkv53orbfvvIjjg6zjg7zjg4jliLbpmZDjgIHjg57jg43jg7zjgrjjg4njg6vjg7zjg6vvvIlcclxuICogXHJcbiAqIFRlc3QgQ292ZXJhZ2U6XHJcbiAqIC0gQVBJIEdhdGV3YXnjgYzmraPjgZfjgY/kvZzmiJDjgZXjgozjgabjgYTjgovjgZPjgajjgpLnorroqo1cclxuICogLSBBUEnjgq3jg7zoqo3oqLzjgYzmnInlirnljJbjgZXjgozjgabjgYTjgovjgZPjgajjgpLnorroqo1cclxuICogLSDkvb/nlKjph4/jg5fjg6njg7PjgYzoqK3lrprjgZXjgozjgabjgYTjgovjgZPjgajjgpLnorroqo1cclxuICogLSBDT1JT6Kit5a6a44GM5q2j44GX44GE44GT44Go44KS56K66KqNXHJcbiAqIC0gV0FG44GM6Zai6YCj5LuY44GR44KJ44KM44Gm44GE44KL44GT44Go44KS56K66KqNXHJcbiAqIC0gV0FG44Or44O844Or44GM5q2j44GX44GP6Kit5a6a44GV44KM44Gm44GE44KL44GT44Go44KS56K66KqNXHJcbiAqL1xyXG5cclxuaW1wb3J0ICogYXMgY2RrIGZyb20gJ2F3cy1jZGstbGliJztcclxuaW1wb3J0IHsgVGVtcGxhdGUsIE1hdGNoIH0gZnJvbSAnYXdzLWNkay1saWIvYXNzZXJ0aW9ucyc7XHJcbmltcG9ydCB7IFRkbmV0RGF0YUNvbGxlY3RvclN0YWNrIH0gZnJvbSAnLi4vbGliL3RkbmV0LWRhdGEtY29sbGVjdG9yLXN0YWNrJztcclxuXHJcbmRlc2NyaWJlKCdBUEkgR2F0ZXdheSArIFdBRuani+mAoOOBruaknOiovCcsICgpID0+IHtcclxuICBsZXQgdGVtcGxhdGU6IFRlbXBsYXRlO1xyXG5cclxuICBiZWZvcmVBbGwoKCkgPT4ge1xyXG4gICAgY29uc3QgYXBwID0gbmV3IGNkay5BcHAoKTtcclxuICAgIGNvbnN0IHN0YWNrID0gbmV3IFRkbmV0RGF0YUNvbGxlY3RvclN0YWNrKGFwcCwgJ1Rlc3RTdGFjaycsIHtcclxuICAgICAgZW52OiB7XHJcbiAgICAgICAgYWNjb3VudDogJzEyMzQ1Njc4OTAxMicsXHJcbiAgICAgICAgcmVnaW9uOiAnYXAtbm9ydGhlYXN0LTEnLFxyXG4gICAgICB9LFxyXG4gICAgfSk7XHJcbiAgICB0ZW1wbGF0ZSA9IFRlbXBsYXRlLmZyb21TdGFjayhzdGFjayk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdBUEkgR2F0ZXdheSBSRVNUIEFQSScsICgpID0+IHtcclxuICAgIGl0KCdSRVNUIEFQSeOBjOS9nOaIkOOBleOCjOOBpuOBhOOCi+OBk+OBqCcsICgpID0+IHtcclxuICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwaUdhdGV3YXk6OlJlc3RBcGknLCB7XHJcbiAgICAgICAgTmFtZTogJ3RkbmV0LWRhdGEtY29sbGVjdG9yLWFwaScsXHJcbiAgICAgICAgRGVzY3JpcHRpb246ICdURG5ldCBEYXRhIENvbGxlY3RvciBSRVNUIEFQSScsXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ+ODh+ODl+ODreOCpOODoeODs+ODiOioreWumuOBjOato+OBl+OBhOOBk+OBqCcsICgpID0+IHtcclxuICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwaUdhdGV3YXk6OkRlcGxveW1lbnQnLCB7XHJcbiAgICAgICAgRGVzY3JpcHRpb246IE1hdGNoLmFueVZhbHVlKCksXHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwaUdhdGV3YXk6OlN0YWdlJywge1xyXG4gICAgICAgIFN0YWdlTmFtZTogJ3Byb2QnLFxyXG4gICAgICAgIE1ldGhvZFNldHRpbmdzOiBNYXRjaC5hcnJheVdpdGgoW1xyXG4gICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7XHJcbiAgICAgICAgICAgIExvZ2dpbmdMZXZlbDogJ0lORk8nLFxyXG4gICAgICAgICAgICBEYXRhVHJhY2VFbmFibGVkOiB0cnVlLFxyXG4gICAgICAgICAgICBNZXRyaWNzRW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgIF0pLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdDT1JT6Kit5a6a44GM5pyJ5Yq55YyW44GV44KM44Gm44GE44KL44GT44GoJywgKCkgPT4ge1xyXG4gICAgICAvLyBPUFRJT05T44Oh44K944OD44OJ44GM5a2Y5Zyo44GZ44KL44GT44Go44KS56K66KqNXHJcbiAgICAgIHRlbXBsYXRlLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcGlHYXRld2F5OjpNZXRob2QnLCB7XHJcbiAgICAgICAgSHR0cE1ldGhvZDogJ09QVElPTlMnLFxyXG4gICAgICAgIEludGVncmF0aW9uOiBNYXRjaC5vYmplY3RMaWtlKHtcclxuICAgICAgICAgIFR5cGU6ICdNT0NLJyxcclxuICAgICAgICAgIEludGVncmF0aW9uUmVzcG9uc2VzOiBNYXRjaC5hcnJheVdpdGgoW1xyXG4gICAgICAgICAgICBNYXRjaC5vYmplY3RMaWtlKHtcclxuICAgICAgICAgICAgICBSZXNwb25zZVBhcmFtZXRlcnM6IE1hdGNoLm9iamVjdExpa2Uoe1xyXG4gICAgICAgICAgICAgICAgJ21ldGhvZC5yZXNwb25zZS5oZWFkZXIuQWNjZXNzLUNvbnRyb2wtQWxsb3ctSGVhZGVycyc6IE1hdGNoLnN0cmluZ0xpa2VSZWdleHAoJy4qWC1BcGktS2V5LionKSxcclxuICAgICAgICAgICAgICAgICdtZXRob2QucmVzcG9uc2UuaGVhZGVyLkFjY2Vzcy1Db250cm9sLUFsbG93LU1ldGhvZHMnOiBNYXRjaC5hbnlWYWx1ZSgpLFxyXG4gICAgICAgICAgICAgICAgJ21ldGhvZC5yZXNwb25zZS5oZWFkZXIuQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luJzogTWF0Y2guYW55VmFsdWUoKSxcclxuICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICBdKSxcclxuICAgICAgICB9KSxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnQ2xvdWRXYXRjaCBMb2dz44Ot44O844Or44GM6Kit5a6a44GV44KM44Gm44GE44KL44GT44GoJywgKCkgPT4ge1xyXG4gICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6QXBpR2F0ZXdheTo6QWNjb3VudCcsIHtcclxuICAgICAgICBDbG91ZFdhdGNoUm9sZUFybjogTWF0Y2guYW55VmFsdWUoKSxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0FQSSBLZXnoqo3oqLwnLCAoKSA9PiB7XHJcbiAgICBpdCgnQVBJ44Kt44O844GM5L2c5oiQ44GV44KM44Gm44GE44KL44GT44GoJywgKCkgPT4ge1xyXG4gICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6QXBpR2F0ZXdheTo6QXBpS2V5Jywge1xyXG4gICAgICAgIE5hbWU6ICd0ZG5ldC1hcGkta2V5JyxcclxuICAgICAgICBEZXNjcmlwdGlvbjogJ0FQSSBLZXkgZm9yIFREbmV0IERhdGEgQ29sbGVjdG9yJyxcclxuICAgICAgICBFbmFibGVkOiB0cnVlLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCfkvb/nlKjph4/jg5fjg6njg7PjgYzkvZzmiJDjgZXjgozjgabjgYTjgovjgZPjgagnLCAoKSA9PiB7XHJcbiAgICAgIHRlbXBsYXRlLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcGlHYXRld2F5OjpVc2FnZVBsYW4nLCB7XHJcbiAgICAgICAgVXNhZ2VQbGFuTmFtZTogJ3RkbmV0LXVzYWdlLXBsYW4nLFxyXG4gICAgICAgIERlc2NyaXB0aW9uOiAnVXNhZ2UgcGxhbiBmb3IgVERuZXQgRGF0YSBDb2xsZWN0b3IgQVBJJyxcclxuICAgICAgICBUaHJvdHRsZToge1xyXG4gICAgICAgICAgUmF0ZUxpbWl0OiAxMDAsXHJcbiAgICAgICAgICBCdXJzdExpbWl0OiAyMDAsXHJcbiAgICAgICAgfSxcclxuICAgICAgICBRdW90YToge1xyXG4gICAgICAgICAgTGltaXQ6IDEwMDAwLFxyXG4gICAgICAgICAgUGVyaW9kOiAnTU9OVEgnLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ0FQSeOCreODvOOBjOS9v+eUqOmHj+ODl+ODqeODs+OBq+mWoumAo+S7mOOBkeOCieOCjOOBpuOBhOOCi+OBk+OBqCcsICgpID0+IHtcclxuICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwaUdhdGV3YXk6OlVzYWdlUGxhbktleScsIHtcclxuICAgICAgICBLZXlUeXBlOiAnQVBJX0tFWScsXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdBV1MgV0FG6Kit5a6aJywgKCkgPT4ge1xyXG4gICAgaXQoJ1dlYiBBQ0zjgYzkvZzmiJDjgZXjgozjgabjgYTjgovjgZPjgagnLCAoKSA9PiB7XHJcbiAgICAgIHRlbXBsYXRlLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpXQUZ2Mjo6V2ViQUNMJywge1xyXG4gICAgICAgIE5hbWU6ICd0ZG5ldC13ZWItYWNsJyxcclxuICAgICAgICBTY29wZTogJ1JFR0lPTkFMJyxcclxuICAgICAgICBEZWZhdWx0QWN0aW9uOiB7IEFsbG93OiB7fSB9LFxyXG4gICAgICAgIERlc2NyaXB0aW9uOiAnV2ViIEFDTCBmb3IgVERuZXQgRGF0YSBDb2xsZWN0b3IgQVBJJyxcclxuICAgICAgICBWaXNpYmlsaXR5Q29uZmlnOiB7XHJcbiAgICAgICAgICBTYW1wbGVkUmVxdWVzdHNFbmFibGVkOiB0cnVlLFxyXG4gICAgICAgICAgQ2xvdWRXYXRjaE1ldHJpY3NFbmFibGVkOiB0cnVlLFxyXG4gICAgICAgICAgTWV0cmljTmFtZTogJ1RkbmV0V2ViQWNsJyxcclxuICAgICAgICB9LFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCfjg6zjg7zjg4jliLbpmZDjg6vjg7zjg6vjgYzoqK3lrprjgZXjgozjgabjgYTjgovjgZPjgagnLCAoKSA9PiB7XHJcbiAgICAgIHRlbXBsYXRlLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpXQUZ2Mjo6V2ViQUNMJywge1xyXG4gICAgICAgIFJ1bGVzOiBNYXRjaC5hcnJheVdpdGgoW1xyXG4gICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7XHJcbiAgICAgICAgICAgIE5hbWU6ICdSYXRlTGltaXRSdWxlJyxcclxuICAgICAgICAgICAgUHJpb3JpdHk6IDEsXHJcbiAgICAgICAgICAgIFN0YXRlbWVudDoge1xyXG4gICAgICAgICAgICAgIFJhdGVCYXNlZFN0YXRlbWVudDoge1xyXG4gICAgICAgICAgICAgICAgTGltaXQ6IDIwMDAsIC8vIDXliIbplpPjgacyMDAw44Oq44Kv44Ko44K544OIXHJcbiAgICAgICAgICAgICAgICBBZ2dyZWdhdGVLZXlUeXBlOiAnSVAnLFxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIEFjdGlvbjoge1xyXG4gICAgICAgICAgICAgIEJsb2NrOiB7XHJcbiAgICAgICAgICAgICAgICBDdXN0b21SZXNwb25zZToge1xyXG4gICAgICAgICAgICAgICAgICBSZXNwb25zZUNvZGU6IDQyOSxcclxuICAgICAgICAgICAgICAgICAgQ3VzdG9tUmVzcG9uc2VCb2R5S2V5OiAnUmF0ZUxpbWl0RXhjZWVkZWQnLFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICBWaXNpYmlsaXR5Q29uZmlnOiB7XHJcbiAgICAgICAgICAgICAgU2FtcGxlZFJlcXVlc3RzRW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgICAgICBDbG91ZFdhdGNoTWV0cmljc0VuYWJsZWQ6IHRydWUsXHJcbiAgICAgICAgICAgICAgTWV0cmljTmFtZTogJ1JhdGVMaW1pdFJ1bGUnLFxyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgfSksXHJcbiAgICAgICAgXSksXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ0FXU+ODnuODjeODvOOCuOODieODq+ODvOODq++8iENvbW1vbiBSdWxlIFNldO+8ieOBjOmBqeeUqOOBleOCjOOBpuOBhOOCi+OBk+OBqCcsICgpID0+IHtcclxuICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OldBRnYyOjpXZWJBQ0wnLCB7XHJcbiAgICAgICAgUnVsZXM6IE1hdGNoLmFycmF5V2l0aChbXHJcbiAgICAgICAgICBNYXRjaC5vYmplY3RMaWtlKHtcclxuICAgICAgICAgICAgTmFtZTogJ0FXU01hbmFnZWRSdWxlc0NvbW1vblJ1bGVTZXQnLFxyXG4gICAgICAgICAgICBQcmlvcml0eTogMixcclxuICAgICAgICAgICAgU3RhdGVtZW50OiB7XHJcbiAgICAgICAgICAgICAgTWFuYWdlZFJ1bGVHcm91cFN0YXRlbWVudDoge1xyXG4gICAgICAgICAgICAgICAgVmVuZG9yTmFtZTogJ0FXUycsXHJcbiAgICAgICAgICAgICAgICBOYW1lOiAnQVdTTWFuYWdlZFJ1bGVzQ29tbW9uUnVsZVNldCcsXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgT3ZlcnJpZGVBY3Rpb246IHsgTm9uZToge30gfSxcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgIF0pLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdBV1Pjg57jg43jg7zjgrjjg4njg6vjg7zjg6vvvIhLbm93biBCYWQgSW5wdXRz77yJ44GM6YGp55So44GV44KM44Gm44GE44KL44GT44GoJywgKCkgPT4ge1xyXG4gICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6V0FGdjI6OldlYkFDTCcsIHtcclxuICAgICAgICBSdWxlczogTWF0Y2guYXJyYXlXaXRoKFtcclxuICAgICAgICAgIE1hdGNoLm9iamVjdExpa2Uoe1xyXG4gICAgICAgICAgICBOYW1lOiAnQVdTTWFuYWdlZFJ1bGVzS25vd25CYWRJbnB1dHNSdWxlU2V0JyxcclxuICAgICAgICAgICAgUHJpb3JpdHk6IDMsXHJcbiAgICAgICAgICAgIFN0YXRlbWVudDoge1xyXG4gICAgICAgICAgICAgIE1hbmFnZWRSdWxlR3JvdXBTdGF0ZW1lbnQ6IHtcclxuICAgICAgICAgICAgICAgIFZlbmRvck5hbWU6ICdBV1MnLFxyXG4gICAgICAgICAgICAgICAgTmFtZTogJ0FXU01hbmFnZWRSdWxlc0tub3duQmFkSW5wdXRzUnVsZVNldCcsXHJcbiAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgT3ZlcnJpZGVBY3Rpb246IHsgTm9uZToge30gfSxcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgIF0pLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCfjgqvjgrnjgr/jg6Djg6zjgrnjg53jg7Pjgrnjg5zjg4fjgqPjgYzoqK3lrprjgZXjgozjgabjgYTjgovjgZPjgagnLCAoKSA9PiB7XHJcbiAgICAgIHRlbXBsYXRlLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpXQUZ2Mjo6V2ViQUNMJywge1xyXG4gICAgICAgIEN1c3RvbVJlc3BvbnNlQm9kaWVzOiB7XHJcbiAgICAgICAgICBSYXRlTGltaXRFeGNlZWRlZDoge1xyXG4gICAgICAgICAgICBDb250ZW50VHlwZTogJ0FQUExJQ0FUSU9OX0pTT04nLFxyXG4gICAgICAgICAgICBDb250ZW50OiBNYXRjaC5zdHJpbmdMaWtlUmVnZXhwKCcuKlJBVEVfTElNSVRfRVhDRUVERUQuKicpLFxyXG4gICAgICAgICAgfSxcclxuICAgICAgICB9LFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdXQUbjgYxBUEkgR2F0ZXdheeOBq+mWoumAo+S7mOOBkeOCieOCjOOBpuOBhOOCi+OBk+OBqCcsICgpID0+IHtcclxuICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OldBRnYyOjpXZWJBQ0xBc3NvY2lhdGlvbicsIHtcclxuICAgICAgICBSZXNvdXJjZUFybjogTWF0Y2guYW55VmFsdWUoKSxcclxuICAgICAgICBXZWJBQ0xBcm46IE1hdGNoLmFueVZhbHVlKCksIC8vIOato+OBl+OBhOODl+ODreODkeODhuOCo+WQjeOBryBXZWJBQ0xBcm5cclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0Nsb3VkRm9ybWF0aW9uIE91dHB1dHMnLCAoKSA9PiB7XHJcbiAgICBpdCgnQVBJIEVuZHBvaW5044GM5Ye65Yqb44GV44KM44Gm44GE44KL44GT44GoJywgKCkgPT4ge1xyXG4gICAgICB0ZW1wbGF0ZS5oYXNPdXRwdXQoJ0FwaUVuZHBvaW50Jywge1xyXG4gICAgICAgIERlc2NyaXB0aW9uOiAnQVBJIEdhdGV3YXkgZW5kcG9pbnQgVVJMJyxcclxuICAgICAgICBFeHBvcnQ6IHtcclxuICAgICAgICAgIE5hbWU6ICdUZG5ldEFwaUVuZHBvaW50JyxcclxuICAgICAgICB9LFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdBUEkgS2V5IElE44GM5Ye65Yqb44GV44KM44Gm44GE44KL44GT44GoJywgKCkgPT4ge1xyXG4gICAgICB0ZW1wbGF0ZS5oYXNPdXRwdXQoJ0FwaUtleUlkJywge1xyXG4gICAgICAgIERlc2NyaXB0aW9uOiAnQVBJIEtleSBJRCcsXHJcbiAgICAgICAgRXhwb3J0OiB7XHJcbiAgICAgICAgICBOYW1lOiAnVGRuZXRBcGlLZXlJZCcsXHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgnV2ViIEFDTCBBUk7jgYzlh7rlipvjgZXjgozjgabjgYTjgovjgZPjgagnLCAoKSA9PiB7XHJcbiAgICAgIHRlbXBsYXRlLmhhc091dHB1dCgnV2ViQWNsQXJuJywge1xyXG4gICAgICAgIERlc2NyaXB0aW9uOiAnV0FGIFdlYiBBQ0wgQVJOJyxcclxuICAgICAgICBFeHBvcnQ6IHtcclxuICAgICAgICAgIE5hbWU6ICdUZG5ldFdlYkFjbEFybicsXHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ+OCu+OCreODpeODquODhuOCo+ioreWumicsICgpID0+IHtcclxuICAgIGl0KCdBUEkgR2F0ZXdheeOBruODreOCsOOBjOacieWKueWMluOBleOCjOOBpuOBhOOCi+OBk+OBqCcsICgpID0+IHtcclxuICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwaUdhdGV3YXk6OlN0YWdlJywge1xyXG4gICAgICAgIE1ldGhvZFNldHRpbmdzOiBNYXRjaC5hcnJheVdpdGgoW1xyXG4gICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7XHJcbiAgICAgICAgICAgIExvZ2dpbmdMZXZlbDogJ0lORk8nLFxyXG4gICAgICAgICAgICBEYXRhVHJhY2VFbmFibGVkOiB0cnVlLFxyXG4gICAgICAgICAgfSksXHJcbiAgICAgICAgXSksXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ+OCueODreODg+ODiOODquODs+OCsOioreWumuOBjOacieWKueWMluOBleOCjOOBpuOBhOOCi+OBk+OBqCcsICgpID0+IHtcclxuICAgICAgLy8g44K544Ot44OD44OI44Oq44Oz44Kw6Kit5a6a44Gv5L2/55So6YeP44OX44Op44Oz44Gn566h55CG44GV44KM44KLXHJcbiAgICAgIHRlbXBsYXRlLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcGlHYXRld2F5OjpVc2FnZVBsYW4nLCB7XHJcbiAgICAgICAgVGhyb3R0bGU6IHtcclxuICAgICAgICAgIFJhdGVMaW1pdDogMTAwLFxyXG4gICAgICAgICAgQnVyc3RMaW1pdDogMjAwLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ+S9v+eUqOmHj+ODl+ODqeODs+OBq+OCr+OCqeODvOOCv+OBjOioreWumuOBleOCjOOBpuOBhOOCi+OBk+OBqCcsICgpID0+IHtcclxuICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwaUdhdGV3YXk6OlVzYWdlUGxhbicsIHtcclxuICAgICAgICBRdW90YToge1xyXG4gICAgICAgICAgTGltaXQ6IDEwMDAwLFxyXG4gICAgICAgICAgUGVyaW9kOiAnTU9OVEgnLFxyXG4gICAgICAgIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCfjg5Hjg5Xjgqnjg7zjg57jg7PjgrnoqK3lrponLCAoKSA9PiB7XHJcbiAgICBpdCgnQVBJIEdhdGV3YXnjg6Hjg4jjg6rjgq/jgrnjgYzmnInlirnljJbjgZXjgozjgabjgYTjgovjgZPjgagnLCAoKSA9PiB7XHJcbiAgICAgIHRlbXBsYXRlLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcGlHYXRld2F5OjpTdGFnZScsIHtcclxuICAgICAgICBNZXRob2RTZXR0aW5nczogTWF0Y2guYXJyYXlXaXRoKFtcclxuICAgICAgICAgIE1hdGNoLm9iamVjdExpa2Uoe1xyXG4gICAgICAgICAgICBNZXRyaWNzRW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgIH0pLFxyXG4gICAgICAgIF0pLFxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdXQUbjg6Hjg4jjg6rjgq/jgrnjgYzmnInlirnljJbjgZXjgozjgabjgYTjgovjgZPjgagnLCAoKSA9PiB7XHJcbiAgICAgIHRlbXBsYXRlLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpXQUZ2Mjo6V2ViQUNMJywge1xyXG4gICAgICAgIFZpc2liaWxpdHlDb25maWc6IHtcclxuICAgICAgICAgIENsb3VkV2F0Y2hNZXRyaWNzRW5hYmxlZDogdHJ1ZSxcclxuICAgICAgICAgIE1ldHJpY05hbWU6ICdUZG5ldFdlYkFjbCcsXHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ+OCqOODqeODvOODj+ODs+ODieODquODs+OCsCcsICgpID0+IHtcclxuICAgIGl0KCfjg6zjg7zjg4jliLbpmZDotoXpgY7mmYLjga7jgqvjgrnjgr/jg6Djg6zjgrnjg53jg7PjgrnjgYzoqK3lrprjgZXjgozjgabjgYTjgovjgZPjgagnLCAoKSA9PiB7XHJcbiAgICAgIHRlbXBsYXRlLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpXQUZ2Mjo6V2ViQUNMJywge1xyXG4gICAgICAgIFJ1bGVzOiBNYXRjaC5hcnJheVdpdGgoW1xyXG4gICAgICAgICAgTWF0Y2gub2JqZWN0TGlrZSh7XHJcbiAgICAgICAgICAgIE5hbWU6ICdSYXRlTGltaXRSdWxlJyxcclxuICAgICAgICAgICAgQWN0aW9uOiB7XHJcbiAgICAgICAgICAgICAgQmxvY2s6IHtcclxuICAgICAgICAgICAgICAgIEN1c3RvbVJlc3BvbnNlOiB7XHJcbiAgICAgICAgICAgICAgICAgIFJlc3BvbnNlQ29kZTogNDI5LFxyXG4gICAgICAgICAgICAgICAgICBDdXN0b21SZXNwb25zZUJvZHlLZXk6ICdSYXRlTGltaXRFeGNlZWRlZCcsXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICB9KSxcclxuICAgICAgICBdKSxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBpdCgn44Kr44K544K/44Og44Os44K544Od44Oz44K544Gr44Ko44Op44O844Kz44O844OJ44GM5ZCr44G+44KM44Gm44GE44KL44GT44GoJywgKCkgPT4ge1xyXG4gICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6V0FGdjI6OldlYkFDTCcsIHtcclxuICAgICAgICBDdXN0b21SZXNwb25zZUJvZGllczoge1xyXG4gICAgICAgICAgUmF0ZUxpbWl0RXhjZWVkZWQ6IHtcclxuICAgICAgICAgICAgQ29udGVudDogTWF0Y2guc3RyaW5nTGlrZVJlZ2V4cCgnLiplcnJvcl9jb2RlLionKSxcclxuICAgICAgICAgIH0sXHJcbiAgICAgICAgfSxcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7XHJcbiJdLCJ2ZXJzaW9uIjozfQ==