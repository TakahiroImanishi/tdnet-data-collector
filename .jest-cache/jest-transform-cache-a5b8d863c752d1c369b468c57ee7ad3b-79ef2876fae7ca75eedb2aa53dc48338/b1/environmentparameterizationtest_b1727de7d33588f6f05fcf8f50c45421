a7e8b688865a2fd2288e5ff04a1eb8f3
"use strict";
/**
 * Environment Parameterization Test
 *
 * Task 15.15-A: CDKスタックの環境パラメータ化テスト
 * Requirements: 要件8.1（設定管理）
 *
 * このテストは、CDKスタックが環境（dev/prod）ごとに正しくパラメータ化されていることを検証します。
 */
var __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    var desc = Object.getOwnPropertyDescriptor(m, k);
    if (!desc || ("get" in desc ? !m.__esModule : desc.writable || desc.configurable)) {
      desc = { enumerable: true, get: function() { return m[k]; } };
    }
    Object.defineProperty(o, k2, desc);
}) : (function(o, m, k, k2) {
    if (k2 === undefined) k2 = k;
    o[k2] = m[k];
}));
var __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {
    Object.defineProperty(o, "default", { enumerable: true, value: v });
}) : function(o, v) {
    o["default"] = v;
});
var __importStar = (this && this.__importStar) || (function () {
    var ownKeys = function(o) {
        ownKeys = Object.getOwnPropertyNames || function (o) {
            var ar = [];
            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;
            return ar;
        };
        return ownKeys(o);
    };
    return function (mod) {
        if (mod && mod.__esModule) return mod;
        var result = {};
        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== "default") __createBinding(result, mod, k[i]);
        __setModuleDefault(result, mod);
        return result;
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
const cdk = __importStar(require("aws-cdk-lib"));
const assertions_1 = require("aws-cdk-lib/assertions");
const tdnet_data_collector_stack_1 = require("../lib/tdnet-data-collector-stack");
describe('Environment Parameterization', () => {
    const testAccount = '123456789012';
    const testRegion = 'ap-northeast-1';
    describe('Development Environment', () => {
        let template;
        beforeAll(() => {
            const app = new cdk.App();
            const stack = new tdnet_data_collector_stack_1.TdnetDataCollectorStack(app, 'TestStack-dev', {
                env: {
                    account: testAccount,
                    region: testRegion
                },
                environmentConfig: { environment: 'dev' },
            });
            template = assertions_1.Template.fromStack(stack);
        });
        describe('DynamoDB Tables', () => {
            it('should have environment suffix in table names', () => {
                template.hasResourceProperties('AWS::DynamoDB::Table', {
                    TableName: 'tdnet_disclosures_dev',
                });
                template.hasResourceProperties('AWS::DynamoDB::Table', {
                    TableName: 'tdnet_executions_dev',
                });
                template.hasResourceProperties('AWS::DynamoDB::Table', {
                    TableName: 'tdnet_export_status_dev',
                });
            });
        });
        describe('S3 Buckets', () => {
            it('should have environment suffix in bucket names', () => {
                template.hasResourceProperties('AWS::S3::Bucket', {
                    BucketName: { 'Fn::Join': ['', ['tdnet-data-collector-pdfs-dev-', { Ref: 'AWS::AccountId' }]] },
                });
                template.hasResourceProperties('AWS::S3::Bucket', {
                    BucketName: { 'Fn::Join': ['', ['tdnet-data-collector-exports-dev-', { Ref: 'AWS::AccountId' }]] },
                });
                template.hasResourceProperties('AWS::S3::Bucket', {
                    BucketName: { 'Fn::Join': ['', ['tdnet-dashboard-dev-', { Ref: 'AWS::AccountId' }]] },
                });
                // CloudTrail bucket does not have environment suffix (shared resource)
                template.hasResourceProperties('AWS::S3::Bucket', {
                    BucketName: `tdnet-cloudtrail-logs-${testAccount}`,
                });
            });
        });
        describe('Lambda Functions', () => {
            it('should have environment suffix in function names', () => {
                template.hasResourceProperties('AWS::Lambda::Function', {
                    FunctionName: 'tdnet-collector-dev',
                });
                template.hasResourceProperties('AWS::Lambda::Function', {
                    FunctionName: 'tdnet-query-dev',
                });
                template.hasResourceProperties('AWS::Lambda::Function', {
                    FunctionName: 'tdnet-export-dev',
                });
                template.hasResourceProperties('AWS::Lambda::Function', {
                    FunctionName: 'tdnet-collector-dev', // Changed from tdnet-collect-dev
                });
                template.hasResourceProperties('AWS::Lambda::Function', {
                    FunctionName: 'tdnet-collect-status-dev',
                });
            });
        });
        describe('API Gateway', () => {
            it('should have environment suffix in API name', () => {
                template.hasResourceProperties('AWS::ApiGateway::RestApi', {
                    Name: 'tdnet-data-collector-api-dev',
                });
            });
            it('should have environment suffix in API key name', () => {
                template.hasResourceProperties('AWS::ApiGateway::ApiKey', {
                    Name: 'tdnet-api-key-dev',
                });
            });
            it('should have environment suffix in usage plan name', () => {
                template.hasResourceProperties('AWS::ApiGateway::UsagePlan', {
                    UsagePlanName: 'tdnet-usage-plan-dev',
                });
            });
        });
        describe('WAF', () => {
            it('should have environment suffix in Web ACL name', () => {
                template.hasResourceProperties('AWS::WAFv2::WebACL', {
                    Name: 'tdnet-web-acl-dev',
                });
            });
        });
    });
    describe('Production Environment', () => {
        let template;
        beforeAll(() => {
            const app = new cdk.App();
            const stack = new tdnet_data_collector_stack_1.TdnetDataCollectorStack(app, 'TestStack-prod', {
                env: { account: testAccount, region: testRegion },
                environmentConfig: { environment: 'prod' },
            });
            template = assertions_1.Template.fromStack(stack);
        });
        describe('DynamoDB Tables', () => {
            it('should have environment suffix in table names', () => {
                template.hasResourceProperties('AWS::DynamoDB::Table', {
                    TableName: 'tdnet_disclosures_prod',
                });
                template.hasResourceProperties('AWS::DynamoDB::Table', {
                    TableName: 'tdnet_executions_prod',
                });
                template.hasResourceProperties('AWS::DynamoDB::Table', {
                    TableName: 'tdnet_export_status_prod',
                });
            });
        });
        describe('S3 Buckets', () => {
            it('should have environment suffix in bucket names', () => {
                template.hasResourceProperties('AWS::S3::Bucket', {
                    BucketName: { 'Fn::Join': ['', ['tdnet-data-collector-pdfs-prod-', { Ref: 'AWS::AccountId' }]] },
                });
                template.hasResourceProperties('AWS::S3::Bucket', {
                    BucketName: { 'Fn::Join': ['', ['tdnet-data-collector-exports-prod-', { Ref: 'AWS::AccountId' }]] },
                });
                template.hasResourceProperties('AWS::S3::Bucket', {
                    BucketName: { 'Fn::Join': ['', ['tdnet-dashboard-prod-', { Ref: 'AWS::AccountId' }]] },
                });
                // CloudTrail bucket does not have environment suffix (shared resource)
                template.hasResourceProperties('AWS::S3::Bucket', {
                    BucketName: `tdnet-cloudtrail-logs-${testAccount}`,
                });
            });
        });
        describe('Lambda Functions', () => {
            it('should have environment suffix in function names', () => {
                template.hasResourceProperties('AWS::Lambda::Function', {
                    FunctionName: 'tdnet-collector-prod',
                });
                template.hasResourceProperties('AWS::Lambda::Function', {
                    FunctionName: 'tdnet-query-prod',
                });
                template.hasResourceProperties('AWS::Lambda::Function', {
                    FunctionName: 'tdnet-export-prod',
                });
                template.hasResourceProperties('AWS::Lambda::Function', {
                    FunctionName: 'tdnet-collector-prod', // Changed from tdnet-collect-prod
                });
                template.hasResourceProperties('AWS::Lambda::Function', {
                    FunctionName: 'tdnet-collect-status-prod',
                });
            });
        });
        describe('API Gateway', () => {
            it('should have environment suffix in API name', () => {
                template.hasResourceProperties('AWS::ApiGateway::RestApi', {
                    Name: 'tdnet-data-collector-api-prod',
                });
            });
            it('should have environment suffix in API key name', () => {
                template.hasResourceProperties('AWS::ApiGateway::ApiKey', {
                    Name: 'tdnet-api-key-prod',
                });
            });
            it('should have environment suffix in usage plan name', () => {
                template.hasResourceProperties('AWS::ApiGateway::UsagePlan', {
                    UsagePlanName: 'tdnet-usage-plan-prod',
                });
            });
        });
        describe('WAF', () => {
            it('should have environment suffix in Web ACL name', () => {
                template.hasResourceProperties('AWS::WAFv2::WebACL', {
                    Name: 'tdnet-web-acl-prod',
                });
            });
        });
    });
    describe('Default Environment (no config provided)', () => {
        let template;
        beforeAll(() => {
            const app = new cdk.App();
            const stack = new tdnet_data_collector_stack_1.TdnetDataCollectorStack(app, 'TestStack-default', {
                env: { account: testAccount, region: testRegion },
                // environmentConfig not provided - should default to 'dev'
            });
            template = assertions_1.Template.fromStack(stack);
        });
        it('should default to dev environment', () => {
            template.hasResourceProperties('AWS::DynamoDB::Table', {
                TableName: 'tdnet_disclosures_dev',
            });
            template.hasResourceProperties('AWS::Lambda::Function', {
                FunctionName: 'tdnet-collector-dev',
            });
            template.hasResourceProperties('AWS::ApiGateway::RestApi', {
                Name: 'tdnet-data-collector-api-dev',
            });
        });
    });
    describe('Resource Isolation', () => {
        it('should create different resource names for dev and prod', () => {
            const app = new cdk.App();
            const devStack = new tdnet_data_collector_stack_1.TdnetDataCollectorStack(app, 'DevStack', {
                env: { account: testAccount, region: testRegion },
                environmentConfig: { environment: 'dev' },
            });
            const prodStack = new tdnet_data_collector_stack_1.TdnetDataCollectorStack(app, 'ProdStack', {
                env: { account: testAccount, region: testRegion },
                environmentConfig: { environment: 'prod' },
            });
            const devTemplate = assertions_1.Template.fromStack(devStack);
            const prodTemplate = assertions_1.Template.fromStack(prodStack);
            // Verify dev resources
            devTemplate.hasResourceProperties('AWS::DynamoDB::Table', {
                TableName: 'tdnet_disclosures_dev',
            });
            // Verify prod resources
            prodTemplate.hasResourceProperties('AWS::DynamoDB::Table', {
                TableName: 'tdnet_disclosures_prod',
            });
            // Ensure they are different
            expect(devStack.disclosuresTable.tableName).not.toBe(prodStack.disclosuresTable.tableName);
        });
    });
    describe('Environment Variable Propagation', () => {
        let template;
        beforeAll(() => {
            const app = new cdk.App();
            const stack = new tdnet_data_collector_stack_1.TdnetDataCollectorStack(app, 'TestStack-env-vars', {
                env: { account: testAccount, region: testRegion },
                environmentConfig: { environment: 'dev' },
            });
            template = assertions_1.Template.fromStack(stack);
        });
        it('should pass environment-specific table names to Lambda functions', () => {
            // Collector function should have table references
            const resources = template.toJSON().Resources;
            const collectorFunction = Object.values(resources).find((r) => r.Type === 'AWS::Lambda::Function' && r.Properties?.FunctionName === 'tdnet-collector-dev');
            expect(collectorFunction).toBeDefined();
            expect(collectorFunction.Properties.Environment.Variables.DYNAMODB_TABLE).toBeDefined();
            expect(collectorFunction.Properties.Environment.Variables.DYNAMODB_EXECUTIONS_TABLE).toBeDefined();
            // Query function should have table reference
            const queryFunction = Object.values(resources).find((r) => r.Type === 'AWS::Lambda::Function' && r.Properties?.FunctionName === 'tdnet-query-dev');
            expect(queryFunction).toBeDefined();
            expect(queryFunction.Properties.Environment.Variables.DYNAMODB_TABLE_NAME).toBeDefined();
            // Export function should have table references
            const exportFunction = Object.values(resources).find((r) => r.Type === 'AWS::Lambda::Function' && r.Properties?.FunctionName === 'tdnet-export-dev');
            expect(exportFunction).toBeDefined();
            expect(exportFunction.Properties.Environment.Variables.DYNAMODB_TABLE_NAME).toBeDefined();
            expect(exportFunction.Properties.Environment.Variables.EXPORT_STATUS_TABLE_NAME).toBeDefined();
        });
        it('should pass environment-specific bucket names to Lambda functions', () => {
            const resources = template.toJSON().Resources;
            // Collector function should have bucket reference
            const collectorFunction = Object.values(resources).find((r) => r.Type === 'AWS::Lambda::Function' && r.Properties?.FunctionName === 'tdnet-collector-dev');
            expect(collectorFunction).toBeDefined();
            expect(collectorFunction.Properties.Environment.Variables.S3_BUCKET).toBeDefined();
            // Query function should have bucket reference
            const queryFunction = Object.values(resources).find((r) => r.Type === 'AWS::Lambda::Function' && r.Properties?.FunctionName === 'tdnet-query-dev');
            expect(queryFunction).toBeDefined();
            expect(queryFunction.Properties.Environment.Variables.S3_BUCKET_NAME).toBeDefined();
            // Export function should have bucket reference
            const exportFunction = Object.values(resources).find((r) => r.Type === 'AWS::Lambda::Function' && r.Properties?.FunctionName === 'tdnet-export-dev');
            expect(exportFunction).toBeDefined();
            expect(exportFunction.Properties.Environment.Variables.EXPORT_BUCKET_NAME).toBeDefined();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFx0aTE5OFxcaW52ZXN0bWVudF9hbmFseXNpc19vcG9wb1xcY2RrXFxfX3Rlc3RzX19cXGVudmlyb25tZW50LXBhcmFtZXRlcml6YXRpb24udGVzdC50cyIsIm1hcHBpbmdzIjoiO0FBQUE7Ozs7Ozs7R0FPRzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFFSCxpREFBbUM7QUFDbkMsdURBQWtEO0FBQ2xELGtGQUE0RTtBQUU1RSxRQUFRLENBQUMsOEJBQThCLEVBQUUsR0FBRyxFQUFFO0lBQzVDLE1BQU0sV0FBVyxHQUFHLGNBQWMsQ0FBQztJQUNuQyxNQUFNLFVBQVUsR0FBRyxnQkFBZ0IsQ0FBQztJQUVwQyxRQUFRLENBQUMseUJBQXlCLEVBQUUsR0FBRyxFQUFFO1FBQ3ZDLElBQUksUUFBa0IsQ0FBQztRQUV2QixTQUFTLENBQUMsR0FBRyxFQUFFO1lBQ2IsTUFBTSxHQUFHLEdBQUcsSUFBSSxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUM7WUFDMUIsTUFBTSxLQUFLLEdBQUcsSUFBSSxvREFBdUIsQ0FBQyxHQUFHLEVBQUUsZUFBZSxFQUFFO2dCQUM5RCxHQUFHLEVBQUU7b0JBQ0gsT0FBTyxFQUFFLFdBQVc7b0JBQ3BCLE1BQU0sRUFBRSxVQUFVO2lCQUNuQjtnQkFDRCxpQkFBaUIsRUFBRSxFQUFFLFdBQVcsRUFBRSxLQUFLLEVBQUU7YUFDMUMsQ0FBQyxDQUFDO1lBQ0gsUUFBUSxHQUFHLHFCQUFRLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO1FBQ3ZDLENBQUMsQ0FBQyxDQUFDO1FBRUgsUUFBUSxDQUFDLGlCQUFpQixFQUFFLEdBQUcsRUFBRTtZQUMvQixFQUFFLENBQUMsK0NBQStDLEVBQUUsR0FBRyxFQUFFO2dCQUN2RCxRQUFRLENBQUMscUJBQXFCLENBQUMsc0JBQXNCLEVBQUU7b0JBQ3JELFNBQVMsRUFBRSx1QkFBdUI7aUJBQ25DLENBQUMsQ0FBQztnQkFFSCxRQUFRLENBQUMscUJBQXFCLENBQUMsc0JBQXNCLEVBQUU7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Q0FBQyxjQUFjLENBQUMsVUFBVSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztRQUMzRixDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0FBQ0wsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiQzpcXFVzZXJzXFx0aTE5OFxcaW52ZXN0bWVudF9hbmFseXNpc19vcG9wb1xcY2RrXFxfX3Rlc3RzX19cXGVudmlyb25tZW50LXBhcmFtZXRlcml6YXRpb24udGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcclxuICogRW52aXJvbm1lbnQgUGFyYW1ldGVyaXphdGlvbiBUZXN0XHJcbiAqXHJcbiAqIFRhc2sgMTUuMTUtQTogQ0RL44K544K/44OD44Kv44Gu55Kw5aKD44OR44Op44Oh44O844K/5YyW44OG44K544OIXHJcbiAqIFJlcXVpcmVtZW50czog6KaB5Lu2OC4x77yI6Kit5a6a566h55CG77yJXHJcbiAqXHJcbiAqIOOBk+OBruODhuOCueODiOOBr+OAgUNES+OCueOCv+ODg+OCr+OBjOeSsOWig++8iGRldi9wcm9k77yJ44GU44Go44Gr5q2j44GX44GP44OR44Op44Oh44O844K/5YyW44GV44KM44Gm44GE44KL44GT44Go44KS5qSc6Ki844GX44G+44GZ44CCXHJcbiAqL1xyXG5cclxuaW1wb3J0ICogYXMgY2RrIGZyb20gJ2F3cy1jZGstbGliJztcclxuaW1wb3J0IHsgVGVtcGxhdGUgfSBmcm9tICdhd3MtY2RrLWxpYi9hc3NlcnRpb25zJztcclxuaW1wb3J0IHsgVGRuZXREYXRhQ29sbGVjdG9yU3RhY2sgfSBmcm9tICcuLi9saWIvdGRuZXQtZGF0YS1jb2xsZWN0b3Itc3RhY2snO1xyXG5cclxuZGVzY3JpYmUoJ0Vudmlyb25tZW50IFBhcmFtZXRlcml6YXRpb24nLCAoKSA9PiB7XHJcbiAgY29uc3QgdGVzdEFjY291bnQgPSAnMTIzNDU2Nzg5MDEyJztcclxuICBjb25zdCB0ZXN0UmVnaW9uID0gJ2FwLW5vcnRoZWFzdC0xJztcclxuXHJcbiAgZGVzY3JpYmUoJ0RldmVsb3BtZW50IEVudmlyb25tZW50JywgKCkgPT4ge1xyXG4gICAgbGV0IHRlbXBsYXRlOiBUZW1wbGF0ZTtcclxuXHJcbiAgICBiZWZvcmVBbGwoKCkgPT4ge1xyXG4gICAgICBjb25zdCBhcHAgPSBuZXcgY2RrLkFwcCgpO1xyXG4gICAgICBjb25zdCBzdGFjayA9IG5ldyBUZG5ldERhdGFDb2xsZWN0b3JTdGFjayhhcHAsICdUZXN0U3RhY2stZGV2Jywge1xyXG4gICAgICAgIGVudjogeyBcclxuICAgICAgICAgIGFjY291bnQ6IHRlc3RBY2NvdW50LCBcclxuICAgICAgICAgIHJlZ2lvbjogdGVzdFJlZ2lvbiBcclxuICAgICAgICB9LFxyXG4gICAgICAgIGVudmlyb25tZW50Q29uZmlnOiB7IGVudmlyb25tZW50OiAnZGV2JyB9LFxyXG4gICAgICB9KTtcclxuICAgICAgdGVtcGxhdGUgPSBUZW1wbGF0ZS5mcm9tU3RhY2soc3RhY2spO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ0R5bmFtb0RCIFRhYmxlcycsICgpID0+IHtcclxuICAgICAgaXQoJ3Nob3VsZCBoYXZlIGVudmlyb25tZW50IHN1ZmZpeCBpbiB0YWJsZSBuYW1lcycsICgpID0+IHtcclxuICAgICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6RHluYW1vREI6OlRhYmxlJywge1xyXG4gICAgICAgICAgVGFibGVOYW1lOiAndGRuZXRfZGlzY2xvc3VyZXNfZGV2JyxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkR5bmFtb0RCOjpUYWJsZScsIHtcclxuICAgICAgICAgIFRhYmxlTmFtZTogJ3RkbmV0X2V4ZWN1dGlvbnNfZGV2JyxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkR5bmFtb0RCOjpUYWJsZScsIHtcclxuICAgICAgICAgIFRhYmxlTmFtZTogJ3RkbmV0X2V4cG9ydF9zdGF0dXNfZGV2JyxcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnUzMgQnVja2V0cycsICgpID0+IHtcclxuICAgICAgaXQoJ3Nob3VsZCBoYXZlIGVudmlyb25tZW50IHN1ZmZpeCBpbiBidWNrZXQgbmFtZXMnLCAoKSA9PiB7XHJcbiAgICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OlMzOjpCdWNrZXQnLCB7XHJcbiAgICAgICAgICBCdWNrZXROYW1lOiB7ICdGbjo6Sm9pbic6IFsnJywgWyd0ZG5ldC1kYXRhLWNvbGxlY3Rvci1wZGZzLWRldi0nLCB7IFJlZjogJ0FXUzo6QWNjb3VudElkJyB9XV0gfSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OlMzOjpCdWNrZXQnLCB7XHJcbiAgICAgICAgICBCdWNrZXROYW1lOiB7ICdGbjo6Sm9pbic6IFsnJywgWyd0ZG5ldC1kYXRhLWNvbGxlY3Rvci1leHBvcnRzLWRldi0nLCB7IFJlZjogJ0FXUzo6QWNjb3VudElkJyB9XV0gfSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OlMzOjpCdWNrZXQnLCB7XHJcbiAgICAgICAgICBCdWNrZXROYW1lOiB7ICdGbjo6Sm9pbic6IFsnJywgWyd0ZG5ldC1kYXNoYm9hcmQtZGV2LScsIHsgUmVmOiAnQVdTOjpBY2NvdW50SWQnIH1dXSB9LFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICAvLyBDbG91ZFRyYWlsIGJ1Y2tldCBkb2VzIG5vdCBoYXZlIGVudmlyb25tZW50IHN1ZmZpeCAoc2hhcmVkIHJlc291cmNlKVxyXG4gICAgICAgIHRlbXBsYXRlLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpTMzo6QnVja2V0Jywge1xyXG4gICAgICAgICAgQnVja2V0TmFtZTogYHRkbmV0LWNsb3VkdHJhaWwtbG9ncy0ke3Rlc3RBY2NvdW50fWAsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ0xhbWJkYSBGdW5jdGlvbnMnLCAoKSA9PiB7XHJcbiAgICAgIGl0KCdzaG91bGQgaGF2ZSBlbnZpcm9ubWVudCBzdWZmaXggaW4gZnVuY3Rpb24gbmFtZXMnLCAoKSA9PiB7XHJcbiAgICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkxhbWJkYTo6RnVuY3Rpb24nLCB7XHJcbiAgICAgICAgICBGdW5jdGlvbk5hbWU6ICd0ZG5ldC1jb2xsZWN0b3ItZGV2JyxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkxhbWJkYTo6RnVuY3Rpb24nLCB7XHJcbiAgICAgICAgICBGdW5jdGlvbk5hbWU6ICd0ZG5ldC1xdWVyeS1kZXYnLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6TGFtYmRhOjpGdW5jdGlvbicsIHtcclxuICAgICAgICAgIEZ1bmN0aW9uTmFtZTogJ3RkbmV0LWV4cG9ydC1kZXYnLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6TGFtYmRhOjpGdW5jdGlvbicsIHtcclxuICAgICAgICAgIEZ1bmN0aW9uTmFtZTogJ3RkbmV0LWNvbGxlY3Rvci1kZXYnLCAvLyBDaGFuZ2VkIGZyb20gdGRuZXQtY29sbGVjdC1kZXZcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkxhbWJkYTo6RnVuY3Rpb24nLCB7XHJcbiAgICAgICAgICBGdW5jdGlvbk5hbWU6ICd0ZG5ldC1jb2xsZWN0LXN0YXR1cy1kZXYnLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdBUEkgR2F0ZXdheScsICgpID0+IHtcclxuICAgICAgaXQoJ3Nob3VsZCBoYXZlIGVudmlyb25tZW50IHN1ZmZpeCBpbiBBUEkgbmFtZScsICgpID0+IHtcclxuICAgICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6QXBpR2F0ZXdheTo6UmVzdEFwaScsIHtcclxuICAgICAgICAgIE5hbWU6ICd0ZG5ldC1kYXRhLWNvbGxlY3Rvci1hcGktZGV2JyxcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpdCgnc2hvdWxkIGhhdmUgZW52aXJvbm1lbnQgc3VmZml4IGluIEFQSSBrZXkgbmFtZScsICgpID0+IHtcclxuICAgICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6QXBpR2F0ZXdheTo6QXBpS2V5Jywge1xyXG4gICAgICAgICAgTmFtZTogJ3RkbmV0LWFwaS1rZXktZGV2JyxcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpdCgnc2hvdWxkIGhhdmUgZW52aXJvbm1lbnQgc3VmZml4IGluIHVzYWdlIHBsYW4gbmFtZScsICgpID0+IHtcclxuICAgICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6QXBpR2F0ZXdheTo6VXNhZ2VQbGFuJywge1xyXG4gICAgICAgICAgVXNhZ2VQbGFuTmFtZTogJ3RkbmV0LXVzYWdlLXBsYW4tZGV2JyxcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnV0FGJywgKCkgPT4ge1xyXG4gICAgICBpdCgnc2hvdWxkIGhhdmUgZW52aXJvbm1lbnQgc3VmZml4IGluIFdlYiBBQ0wgbmFtZScsICgpID0+IHtcclxuICAgICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6V0FGdjI6OldlYkFDTCcsIHtcclxuICAgICAgICAgIE5hbWU6ICd0ZG5ldC13ZWItYWNsLWRldicsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdQcm9kdWN0aW9uIEVudmlyb25tZW50JywgKCkgPT4ge1xyXG4gICAgbGV0IHRlbXBsYXRlOiBUZW1wbGF0ZTtcclxuXHJcbiAgICBiZWZvcmVBbGwoKCkgPT4ge1xyXG4gICAgICBjb25zdCBhcHAgPSBuZXcgY2RrLkFwcCgpO1xyXG4gICAgICBjb25zdCBzdGFjayA9IG5ldyBUZG5ldERhdGFDb2xsZWN0b3JTdGFjayhhcHAsICdUZXN0U3RhY2stcHJvZCcsIHtcclxuICAgICAgICBlbnY6IHsgYWNjb3VudDogdGVzdEFjY291bnQsIHJlZ2lvbjogdGVzdFJlZ2lvbiB9LFxyXG4gICAgICAgIGVudmlyb25tZW50Q29uZmlnOiB7IGVudmlyb25tZW50OiAncHJvZCcgfSxcclxuICAgICAgfSk7XHJcbiAgICAgIHRlbXBsYXRlID0gVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdEeW5hbW9EQiBUYWJsZXMnLCAoKSA9PiB7XHJcbiAgICAgIGl0KCdzaG91bGQgaGF2ZSBlbnZpcm9ubWVudCBzdWZmaXggaW4gdGFibGUgbmFtZXMnLCAoKSA9PiB7XHJcbiAgICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkR5bmFtb0RCOjpUYWJsZScsIHtcclxuICAgICAgICAgIFRhYmxlTmFtZTogJ3RkbmV0X2Rpc2Nsb3N1cmVzX3Byb2QnLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6RHluYW1vREI6OlRhYmxlJywge1xyXG4gICAgICAgICAgVGFibGVOYW1lOiAndGRuZXRfZXhlY3V0aW9uc19wcm9kJyxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkR5bmFtb0RCOjpUYWJsZScsIHtcclxuICAgICAgICAgIFRhYmxlTmFtZTogJ3RkbmV0X2V4cG9ydF9zdGF0dXNfcHJvZCcsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ1MzIEJ1Y2tldHMnLCAoKSA9PiB7XHJcbiAgICAgIGl0KCdzaG91bGQgaGF2ZSBlbnZpcm9ubWVudCBzdWZmaXggaW4gYnVja2V0IG5hbWVzJywgKCkgPT4ge1xyXG4gICAgICAgIHRlbXBsYXRlLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpTMzo6QnVja2V0Jywge1xyXG4gICAgICAgICAgQnVja2V0TmFtZTogeyAnRm46OkpvaW4nOiBbJycsIFsndGRuZXQtZGF0YS1jb2xsZWN0b3ItcGRmcy1wcm9kLScsIHsgUmVmOiAnQVdTOjpBY2NvdW50SWQnIH1dXSB9LFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6UzM6OkJ1Y2tldCcsIHtcclxuICAgICAgICAgIEJ1Y2tldE5hbWU6IHsgJ0ZuOjpKb2luJzogWycnLCBbJ3RkbmV0LWRhdGEtY29sbGVjdG9yLWV4cG9ydHMtcHJvZC0nLCB7IFJlZjogJ0FXUzo6QWNjb3VudElkJyB9XV0gfSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OlMzOjpCdWNrZXQnLCB7XHJcbiAgICAgICAgICBCdWNrZXROYW1lOiB7ICdGbjo6Sm9pbic6IFsnJywgWyd0ZG5ldC1kYXNoYm9hcmQtcHJvZC0nLCB7IFJlZjogJ0FXUzo6QWNjb3VudElkJyB9XV0gfSxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgLy8gQ2xvdWRUcmFpbCBidWNrZXQgZG9lcyBub3QgaGF2ZSBlbnZpcm9ubWVudCBzdWZmaXggKHNoYXJlZCByZXNvdXJjZSlcclxuICAgICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6UzM6OkJ1Y2tldCcsIHtcclxuICAgICAgICAgIEJ1Y2tldE5hbWU6IGB0ZG5ldC1jbG91ZHRyYWlsLWxvZ3MtJHt0ZXN0QWNjb3VudH1gLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGRlc2NyaWJlKCdMYW1iZGEgRnVuY3Rpb25zJywgKCkgPT4ge1xyXG4gICAgICBpdCgnc2hvdWxkIGhhdmUgZW52aXJvbm1lbnQgc3VmZml4IGluIGZ1bmN0aW9uIG5hbWVzJywgKCkgPT4ge1xyXG4gICAgICAgIHRlbXBsYXRlLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpMYW1iZGE6OkZ1bmN0aW9uJywge1xyXG4gICAgICAgICAgRnVuY3Rpb25OYW1lOiAndGRuZXQtY29sbGVjdG9yLXByb2QnLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6TGFtYmRhOjpGdW5jdGlvbicsIHtcclxuICAgICAgICAgIEZ1bmN0aW9uTmFtZTogJ3RkbmV0LXF1ZXJ5LXByb2QnLFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6TGFtYmRhOjpGdW5jdGlvbicsIHtcclxuICAgICAgICAgIEZ1bmN0aW9uTmFtZTogJ3RkbmV0LWV4cG9ydC1wcm9kJyxcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkxhbWJkYTo6RnVuY3Rpb24nLCB7XHJcbiAgICAgICAgICBGdW5jdGlvbk5hbWU6ICd0ZG5ldC1jb2xsZWN0b3ItcHJvZCcsIC8vIENoYW5nZWQgZnJvbSB0ZG5ldC1jb2xsZWN0LXByb2RcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkxhbWJkYTo6RnVuY3Rpb24nLCB7XHJcbiAgICAgICAgICBGdW5jdGlvbk5hbWU6ICd0ZG5ldC1jb2xsZWN0LXN0YXR1cy1wcm9kJyxcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICBkZXNjcmliZSgnQVBJIEdhdGV3YXknLCAoKSA9PiB7XHJcbiAgICAgIGl0KCdzaG91bGQgaGF2ZSBlbnZpcm9ubWVudCBzdWZmaXggaW4gQVBJIG5hbWUnLCAoKSA9PiB7XHJcbiAgICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkFwaUdhdGV3YXk6OlJlc3RBcGknLCB7XHJcbiAgICAgICAgICBOYW1lOiAndGRuZXQtZGF0YS1jb2xsZWN0b3ItYXBpLXByb2QnLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIGl0KCdzaG91bGQgaGF2ZSBlbnZpcm9ubWVudCBzdWZmaXggaW4gQVBJIGtleSBuYW1lJywgKCkgPT4ge1xyXG4gICAgICAgIHRlbXBsYXRlLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpBcGlHYXRld2F5OjpBcGlLZXknLCB7XHJcbiAgICAgICAgICBOYW1lOiAndGRuZXQtYXBpLWtleS1wcm9kJyxcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpdCgnc2hvdWxkIGhhdmUgZW52aXJvbm1lbnQgc3VmZml4IGluIHVzYWdlIHBsYW4gbmFtZScsICgpID0+IHtcclxuICAgICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6QXBpR2F0ZXdheTo6VXNhZ2VQbGFuJywge1xyXG4gICAgICAgICAgVXNhZ2VQbGFuTmFtZTogJ3RkbmV0LXVzYWdlLXBsYW4tcHJvZCcsXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgZGVzY3JpYmUoJ1dBRicsICgpID0+IHtcclxuICAgICAgaXQoJ3Nob3VsZCBoYXZlIGVudmlyb25tZW50IHN1ZmZpeCBpbiBXZWIgQUNMIG5hbWUnLCAoKSA9PiB7XHJcbiAgICAgICAgdGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OldBRnYyOjpXZWJBQ0wnLCB7XHJcbiAgICAgICAgICBOYW1lOiAndGRuZXQtd2ViLWFjbC1wcm9kJyxcclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0RlZmF1bHQgRW52aXJvbm1lbnQgKG5vIGNvbmZpZyBwcm92aWRlZCknLCAoKSA9PiB7XHJcbiAgICBsZXQgdGVtcGxhdGU6IFRlbXBsYXRlO1xyXG5cclxuICAgIGJlZm9yZUFsbCgoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGFwcCA9IG5ldyBjZGsuQXBwKCk7XHJcbiAgICAgIGNvbnN0IHN0YWNrID0gbmV3IFRkbmV0RGF0YUNvbGxlY3RvclN0YWNrKGFwcCwgJ1Rlc3RTdGFjay1kZWZhdWx0Jywge1xyXG4gICAgICAgIGVudjogeyBhY2NvdW50OiB0ZXN0QWNjb3VudCwgcmVnaW9uOiB0ZXN0UmVnaW9uIH0sXHJcbiAgICAgICAgLy8gZW52aXJvbm1lbnRDb25maWcgbm90IHByb3ZpZGVkIC0gc2hvdWxkIGRlZmF1bHQgdG8gJ2RldidcclxuICAgICAgfSk7XHJcbiAgICAgIHRlbXBsYXRlID0gVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgZGVmYXVsdCB0byBkZXYgZW52aXJvbm1lbnQnLCAoKSA9PiB7XHJcbiAgICAgIHRlbXBsYXRlLmhhc1Jlc291cmNlUHJvcGVydGllcygnQVdTOjpEeW5hbW9EQjo6VGFibGUnLCB7XHJcbiAgICAgICAgVGFibGVOYW1lOiAndGRuZXRfZGlzY2xvc3VyZXNfZGV2JyxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6TGFtYmRhOjpGdW5jdGlvbicsIHtcclxuICAgICAgICBGdW5jdGlvbk5hbWU6ICd0ZG5ldC1jb2xsZWN0b3ItZGV2JyxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICB0ZW1wbGF0ZS5oYXNSZXNvdXJjZVByb3BlcnRpZXMoJ0FXUzo6QXBpR2F0ZXdheTo6UmVzdEFwaScsIHtcclxuICAgICAgICBOYW1lOiAndGRuZXQtZGF0YS1jb2xsZWN0b3ItYXBpLWRldicsXHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdSZXNvdXJjZSBJc29sYXRpb24nLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIGNyZWF0ZSBkaWZmZXJlbnQgcmVzb3VyY2UgbmFtZXMgZm9yIGRldiBhbmQgcHJvZCcsICgpID0+IHtcclxuICAgICAgY29uc3QgYXBwID0gbmV3IGNkay5BcHAoKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IGRldlN0YWNrID0gbmV3IFRkbmV0RGF0YUNvbGxlY3RvclN0YWNrKGFwcCwgJ0RldlN0YWNrJywge1xyXG4gICAgICAgIGVudjogeyBhY2NvdW50OiB0ZXN0QWNjb3VudCwgcmVnaW9uOiB0ZXN0UmVnaW9uIH0sXHJcbiAgICAgICAgZW52aXJvbm1lbnRDb25maWc6IHsgZW52aXJvbm1lbnQ6ICdkZXYnIH0sXHJcbiAgICAgIH0pO1xyXG4gICAgICBcclxuICAgICAgY29uc3QgcHJvZFN0YWNrID0gbmV3IFRkbmV0RGF0YUNvbGxlY3RvclN0YWNrKGFwcCwgJ1Byb2RTdGFjaycsIHtcclxuICAgICAgICBlbnY6IHsgYWNjb3VudDogdGVzdEFjY291bnQsIHJlZ2lvbjogdGVzdFJlZ2lvbiB9LFxyXG4gICAgICAgIGVudmlyb25tZW50Q29uZmlnOiB7IGVudmlyb25tZW50OiAncHJvZCcgfSxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBjb25zdCBkZXZUZW1wbGF0ZSA9IFRlbXBsYXRlLmZyb21TdGFjayhkZXZTdGFjayk7XHJcbiAgICAgIGNvbnN0IHByb2RUZW1wbGF0ZSA9IFRlbXBsYXRlLmZyb21TdGFjayhwcm9kU3RhY2spO1xyXG5cclxuICAgICAgLy8gVmVyaWZ5IGRldiByZXNvdXJjZXNcclxuICAgICAgZGV2VGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkR5bmFtb0RCOjpUYWJsZScsIHtcclxuICAgICAgICBUYWJsZU5hbWU6ICd0ZG5ldF9kaXNjbG9zdXJlc19kZXYnLFxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIC8vIFZlcmlmeSBwcm9kIHJlc291cmNlc1xyXG4gICAgICBwcm9kVGVtcGxhdGUuaGFzUmVzb3VyY2VQcm9wZXJ0aWVzKCdBV1M6OkR5bmFtb0RCOjpUYWJsZScsIHtcclxuICAgICAgICBUYWJsZU5hbWU6ICd0ZG5ldF9kaXNjbG9zdXJlc19wcm9kJyxcclxuICAgICAgfSk7XHJcblxyXG4gICAgICAvLyBFbnN1cmUgdGhleSBhcmUgZGlmZmVyZW50XHJcbiAgICAgIGV4cGVjdChkZXZTdGFjay5kaXNjbG9zdXJlc1RhYmxlLnRhYmxlTmFtZSkubm90LnRvQmUoXHJcbiAgICAgICAgcHJvZFN0YWNrLmRpc2Nsb3N1cmVzVGFibGUudGFibGVOYW1lXHJcbiAgICAgICk7XHJcbiAgICB9KTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoJ0Vudmlyb25tZW50IFZhcmlhYmxlIFByb3BhZ2F0aW9uJywgKCkgPT4ge1xyXG4gICAgbGV0IHRlbXBsYXRlOiBUZW1wbGF0ZTtcclxuXHJcbiAgICBiZWZvcmVBbGwoKCkgPT4ge1xyXG4gICAgICBjb25zdCBhcHAgPSBuZXcgY2RrLkFwcCgpO1xyXG4gICAgICBjb25zdCBzdGFjayA9IG5ldyBUZG5ldERhdGFDb2xsZWN0b3JTdGFjayhhcHAsICdUZXN0U3RhY2stZW52LXZhcnMnLCB7XHJcbiAgICAgICAgZW52OiB7IGFjY291bnQ6IHRlc3RBY2NvdW50LCByZWdpb246IHRlc3RSZWdpb24gfSxcclxuICAgICAgICBlbnZpcm9ubWVudENvbmZpZzogeyBlbnZpcm9ubWVudDogJ2RldicgfSxcclxuICAgICAgfSk7XHJcbiAgICAgIHRlbXBsYXRlID0gVGVtcGxhdGUuZnJvbVN0YWNrKHN0YWNrKTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcGFzcyBlbnZpcm9ubWVudC1zcGVjaWZpYyB0YWJsZSBuYW1lcyB0byBMYW1iZGEgZnVuY3Rpb25zJywgKCkgPT4ge1xyXG4gICAgICAvLyBDb2xsZWN0b3IgZnVuY3Rpb24gc2hvdWxkIGhhdmUgdGFibGUgcmVmZXJlbmNlc1xyXG4gICAgICBjb25zdCByZXNvdXJjZXMgPSB0ZW1wbGF0ZS50b0pTT04oKS5SZXNvdXJjZXM7XHJcbiAgICAgIGNvbnN0IGNvbGxlY3RvckZ1bmN0aW9uID0gT2JqZWN0LnZhbHVlcyhyZXNvdXJjZXMpLmZpbmQoXHJcbiAgICAgICAgKHI6IGFueSkgPT4gci5UeXBlID09PSAnQVdTOjpMYW1iZGE6OkZ1bmN0aW9uJyAmJiByLlByb3BlcnRpZXM/LkZ1bmN0aW9uTmFtZSA9PT0gJ3RkbmV0LWNvbGxlY3Rvci1kZXYnXHJcbiAgICAgICkgYXMgYW55O1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KGNvbGxlY3RvckZ1bmN0aW9uKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QoY29sbGVjdG9yRnVuY3Rpb24uUHJvcGVydGllcy5FbnZpcm9ubWVudC5WYXJpYWJsZXMuRFlOQU1PREJfVEFCTEUpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdChjb2xsZWN0b3JGdW5jdGlvbi5Qcm9wZXJ0aWVzLkVudmlyb25tZW50LlZhcmlhYmxlcy5EWU5BTU9EQl9FWEVDVVRJT05TX1RBQkxFKS50b0JlRGVmaW5lZCgpO1xyXG5cclxuICAgICAgLy8gUXVlcnkgZnVuY3Rpb24gc2hvdWxkIGhhdmUgdGFibGUgcmVmZXJlbmNlXHJcbiAgICAgIGNvbnN0IHF1ZXJ5RnVuY3Rpb24gPSBPYmplY3QudmFsdWVzKHJlc291cmNlcykuZmluZChcclxuICAgICAgICAocjogYW55KSA9PiByLlR5cGUgPT09ICdBV1M6OkxhbWJkYTo6RnVuY3Rpb24nICYmIHIuUHJvcGVydGllcz8uRnVuY3Rpb25OYW1lID09PSAndGRuZXQtcXVlcnktZGV2J1xyXG4gICAgICApIGFzIGFueTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChxdWVyeUZ1bmN0aW9uKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QocXVlcnlGdW5jdGlvbi5Qcm9wZXJ0aWVzLkVudmlyb25tZW50LlZhcmlhYmxlcy5EWU5BTU9EQl9UQUJMRV9OQU1FKS50b0JlRGVmaW5lZCgpO1xyXG5cclxuICAgICAgLy8gRXhwb3J0IGZ1bmN0aW9uIHNob3VsZCBoYXZlIHRhYmxlIHJlZmVyZW5jZXNcclxuICAgICAgY29uc3QgZXhwb3J0RnVuY3Rpb24gPSBPYmplY3QudmFsdWVzKHJlc291cmNlcykuZmluZChcclxuICAgICAgICAocjogYW55KSA9PiByLlR5cGUgPT09ICdBV1M6OkxhbWJkYTo6RnVuY3Rpb24nICYmIHIuUHJvcGVydGllcz8uRnVuY3Rpb25OYW1lID09PSAndGRuZXQtZXhwb3J0LWRldidcclxuICAgICAgKSBhcyBhbnk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QoZXhwb3J0RnVuY3Rpb24pLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdChleHBvcnRGdW5jdGlvbi5Qcm9wZXJ0aWVzLkVudmlyb25tZW50LlZhcmlhYmxlcy5EWU5BTU9EQl9UQUJMRV9OQU1FKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgICBleHBlY3QoZXhwb3J0RnVuY3Rpb24uUHJvcGVydGllcy5FbnZpcm9ubWVudC5WYXJpYWJsZXMuRVhQT1JUX1NUQVRVU19UQUJMRV9OQU1FKS50b0JlRGVmaW5lZCgpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBwYXNzIGVudmlyb25tZW50LXNwZWNpZmljIGJ1Y2tldCBuYW1lcyB0byBMYW1iZGEgZnVuY3Rpb25zJywgKCkgPT4ge1xyXG4gICAgICBjb25zdCByZXNvdXJjZXMgPSB0ZW1wbGF0ZS50b0pTT04oKS5SZXNvdXJjZXM7XHJcbiAgICAgIFxyXG4gICAgICAvLyBDb2xsZWN0b3IgZnVuY3Rpb24gc2hvdWxkIGhhdmUgYnVja2V0IHJlZmVyZW5jZVxyXG4gICAgICBjb25zdCBjb2xsZWN0b3JGdW5jdGlvbiA9IE9iamVjdC52YWx1ZXMocmVzb3VyY2VzKS5maW5kKFxyXG4gICAgICAgIChyOiBhbnkpID0+IHIuVHlwZSA9PT0gJ0FXUzo6TGFtYmRhOjpGdW5jdGlvbicgJiYgci5Qcm9wZXJ0aWVzPy5GdW5jdGlvbk5hbWUgPT09ICd0ZG5ldC1jb2xsZWN0b3ItZGV2J1xyXG4gICAgICApIGFzIGFueTtcclxuICAgICAgXHJcbiAgICAgIGV4cGVjdChjb2xsZWN0b3JGdW5jdGlvbikudG9CZURlZmluZWQoKTtcclxuICAgICAgZXhwZWN0KGNvbGxlY3RvckZ1bmN0aW9uLlByb3BlcnRpZXMuRW52aXJvbm1lbnQuVmFyaWFibGVzLlMzX0JVQ0tFVCkudG9CZURlZmluZWQoKTtcclxuXHJcbiAgICAgIC8vIFF1ZXJ5IGZ1bmN0aW9uIHNob3VsZCBoYXZlIGJ1Y2tldCByZWZlcmVuY2VcclxuICAgICAgY29uc3QgcXVlcnlGdW5jdGlvbiA9IE9iamVjdC52YWx1ZXMocmVzb3VyY2VzKS5maW5kKFxyXG4gICAgICAgIChyOiBhbnkpID0+IHIuVHlwZSA9PT0gJ0FXUzo6TGFtYmRhOjpGdW5jdGlvbicgJiYgci5Qcm9wZXJ0aWVzPy5GdW5jdGlvbk5hbWUgPT09ICd0ZG5ldC1xdWVyeS1kZXYnXHJcbiAgICAgICkgYXMgYW55O1xyXG4gICAgICBcclxuICAgICAgZXhwZWN0KHF1ZXJ5RnVuY3Rpb24pLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdChxdWVyeUZ1bmN0aW9uLlByb3BlcnRpZXMuRW52aXJvbm1lbnQuVmFyaWFibGVzLlMzX0JVQ0tFVF9OQU1FKS50b0JlRGVmaW5lZCgpO1xyXG5cclxuICAgICAgLy8gRXhwb3J0IGZ1bmN0aW9uIHNob3VsZCBoYXZlIGJ1Y2tldCByZWZlcmVuY2VcclxuICAgICAgY29uc3QgZXhwb3J0RnVuY3Rpb24gPSBPYmplY3QudmFsdWVzKHJlc291cmNlcykuZmluZChcclxuICAgICAgICAocjogYW55KSA9PiByLlR5cGUgPT09ICdBV1M6OkxhbWJkYTo6RnVuY3Rpb24nICYmIHIuUHJvcGVydGllcz8uRnVuY3Rpb25OYW1lID09PSAndGRuZXQtZXhwb3J0LWRldidcclxuICAgICAgKSBhcyBhbnk7XHJcbiAgICAgIFxyXG4gICAgICBleHBlY3QoZXhwb3J0RnVuY3Rpb24pLnRvQmVEZWZpbmVkKCk7XHJcbiAgICAgIGV4cGVjdChleHBvcnRGdW5jdGlvbi5Qcm9wZXJ0aWVzLkVudmlyb25tZW50LlZhcmlhYmxlcy5FWFBPUlRfQlVDS0VUX05BTUUpLnRvQmVEZWZpbmVkKCk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7XHJcbiJdLCJ2ZXJzaW9uIjozfQ==